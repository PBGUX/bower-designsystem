!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common"),require("d3"),require("topojson")):"function"==typeof define&&define.amd?define("pb-design-system",["exports","@angular/core","@angular/common","d3","topojson"],e):e((t=t||self)["pb-design-system"]={},t.ng.core,t.ng.common,t["^5"][9][0],t["^3"][0][0])}(this,function(t,e,i,a,s){"use strict";var r=function(){return(r=Object.assign||function(t){for(var e,i=1,a=arguments.length;i<a;i++)for(var s in e=arguments[i])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)};function n(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var a,s,r=i.call(t),n=[];try{for(;(void 0===e||e-- >0)&&!(a=r.next()).done;)n.push(a.value)}catch(t){s={error:t}}finally{try{a&&!a.done&&(i=r.return)&&i.call(r)}finally{if(s)throw s.error}}return n}function o(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(n(arguments[e]));return t}var l=function(){function t(){var t=this;this.colors={classic:{full:["#e23da8","#314183","#1bb9ff","#ff8b00","#0384d4","#00b140","#a319b1","#ffc500","#8b98c8","#ccb8ce","#e6c49c","#9b9b9b"],mono:["#001D56","#003296","#4B74C5","#89A1D0","#A3BCEE","#C9D7F3"]},twilight:{full:["#0384d4","#314183","#1bb9ff","#ff8b00","#e23da8","#00b140","#a319b1","#ffc500","#8b98c8","#ccb8ce","#e6c49c","#9b9b9b"],mono:["#0F6894","#3697C7","#45BAF5","#98D1ED","#B5E6FF","#D8E9F2"]},ocean:{full:["#00b140","#0384d4","#314183","#1bb9ff","#e23da8","#ffc500","#a319b1","#ff8b00","#8b98c8","#e6c49c","#ccb8ce","#9b9b9b"],mono:["#394B4D","#3A6B6E","#14767D","#99BFC2","#C0ECF0","#CAE1E3"]},sunset:{full:["#512e8b","#ff8b00","#1bb9ff","#e23da8","#ffc500","#00b140","#0384d4","#ccb8ce","#314183","#e6c49c","#8b98c8","#9b9b9b"],mono:["#34254A","#46248F","#6235C4","#9A79E2","#C4A8FF","#DACCED"]}},this.getColors=function(e,i){return void 0===e&&(e=!1),void 0===i&&(i="classic"),e?t.colors[i].mono:t.colors[i].full},this.createGradientDefs=function(e,i,a,s){void 0===i&&(i=!1),void 0===a&&(a="classic"),void 0===s&&(s=!0);for(var r=i?[t.colors[a].mono[2]]:t.colors[a].full,n=0;n<r.length;n++){var o=i?t.colors[a].mono[2]:t.colors[a].full[n],l=void 0;s?((l=e.append("defs").append("linearGradient").attr("id","gradient-"+o.replace("#","")).attr("x1","0").attr("y1","0").attr("x2","0").attr("y2","1").attr("spreadMethod","pad")).append("stop").attr("offset","0%").attr("stop-color",o).attr("stop-opacity","1"),l.append("stop").attr("offset","100%").attr("stop-color",o).attr("stop-opacity",".3")):((l=e.append("defs").append("linearGradient").attr("id","gradient-horizontal-"+o.replace("#","")).attr("x1","1").attr("y1","0").attr("x2","0").attr("y2","0").attr("spreadMethod","pad")).append("stop").attr("offset","0%").attr("stop-color",o).attr("stop-opacity","1"),l.append("stop").attr("offset","100%").attr("stop-color",o).attr("stop-opacity",".3"))}return r},this.createGlowFilter=function(t){var e=t.append("defs").append("filter").attr("id","glow").attr("width","200%").attr("height","200%");e.append("feGaussianBlur").attr("in","SourceGraphic").attr("stdDeviation",4);for(var i=[{dy:2,slope:.2},{dy:5,slope:.05}],a=0;a<i.length;a++)e.append("feOffset").attr("result","offsetBlur"+a).attr("dx",0).attr("dy",i[a].dy);for(var s=0;s<i.length;s++)e.append("feComponentTransfer").attr("result","coloredBlur"+s).attr("in","offsetBlur"+s).append("feFuncA").attr("type","linear").attr("slope",i[s].slope);var r=e.append("feMerge");r.append("feMergeNode").attr("in","SourceGraphic");for(var n=0;n<i.length;n++)r.append("feMergeNode").attr("in","coloredBlur"+n)}}return t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}();var h=function(){function t(t,i){var s=this;this._dataviz=t,this._element=i,this.chartClass=!0,this.pieClass=!0,this.width=300,this.type="pie",this.monochrome=!1,this.legendLabelFormatType=null,this.legendLabelFormatString="",this.legendValueFormatString="",this.tooltipLabelFormatType=null,this.tooltipLabelFormatString="",this.tooltipValueFormatString="",this.hovered=new e.EventEmitter,this.clicked=new e.EventEmitter,this.currentData=[],this.updateChart=function(){var t=s.svg.selectAll("path").data(s.pie(s.data));t.exit().remove(),t.each(function(t){return t.outerRadius=s.outerRadius}).transition().duration(500).attrTween("d",s.arcTween);var e=t.enter().append("path").each(function(t){return t.outerRadius=s.outerRadius}).attr("d",s.arc).attr("fill",function(t){return s.colorRange(t.data.label)}).attr("class","slice").each(function(t,e,i){s.currentData.splice(e,1,t)});"pie"===s.type&&e.style("stroke","#fff").style("stroke-width",2).style("stroke-alignment","inner");var i=s.chart.select(".legend").selectAll(".legend-item").data(s.data);i.exit().remove(),i.select(".legend-label").html(function(t){switch(s.legendLabelFormatType){case"time":var e=a.isoParse(t.label);return s.legendLabelFormat(e);default:return t.label}}),i.select(".legend-value").html(function(t){return s.legendValueFormat(t.value)});var r=i.enter().append("li").attr("class","legend-item");r.append("span").attr("class","legend-key").style("background-color",function(t){return s.colorRange(t.label)});var n=r.append("span").attr("class","legend-description");n.append("span").attr("class","legend-label").html(function(t){switch(s.legendLabelFormatType){case"time":var e=a.isoParse(t.label);return s.legendLabelFormat(e);default:return t.label}}),n.append("span").attr("class","legend-value").html(function(t){return s.legendValueFormat(t.value)}),r.on("mouseover focus",function(t,e,i){s.legendMouseOverFocus(t,e,i),s.pathMouseOver(a.event,t,e,i)}).on("mouseout blur",function(t,e,i){s.legendMouseOutBlur(t,e,i),s.pathMouseOut(t,e,i)}).on("click",function(t,e,i){s.clicked.emit(t)}),e.on("mouseover",function(t,e,i){s.pathMouseOver(a.event,t,e,i),s.tooltipShow(s.chart.node(),t)}).on("mousemove",function(t,e,i){s.tooltipMove(s.chart.node())}).on("mouseout",function(t,e,i){s.pathMouseOut(t,e,i),s.tooltipHide()}).on("click",function(t,e,i){s.pathClick(a.event,t,e,i)})},this.arcTween=function(t,e,i){var r=a.interpolate(s.currentData[e],t);return s.currentData[e]=r(1),function(t){return s.arc(r(t))}},this.legendMouseOverFocus=function(t,e,i){s.chart.selectAll(".legend-item").filter(function(t,i){return i!==e}).classed("inactive",!0)},this.legendMouseOutBlur=function(t,e,i){s.chart.selectAll(".legend-item").classed("inactive",!1)},this.pathMouseOver=function(t,e,i,r){var n=s.chart.selectAll(".slice"),o=n.filter(function(t,e){return e===i});s.chart.selectAll(".legend-item").filter(function(t,e){return e!==i}).classed("inactive",!0),n.filter(function(t,e){return e!==i}).classed("inactive",!0),o.transition().duration(300).delay(0).attrTween("d",function(t){var e=a.interpolate(t.outerRadius,s.outerRadius+s.arcZoom);return function(i){return t.outerRadius=e(i),s.arc(t)}}),s.hovered.emit({event:t,data:e.data?e.data:e})},this.pathMouseOut=function(t,e,i){var r=s.chart.selectAll(".slice"),n=r.filter(function(t,i){return i===e});s.chart.selectAll(".legend-item").filter(function(t,i){return i!==e}).classed("inactive",!1),r.classed("inactive",!1),n.transition().duration(300).delay(0).attrTween("d",function(t){var e=a.interpolate(t.outerRadius,s.outerRadius);return function(i){return t.outerRadius=e(i),s.arc(t)}})},this.pathClick=function(t,e,i,a){s.clicked.emit({event:t,data:e.data})},this.tooltipShow=function(t,e){s.tooltipSetPosition(t);var i,r=(e.endAngle-e.startAngle)/(2*Math.PI);switch(s.tooltipLabelFormatType){case"time":var n=a.isoParse(e.data.label);i=s.tooltipLabelFormat(n);break;default:i=e.data.label}s.tooltip.html('\n        <div class="tooltip-label">'+i+'</div>\n        <div class="tooltip-value">'+s.tooltipValueFormat(r)+"</div>\n      "),s.tooltip.style("opacity",1)},this.tooltipMove=function(t){s.tooltipSetPosition(t)},this.tooltipHide=function(){s.tooltip.style("opacity",0)},this.tooltipSetPosition=function(t){var e=a.mouse(t);s.tooltip.style("left",e[0]+16+"px"),s.tooltip.style("top",e[1]+16+"px")}}return t.prototype.ngOnInit=function(){switch(this.margin={top:10,right:10,bottom:10,left:10},this.width=this.width-this.margin.left-this.margin.right,this.height=this.width-this.margin.top-this.margin.bottom,this.colors=this._dataviz.getColors(this.monochrome,this.theme),this.innerRadius=Math.min(this.width,this.height)/2.5,this.outerRadius=Math.min(this.width,this.height)/2,this.arcZoom=10,this.anglePad=.02,this.legendValueFormat=a.format(this.legendValueFormatString),this.tooltipValueFormat=a.format(this.tooltipValueFormatString),this.legendLabelFormatType){case"time":this.legendLabelFormat=a.timeFormat(this.legendLabelFormatString);break;default:this.legendLabelFormat=null}switch(this.tooltipLabelFormatType){case"time":this.tooltipLabelFormat=a.timeFormat(this.tooltipLabelFormatString);break;default:this.tooltipLabelFormat=null}this.colorRange=a.scaleOrdinal().range(this.colors).domain(this.data.map(function(t){return t.label})),"pie"===this.type&&(this.innerRadius=0,this.anglePad=0),this.pie=a.pie().padAngle(this.anglePad).value(function(t){return t.value}).sort(null),this.arc=a.arc().padRadius(this.outerRadius).innerRadius(this.innerRadius),this.chart=a.select(this._element.nativeElement).attr("aria-hidden","true"),this.svg=this.chart.append("svg").attr("width",this.width).attr("height",this.height).attr("class","img-fluid").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","-"+(this.width/2+this.margin.left)+" -"+(this.height/2+this.margin.top)+" "+(this.width+this.margin.left+this.margin.right)+" "+(this.height+this.margin.top+this.margin.bottom)),this.legend=this.chart.append("ul").attr("class","legend legend-right"),this.tooltip=this.chart.append("div").style("opacity",0).attr("class","pbds-tooltip").attr("aria-hidden","true"),this.updateChart()},t.prototype.ngOnChanges=function(t){t.data&&!t.data.firstChange&&this.updateChart()},t.prototype.ngOnDestroy=function(){this.tooltip&&this.tooltip.remove()},t.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-pie",template:"",changeDetection:e.ChangeDetectionStrategy.OnPush}]}],t.ctorParameters=function(){return[{type:l},{type:e.ElementRef}]},t.propDecorators={chartClass:[{type:e.HostBinding,args:["class.pbds-chart"]}],pieClass:[{type:e.HostBinding,args:["class.pbds-chart-pie"]}],data:[{type:e.Input}],width:[{type:e.Input}],type:[{type:e.Input}],monochrome:[{type:e.Input}],legendLabelFormatType:[{type:e.Input}],legendLabelFormatString:[{type:e.Input}],legendValueFormatString:[{type:e.Input}],tooltipLabelFormatType:[{type:e.Input}],tooltipLabelFormatString:[{type:e.Input}],tooltipValueFormatString:[{type:e.Input}],theme:[{type:e.Input}],hovered:[{type:e.Output}],clicked:[{type:e.Output}]},t}();var c=function(){function t(t,i,s,r){var n=this;this._dataviz=t,this._element=i,this._scroll=s,this._location=r,this.chartClass=!0,this.barClass=!0,this.width=306,this.height=400,this.type="medium",this.singleSeries=!1,this.xAxisFormatType=null,this.xAxisFormatString="",this.yAxisFormatType=null,this.yAxisFormatString="",this.yAxisTicks=5,this.yAxisMinBuffer=.01,this.yAxisMaxBuffer=.01,this.hideLegend=!1,this.legendWidth=133,this.legendPosition="right",this.legendLabelFormatType=null,this.legendLabelFormatString="",this.tooltipLabelFormatType=null,this.tooltipLabelFormatString="",this.tooltipValueFormatType=null,this.tooltipValueFormatString="",this.marginTop=10,this.marginRight=0,this.marginBottom=30,this.marginLeft=55,this.threshold=null,this.average=null,this.hovered=new e.EventEmitter,this.clicked=new e.EventEmitter,this.updateChart=function(){var t,e;if(n.xAxisScale.domain(n.data.map(function(t){return t.label})),n.yAxisScale.domain([a.min(n.data,function(t){return t.value-t.value*+n.yAxisMinBuffer}),a.max(n.data,function(t){return t.value+t.value*+n.yAxisMaxBuffer})]).rangeRound([n.height,0]).nice(),n.xAxis.transition().duration(1e3).call(n.xAxisCall),n.yAxis.transition().duration(1e3).call(n.yAxisCall),n.hideXGrid||n.xGrid.transition().duration(1e3).call(n.xGridCall),n.hideYGrid||n.yGrid.transition().duration(1e3).call(n.yGridCall),n.hideGrayBars?((t=n.svg.selectAll(".bar-group").data(n.data)).exit().remove(),t.select(".bar").attr("x",function(t){return n.xAxisScale(t.label)+n.xAxisScale.bandwidth()/5.5}).attr("width",n.xAxisScale.bandwidth()/1.5).transition().duration(1e3).attr("y",function(t){return n.yAxisScale(t.value)}).attr("height",function(t){return n.height-n.yAxisScale(t.value)}),(e=t.enter().append("g").attr("class","bar-group")).append("rect").attr("class","bar").attr("rx",2).attr("fill",function(t){return"url("+n._location.path()+"#gradient-"+n.colorRange(t.label).substr(1)+")"}).attr("x",function(t){return n.xAxisScale(t.label)+n.xAxisScale.bandwidth()/5.5}).attr("width",n.xAxisScale.bandwidth()/1.5).attr("y",n.height).attr("height",0).transition().duration(1e3).attr("y",function(t){return n.yAxisScale(t.value)}).attr("height",function(t){return n.height-n.yAxisScale(t.value)}).attr("data-color",function(t){return n.colorRange(t.label)}),e.select(".bar").on("mouseover",function(t,e,i){return n.barMouseOver(a.event,t,e,i)}).on("mouseout",function(){return n.barMouseOut()}).on("click",function(t,e,i){return n.barMouseClick(a.event,t,e,i)})):((t=n.svg.selectAll(".bar-group").data(n.data)).exit().remove(),t.select(".gray-bar").transition().duration(1e3).attr("x",function(t){return n.xAxisScale(t.label)}).attr("width",n.xAxisScale.bandwidth()),t.select(".bar").transition().duration(1e3).attr("x",function(t){return n.xAxisScale(t.label)+n.xAxisScale.bandwidth()/4}).attr("width",n.xAxisScale.bandwidth()/2).attr("height",function(t){return n.height-n.yAxisScale(t.value)}).attr("y",function(t){return n.yAxisScale(t.value)}),(e=t.enter().append("g").attr("class","bar-group")).append("rect").attr("class","gray-bar").attr("rx",0).attr("height",0).attr("x",function(t){return n.xAxisScale(t.label)}).attr("width",n.xAxisScale.bandwidth()).transition().attr("height",n.height).attr("width",n.xAxisScale.bandwidth()),e.append("rect").attr("class","bar").attr("rx",2).attr("fill",function(t){return"url("+n._location.path()+"#gradient-"+n.colorRange(t.label).substr(1)+")"}).attr("x",function(t){return n.xAxisScale(t.label)+n.xAxisScale.bandwidth()/4}).attr("width",n.xAxisScale.bandwidth()/2).attr("y",n.height).attr("height",0).transition().duration(1e3).attr("y",function(t){return n.yAxisScale(t.value)}).attr("height",function(t){return n.height-n.yAxisScale(t.value)}).attr("data-color",function(t){return n.colorRange(t.label)}),e.select(".bar").on("mouseover",function(t,e,i){return n.barMouseOver(a.event,t,e,i)}).on("mouseout",function(t,e,i){return n.barMouseOut()}).on("click",function(t,e,i){return n.barMouseClick(a.event,t,e,i)})),!n.hideLegend){var i=n.chart.select(".legend").selectAll(".legend-item").data(n.data);i.exit().remove(),i.select(".legend-label").html(function(t){switch(n.legendLabelFormatType){case"number":return n.legendLabelFormat(t.label);case"time":var e=a.isoParse(t.label);return n.legendLabelFormat(e);default:return t.label}});var s=i.enter().append("li").attr("class","legend-item");s.append("span").attr("class","legend-key").style("background-color",function(t){return n.colorRange(t.label)}),s.append("span").attr("class","legend-label").html(function(t){switch(n.legendLabelFormatType){case"number":return n.legendLabelFormat(t.label);case"time":var e=a.isoParse(t.label);return n.legendLabelFormat(e);default:return t.label}}),s.on("mouseover",function(t,e,i){return n.legendMouseOver(a.event,t,e,i)}).on("mouseout",function(){return n.legendMouseOut()}).on("click",function(t,e,i){return n.legendMouseClick(a.event,t,e,i)})}n.threshold&&n.yThreshold.raise().transition().duration(1e3).attr("transform","translate(0,  "+n.yAxisScale(+n.threshold)+")"),n.average&&n.yAverage.raise().transition().duration(1e3).attr("transform","translate(0,  "+n.yAxisScale(+n.average)+")")},this.barMouseOver=function(t,e,i,a){n.chart.selectAll(".bar-group").filter(function(t,e){return e!==i}).classed("inactive",!0);var s=n.chart.selectAll(".bar-group").filter(function(t,e){return e===i}).select(".bar"),r=s.attr("data-color");s.style("fill",function(){return r}),n.chart.selectAll(".legend-item").filter(function(t,e){return e!==i}).classed("inactive",!0),n.tooltipShow(e,a.filter(function(t,e){return e===i})),n.hovered.emit({event:t,data:e})},this.barMouseOut=function(){n.chart.selectAll(".bar-group").classed("inactive",!1).select(".bar").style("fill",null),n.chart.selectAll(".legend-item").classed("inactive",!1),n.tooltipHide()},this.barMouseClick=function(t,e,i,a){n.clicked.emit({event:t,data:e})},this.legendMouseOver=function(t,e,i,a){n.chart.selectAll(".legend-item").filter(function(t,e){return e!==i}).classed("inactive",!0),n.chart.selectAll(".bar-group").filter(function(t,e){return e!==i}).classed("inactive",!0);var s=n.chart.selectAll(".bar-group").filter(function(t,e){return e===i}).select(".bar"),r=s.attr("data-color");s.style("fill",function(){return r}),n.tooltipShow(e,n.chart.selectAll(".bar").filter(function(t,e){return e===i})._groups[0]),n.hovered.emit({event:t,data:e})},this.legendMouseOut=function(){n.chart.selectAll(".legend-item").classed("inactive",!1),n.chart.selectAll(".bar-group").classed("inactive",!1).select(".bar").style("fill",null),n.tooltipHide()},this.legendMouseClick=function(t,e,i,a){n.clicked.emit({event:t,data:e})},this.tooltipShow=function(t,e){var i,s=e[0].getBoundingClientRect(),r=n._scroll.getScrollPosition();switch(n.tooltipLabelFormatType){case"number":i=n.tooltipLabelFormat(t.label);break;case"time":var o=a.isoParse(t.label);i=n.tooltipLabelFormat(o);break;default:i=t.label}var l=null===n.tooltipValueFormat?'<div class="tooltip-value">'+t.value+"</div>":'<div class="tooltip-value">'+n.tooltipValueFormat(t.value)+"</div>";n.tooltip.html("\n        "+(n.hideTooltipLabel?"":""+i)+"\n        "+l+"\n      ");var h=+n.tooltip.node().offsetWidth/2,c=+n.tooltip.node().offsetHeight+8;n.tooltip.style("top",+r[1]+ +s.top-c+"px"),n.tooltip.style("left",+r[0]+ +s.left-h+ +s.width/2+"px"),n.tooltip.style("opacity",1)},this.tooltipHide=function(){n.tooltip.style("opacity",0)},this.xAxisFormatter=function(t){switch(n.xAxisFormatType){case"number":return n.xAxisFormat(t);case"time":var e=a.isoParse(t);return n.xAxisFormat(e);default:return t}},this.yAxisFormatter=function(t){switch(n.yAxisFormatType){case"number":return n.yAxisFormat(t);case"time":var e=a.isoParse(t);return n.yAxisFormat(e);default:return t}}}return t.prototype.ngOnInit=function(){var t=this;switch(this.margin={top:+this.marginTop,right:+this.marginRight,bottom:+this.marginBottom,left:+this.marginLeft},this.xAxisFormatType){case"number":this.xAxisFormat=a.format(this.xAxisFormatString);break;case"time":this.xAxisFormat=a.timeFormat(this.xAxisFormatString)}switch(this.yAxisFormatType){case"number":this.yAxisFormat=a.format(this.yAxisFormatString);break;case"time":this.yAxisFormat=a.timeFormat(this.yAxisFormatString)}switch(this.legendLabelFormatType){case"number":this.legendLabelFormat=a.format(this.legendLabelFormatString);break;case"time":this.legendLabelFormat=a.timeFormat(this.legendLabelFormatString);break;default:this.legendLabelFormat=null}switch(this.tooltipLabelFormatType){case"number":this.tooltipLabelFormat=a.format(this.tooltipLabelFormatString);break;case"time":this.tooltipLabelFormat=a.timeFormat(this.tooltipLabelFormatString);break;default:this.tooltipLabelFormat=null}switch(this.tooltipValueFormatType){case"number":this.tooltipValueFormat=a.format(this.tooltipValueFormatString);break;case"time":this.tooltipValueFormat=a.timeFormat(this.tooltipValueFormatString);break;default:this.tooltipValueFormat=null}if(this.hideGrayBars=!1,this.hideXAxis=!1,this.hideYAxis=!1,this.hideXAxisZero=!1,this.hideYAxisZero=!1,this.hideXGrid=!1,this.hideYGrid=!1,this.hideXAxisDomain=!1,this.hideYAxisDomain=!1,this.hideTooltip=!1,this.hideXAxisTicks=!1,this.hideYAxisTicks=!1,this.xAxisTickSize=8,this.xAxisTickSizeOuter=0,this.yAxisTickSize=8,this.yAxisTickSizeOuter=0,this.hideTooltipLabel=!1,"debug"!==this.type){switch(this.type){case"low":this.hideGrayBars=!0,this.hideXAxis=!this.hideLegend,this.hideXAxisTicks=!0,this.hideXGrid=!0,this.hideYAxisDomain=!1,this.hideYAxisTicks=!0,this.legendPosition="bottom",this.hideTooltipLabel=!0;break;case"medium":this.hideXAxisDomain=!0,this.hideXAxis=!this.hideLegend,this.hideXGrid=!0,this.hideXAxisTicks=!0,this.hideYAxisDomain=!0,this.hideYAxisTicks=!0,this.hideYGrid=!0,this.hideTooltipLabel=!0;break;case"high":this.hideXAxis=!0,this.hideXAxisDomain=!0,this.hideXGrid=!0,this.hideYAxisDomain=!0,this.hideYAxisTicks=!0,this.hideYGrid=!0,this.hideLegend=!0,this.hideTooltipLabel=!1}this.singleSeries&&(this.hideLegend=!0,this.hideXAxis=!0,this.hideXGrid=!0,this.hideTooltipLabel=!1)}this.hideXAxis&&(this.margin.bottom=10),this.hideLegend||"right"!==this.legendPosition||(this.width=+this.width-+this.legendWidth),this.chart=a.select(this._element.nativeElement).attr("aria-hidden","true"),this.svg=this.chart.append("svg").attr("width",+this.width).attr("height",+this.height+this.margin.top+this.margin.bottom).attr("class","img-fluid").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","-"+this.margin.left+" -"+this.margin.top+" "+ +this.width+" "+(+this.height+this.margin.top+this.margin.bottom)),this.colorRange=a.scaleOrdinal().range(this._dataviz.createGradientDefs(this.svg,this.singleSeries,this.theme)),this.xAxisScale=a.scaleBand().domain(this.data.map(function(t){return t.label})).rangeRound([0,this.width-this.margin.left]).align(0),this.hideGrayBars?this.xAxisScale.paddingInner(0).paddingOuter(0):this.xAxisScale.paddingInner(.1).paddingOuter(0),this.xAxisCall=a.axisBottom(this.xAxisScale).tickSize(this.xAxisTickSize).tickSizeOuter(this.xAxisTickSizeOuter).tickFormat(this.xAxisFormatter),this.xAxis=this.svg.append("g").attr("class","axis axis-x").attr("transform","translate(0, "+this.height+")").classed("axis-hidden",this.hideXAxis).classed("axis-zero-hidden",this.hideXAxisZero).classed("axis-domain-hidden",this.hideXAxisDomain).classed("axis-ticks-hidden",this.hideXAxisTicks).call(this.xAxisCall),this.hideXGrid||(this.xGridCall=a.axisBottom(this.xAxisScale).tickSize(-this.height),this.xGrid=this.svg.append("g").attr("class","grid grid-x").classed("grid-zero-hidden",this.hideXAxisZero).attr("transform","translate(0, "+this.height+")").call(this.xGridCall)),this.yAxisScale=a.scaleLinear().domain([a.min(this.data,function(e){return e.value-e.value*+t.yAxisMinBuffer}),a.max(this.data,function(e){return e.value+e.value*+t.yAxisMaxBuffer})]).nice().rangeRound([this.height,0]),this.yAxisCall=a.axisLeft(this.yAxisScale).ticks(this.yAxisTicks).tickSize(this.yAxisTickSize).tickSizeOuter(this.yAxisTickSizeOuter).tickFormat(this.yAxisFormatter),this.yAxis=this.svg.append("g").attr("class","axis axis-y").classed("axis-hidden",this.hideYAxis).classed("axis-zero-hidden",this.hideYAxisZero).classed("axis-domain-hidden",this.hideYAxisDomain).classed("axis-ticks-hidden",this.hideYAxisTicks).call(this.yAxisCall),this.hideYGrid||(this.yGridCall=a.axisLeft(this.yAxisScale).ticks(this.yAxisTicks).tickSize(-this.width+this.margin.left+this.margin.right),this.yGrid=this.svg.append("g").attr("class","grid grid-y").classed("grid-zero-hidden",this.hideYAxisZero).attr("transform","translate(0, 0)").call(this.yGridCall)),this.threshold&&(this.yThreshold=this.svg.append("line").attr("class","threshold").attr("x2",+this.width).attr("transform","translate(0,  "+this.yAxisScale(+this.threshold)+")")),this.average&&(this.yAverage=this.svg.append("line").attr("class","average").attr("x2",+this.width).attr("transform","translate(0,  "+this.yAxisScale(+this.average)+")")),this.hideTooltip||(this.tooltip=a.select("body").append("div").attr("class","pbds-tooltip south").style("opacity",0).attr("aria-hidden","true")),this.hideLegend||(this.chart.classed("pbds-chart-legend-bottom","bottom"===this.legendPosition),this.chart.append("ul").attr("class","legend legend-"+this.legendPosition)),this.updateChart()},t.prototype.ngOnChanges=function(t){t.data&&!t.data.firstChange&&this.updateChart()},t.prototype.ngOnDestroy=function(){this.tooltip&&this.tooltip.remove()},t.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-bar",template:"",changeDetection:e.ChangeDetectionStrategy.OnPush}]}],t.ctorParameters=function(){return[{type:l},{type:e.ElementRef},{type:i.ViewportScroller},{type:i.Location}]},t.propDecorators={chartClass:[{type:e.HostBinding,args:["class.pbds-chart"]}],barClass:[{type:e.HostBinding,args:["class.pbds-chart-bar"]}],data:[{type:e.Input}],width:[{type:e.Input}],height:[{type:e.Input}],type:[{type:e.Input}],singleSeries:[{type:e.Input}],xAxisFormatType:[{type:e.Input}],xAxisFormatString:[{type:e.Input}],yAxisFormatType:[{type:e.Input}],yAxisFormatString:[{type:e.Input}],yAxisTicks:[{type:e.Input}],yAxisMinBuffer:[{type:e.Input}],yAxisMaxBuffer:[{type:e.Input}],hideLegend:[{type:e.Input}],legendWidth:[{type:e.Input}],legendPosition:[{type:e.Input}],legendLabelFormatType:[{type:e.Input}],legendLabelFormatString:[{type:e.Input}],tooltipLabelFormatType:[{type:e.Input}],tooltipLabelFormatString:[{type:e.Input}],tooltipValueFormatType:[{type:e.Input}],tooltipValueFormatString:[{type:e.Input}],marginTop:[{type:e.Input}],marginRight:[{type:e.Input}],marginBottom:[{type:e.Input}],marginLeft:[{type:e.Input}],threshold:[{type:e.Input}],average:[{type:e.Input}],theme:[{type:e.Input}],hovered:[{type:e.Output}],clicked:[{type:e.Output}]},t}();var d=function(){function t(t,i,s,r){var n=this;this._dataviz=t,this._element=i,this._scroll=s,this._location=r,this.chartClass=!0,this.lineClass=!0,this.width=306,this.height=400,this.type="medium",this.area=!1,this.xAxisFormatString="",this.xAxisTicks=6,this.yAxisFormatString="",this.yAxisTicks=5,this.yAxisMinBuffer=.01,this.yAxisMaxBuffer=.01,this.hideLegend=!1,this.legendWidth=133,this.legendPosition="right",this.legendLabelFormatType=null,this.legendLabelFormatString="",this.tooltipHeadingFormatString="",this.tooltipLabelFormatType=null,this.tooltipLabelFormatString="",this.tooltipValueFormatType=null,this.tooltipValueFormatString="",this.marginTop=10,this.marginRight=20,this.marginBottom=30,this.marginLeft=55,this.hovered=new e.EventEmitter,this.clicked=new e.EventEmitter,this.tooltipHovered=new e.EventEmitter,this.tooltipClicked=new e.EventEmitter,this.updateChart=function(){n.mouserect.data(n.data),n.xAxisScale.domain(a.extent(n.data.dates,function(t,e){return a.isoParse(t)})),n.yAxisScale.domain([a.min(n.data.series,function(t,e){var i=+a.min(t.values);return i-i*+n.yAxisMinBuffer}),a.max(n.data.series,function(t,e){var i=+a.max(t.values);return i+i*n.yAxisMaxBuffer})]).nice(),n.xAxis.transition().duration(1e3).call(n.xAxisCall),n.yAxis.transition().duration(1e3).call(n.yAxisCall),n.hideXGrid||n.xGrid.transition().duration(1e3).call(n.xGridCall),n.hideYGrid||n.yGrid.transition().duration(1e3).call(n.yGridCall);var t=n.svg.selectAll(".line-group").data(n.data.series);t.exit().remove(),t.select("path.line").transition().duration(1e3).attr("d",function(t){return n.d3line(t.values)}),n.area&&t.select("path.area").transition().duration(1e3).attr("d",function(t){return n.d3area(t.values)}),t.selectAll("circle").data(function(t){return t.values}).transition().duration(1e3).attr("cx",function(t,e){return n.xAxisScale(a.isoParse(n.data.dates[e]))}).attr("cy",function(t){return n.yAxisScale(t)});var e=t.enter().append("g").attr("class","line-group"),i=e.append("path").attr("class","line").style("color",function(t){return n.colorRange(t.label)}).style("stroke-width",n.lineWidth).transition().duration(1e3).attr("d",function(t){return n.d3line(t.values)});(n.area&&e.append("path").attr("class","area").attr("d",function(t){return n.d3area(t.values)}).style("color",function(t){return n.colorRange(t.label)}),n.linePoints)&&e.append("g").attr("class","points").style("color",function(t){return n.colorRange(t.label)}).selectAll("circle").data(function(t){return t.values}).enter().append("circle").attr("cx",function(t,e){return n.xAxisScale(a.isoParse(n.data.dates[e]))}).attr("cy",function(t){return n.yAxisScale(t)}).attr("r",2*n.lineWidth).style("stroke-width",n.lineWidth);if("high"!==n.type&&i.attr("filter","url("+n._location.path()+"#glow)"),!n.hideLegend){var s=n.chart.select(".legend").selectAll(".legend-item").data(n.data.series);s.exit().remove(),s.select(".legend-label").html(function(t){switch(n.legendLabelFormatType){case"number":return n.legendLabelFormat(t.label);case"time":var e=a.isoParse(t.label);return n.legendLabelFormat(e);default:return t.label}});var r=s.enter().append("li").attr("class","legend-item");r.append("span").attr("class","legend-key").style("background-color",function(t){return n.colorRange(t.label)}),r.append("span").attr("class","legend-label").html(function(t){switch(n.legendLabelFormatType){case"number":return n.legendLabelFormat(t.label);case"time":var e=a.isoParse(t.label);return n.legendLabelFormat(e);default:return t.label}}),r.on("mouseover",function(t,e,i){return n.legendMouseOver(a.event,t,e,i)}).on("mouseout",function(){return n.legendMouseOut()}).on("click",function(t,e,i){return n.legendMouseClick(a.event,t,e,i)})}if(!n.hideTooltip){var o=n.tooltip.select(".tooltip-table").selectAll("tr").data(n.data.series);o.exit().remove(),o.select(".tooltip-label pr-2").html(function(t){return n.tooltipHeadingFormat(t.label)});var l=o.enter().append("tr").attr("class","tooltip-item");l.append("td").style("color",function(t){return n.colorRange(t.label)}).append("span").attr("class","pbds-tooltip-key"),l.append("td").attr("class","tooltip-label pr-2 text-nowrap").html(function(t){return n.tooltipLabelFormatType?n.tooltipLabelFormat(t.label):t.label}),l.append("td").attr("class","tooltip-value text-right text-nowrap").html(function(t){return""})}n.mouserect.raise()},this.legendMouseOver=function(t,e,i,a){n.chart.selectAll(".legend-item").filter(function(t,e){return e!==i}).classed("inactive",!0),n.chart.selectAll(".line-group").filter(function(t,e){return e!==i}).classed("inactive",!0);var s=n.chart.selectAll(".line-group").filter(function(t,e){return e===i});(s.classed("active",!0),n.linePoints)&&s.selectAll("circle").classed("active",!0);n.hovered.emit({event:t,data:e})},this.legendMouseOut=function(){(n.chart.selectAll(".legend-item").classed("inactive",!1),n.chart.selectAll(".line-group").classed("inactive",!1).classed("active",!1),n.linePoints)&&n.chart.selectAll("circle").classed("active",!1)},this.legendMouseClick=function(t,e,i,a){n.clicked.emit({event:t,data:e})},this.mouserectMouseMove=function(t,e,i){var s=n.xAxisScale.invert(a.mouse(i[0])[0]),r=a.bisectLeft(n.data.dates,a.isoFormat(s));if(0===r)return!1;var o=new Date(n.data.dates[r-1]),l=new Date(n.data.dates[r]),h=+s-+o>+l-s?l:o,c=n.data.dates.indexOf(a.isoFormat(h)),d=n.svg.selectAll(".line-group").selectAll("circle");d.filter(function(t,e){return e===c}).classed("active",!0),d.filter(function(t,e){return e!==c}).classed("active",!1),n.tooltipLine.attr("x1",n.xAxisScale(h)).attr("x2",n.xAxisScale(h)).classed("active",!0),n.tooltipShow(n.tooltipLine.node(),c),n.mousedata={date:h,series:n.data.series.map(function(t){return{label:t.label,value:t.values[c]}})},n.tooltipHovered.emit({event:t,data:n.mousedata})},this.mouserectMouseOut=function(t,e,i){n.svg.selectAll("circle").classed("active",!1),n.tooltipLine.classed("active",!1),n.tooltipHide()},this.mouserectMouseClick=function(){n.tooltipClicked.emit({event:event,data:n.mousedata})},this.tooltipShow=function(t,e){var i,s=n._scroll.getScrollPosition(),r=t.getBoundingClientRect(),o=+n.tooltip.node().offsetHeight,l=n.tooltip.node().getBoundingClientRect(),h=r.left+l.width+8,c=document.body.clientWidth-10;n.tooltip.select(".tooltip-header").html(function(t){var i=a.isoParse(n.data.dates[e]);return n.tooltipHeadingFormat(i)}),n.tooltip.selectAll(".tooltip-value").html(function(t,i){return n.tooltipValueFormatType?n.tooltipValueFormat(n.data.series[i].values[e]):n.data.series[i].values[e]}),h>c?(n.tooltip.classed("east",!0),n.tooltip.classed("west",!1),i=r.left-l.width-8+"px"):h<c&&(n.tooltip.classed("east",!1),n.tooltip.classed("west",!0),i=r.left+8+"px"),n.tooltip.style("top",r.top+r.height/2-o/2+s[1]+"px"),n.tooltip.style("left",i),n.tooltip.style("opacity",1)},this.tooltipHide=function(){n.tooltip.style("opacity",0)},this.xAxisFormatter=function(t){var e=a.isoParse(t);return n.xAxisFormat(e)},this.yAxisFormatter=function(t){return n.yAxisFormat(t)}}return t.prototype.ngOnInit=function(){var t=this;switch(this.margin={top:+this.marginTop,right:+this.marginRight,bottom:+this.marginBottom,left:+this.marginLeft},this.xAxisFormat=a.timeFormat(this.xAxisFormatString),this.yAxisFormat=a.format(this.yAxisFormatString),this.legendLabelFormatType){case"number":this.legendLabelFormat=a.format(this.legendLabelFormatString);break;case"time":this.legendLabelFormat=a.timeFormat(this.legendLabelFormatString);break;default:this.legendLabelFormat=null}switch(this.tooltipHeadingFormat=a.timeFormat(this.tooltipHeadingFormatString),this.tooltipLabelFormatType){case"number":this.tooltipLabelFormat=a.format(this.tooltipLabelFormatString);break;case"time":this.tooltipLabelFormat=a.timeFormat(this.tooltipLabelFormatString);break;default:this.tooltipLabelFormat=null}switch(this.tooltipValueFormatType){case"number":this.tooltipValueFormat=a.format(this.tooltipValueFormatString);break;case"time":this.tooltipValueFormat=a.timeFormat(this.tooltipValueFormatString);break;default:this.tooltipValueFormat=null}if(this.lineWidth=3,this.lineCurved=!0,this.linePoints=!0,this.hideXAxis=!1,this.hideYAxis=!1,this.hideXAxisZero=!1,this.hideYAxisZero=!1,this.hideXGrid=!1,this.hideYGrid=!1,this.hideXAxisDomain=!1,this.hideYAxisDomain=!1,this.hideTooltip=!1,this.hideXAxisTicks=!1,this.hideYAxisTicks=!1,this.xAxisTickSize=8,this.xAxisTickSizeOuter=0,this.yAxisTickSize=8,this.yAxisTickSizeOuter=0,"debug"!==this.type)switch(this.type){case"medium":this.hideXGrid=!0,this.hideXAxisTicks=!0,this.hideYAxisTicks=!0,this.hideYGrid=!0;break;case"high":this.lineWidth=2,this.lineCurved=!1,this.linePoints=!1,this.hideXAxisTicks=!0,this.hideYAxisTicks=!0}(this.hideXAxis&&(this.margin.bottom=10),this.hideLegend||"right"!==this.legendPosition||(this.width=+this.width-+this.legendWidth),this.d3line=a.line().x(function(e,i){return t.xAxisScale(a.isoParse(t.data.dates[i]))}).y(function(e){return t.yAxisScale(e)}),this.lineCurved&&this.d3line.curve(a.curveCatmullRom.alpha(.5)),this.area&&(this.d3area=a.area().x(function(e,i){return t.xAxisScale(a.isoParse(t.data.dates[i]))}).y0(this.height).y1(function(e,i){return t.yAxisScale(e)}),this.lineCurved&&this.d3area.curve(a.curveCatmullRom.alpha(.5))),this.chart=a.select(this._element.nativeElement).attr("aria-hidden","true"),this.svg=this.chart.append("svg").attr("width",+this.width+this.margin.right).attr("height",+this.height+this.margin.top+this.margin.bottom).attr("class","img-fluid").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","-"+this.margin.left+" -"+this.margin.top+" "+(+this.width+this.margin.right)+" "+(+this.height+this.margin.top+this.margin.bottom)),this.mouserect=this.svg.append("rect").attr("width",this.width-this.margin.left-this.margin.right).attr("height",this.height).attr("class","mouserect").on("mousemove",function(e,i,s){return t.mouserectMouseMove(a.event,i,s)}).on("mouseout",function(e,i,s){return t.mouserectMouseOut(a.event,i,s)}).on("click",function(e,i,a){return t.mouserectMouseClick()}),this.tooltipLine=this.svg.append("line").attr("y1",0).attr("y2",this.height).attr("class","tooltip-line"),this.colorRange=a.scaleOrdinal().range(this._dataviz.getColors(!1,this.theme)),this._dataviz.createGlowFilter(this.svg),this.xAxisScale=a.scaleTime().domain(a.extent(this.data.dates,function(t,e){return a.isoParse(t)})).range([0,this.width-this.margin.left-this.margin.right]),this.xAxisCall=a.axisBottom(this.xAxisScale).ticks(+this.xAxisTicks).tickSize(this.xAxisTickSize).tickSizeOuter(this.xAxisTickSizeOuter).tickFormat(this.xAxisFormatter),this.xAxis=this.svg.append("g").attr("class","axis axis-x").attr("transform","translate(0, "+this.height+")").classed("axis-hidden",this.hideXAxis).classed("axis-zero-hidden",this.hideXAxisZero).classed("axis-domain-hidden",this.hideXAxisDomain).classed("axis-ticks-hidden",this.hideXAxisTicks).call(this.xAxisCall),this.hideXGrid||(this.xGridCall=a.axisBottom(this.xAxisScale).tickSize(-this.height),this.xGrid=this.svg.append("g").attr("class","grid grid-x").classed("grid-zero-hidden",this.hideXAxisZero).attr("transform","translate(0, "+this.height+")").call(this.xGridCall)),this.yAxisScale=a.scaleLinear().domain([a.min(this.data.series,function(e,i){var s=+a.min(e.values);return s-s*+t.yAxisMinBuffer}),a.max(this.data.series,function(e,i){var s=+a.max(e.values);return s+s*t.yAxisMaxBuffer})]).nice().range([this.height,0]),this.yAxisCall=a.axisLeft(this.yAxisScale).ticks(this.yAxisTicks).tickSize(this.yAxisTickSize).tickSizeOuter(this.yAxisTickSizeOuter).tickFormat(this.yAxisFormatter),this.yAxis=this.svg.append("g").attr("class","axis axis-y").classed("axis-hidden",this.hideYAxis).classed("axis-zero-hidden",this.hideYAxisZero).classed("axis-domain-hidden",this.hideYAxisDomain).classed("axis-ticks-hidden",this.hideYAxisTicks).call(this.yAxisCall),this.hideYGrid||(this.yGridCall=a.axisLeft(this.yAxisScale).ticks(this.yAxisTicks).tickSize(-this.width+this.margin.left+this.margin.right),this.yGrid=this.svg.append("g").attr("class","grid grid-y").classed("grid-zero-hidden",this.hideYAxisZero).attr("transform","translate(0, 0)").call(this.yGridCall)),this.hideTooltip)||(this.tooltip=a.select("body").append("div").attr("class","pbds-tooltip west").style("opacity",0).attr("aria-hidden","true"),this.tooltip.append("div").attr("class","tooltip-header"),this.tooltip.append("table").attr("class","tooltip-table text-left w-100").append("tbody").selectAll("tr").data(this.data).enter().append("tr"));this.hideLegend||(this.chart.classed("pbds-chart-legend-bottom","bottom"===this.legendPosition),this.chart.append("ul").attr("class","legend legend-"+this.legendPosition)),this.updateChart()},t.prototype.ngOnChanges=function(t){t.data&&!t.data.firstChange&&this.updateChart()},t.prototype.ngOnDestroy=function(){this.tooltip&&this.tooltip.remove()},t.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-line",template:"",changeDetection:e.ChangeDetectionStrategy.OnPush}]}],t.ctorParameters=function(){return[{type:l},{type:e.ElementRef},{type:i.ViewportScroller},{type:i.Location}]},t.propDecorators={chartClass:[{type:e.HostBinding,args:["class.pbds-chart"]}],lineClass:[{type:e.HostBinding,args:["class.pbds-chart-line"]}],data:[{type:e.Input}],width:[{type:e.Input}],height:[{type:e.Input}],type:[{type:e.Input}],area:[{type:e.Input}],xAxisFormatString:[{type:e.Input}],xAxisTicks:[{type:e.Input}],yAxisFormatString:[{type:e.Input}],yAxisTicks:[{type:e.Input}],yAxisMinBuffer:[{type:e.Input}],yAxisMaxBuffer:[{type:e.Input}],hideLegend:[{type:e.Input}],legendWidth:[{type:e.Input}],legendPosition:[{type:e.Input}],legendLabelFormatType:[{type:e.Input}],legendLabelFormatString:[{type:e.Input}],tooltipHeadingFormatString:[{type:e.Input}],tooltipLabelFormatType:[{type:e.Input}],tooltipLabelFormatString:[{type:e.Input}],tooltipValueFormatType:[{type:e.Input}],tooltipValueFormatString:[{type:e.Input}],marginTop:[{type:e.Input}],marginRight:[{type:e.Input}],marginBottom:[{type:e.Input}],marginLeft:[{type:e.Input}],theme:[{type:e.Input}],hovered:[{type:e.Output}],clicked:[{type:e.Output}],tooltipHovered:[{type:e.Output}],tooltipClicked:[{type:e.Output}]},t}();var u=function(){function t(t,e){var i=this;this._dataviz=t,this._element=e,this.chartClass=!0,this.gaugeClass=!0,this.width=300,this.type="halfmoon",this.color="#E23DA8",this.hideLabel=!1,this.labelFormatString="",this.gaugeWidth=20,this.degreesToRadians=function(t){return t*Math.PI/180},this.calculateMinMax=function(){return i.data.minvalue/(i.data.maxvalue-i.data.minvalue)*(i.data.value-i.data.minvalue)+(i.data.value-i.data.minvalue)},this.calculateCurve=function(t){var e=i.degreesToRadians(i.startAngle);return[{startAngle:e,endAngle:e+t*(i.degreesToRadians(i.endAngle)-e)/i.data.maxvalue}]},this.drawChart=function(){switch(i.gauge=i.svg.append("g").attr("class","gauge-group"),i.gauge.append("path").data(i.calculateCurve(i.data.maxvalue)).attr("class","gauge-background").attr("d",function(t){return i.arc({innerRadius:i.radius-i.gaugeWidth,outerRadius:i.radius,startAngle:t.startAngle,endAngle:t.endAngle})}),i.gauge.append("path").data(i.calculateCurve(i.calculateMinMax())).attr("class","gauge-value").attr("fill",i.color).attr("d",function(t){return i.arc({innerRadius:i.radius-i.gaugeWidth,outerRadius:i.radius,startAngle:t.startAngle,endAngle:t.endAngle})}),i.type){case"horseshoe":i.svg.attr("height",230).attr("viewBox","-"+i.width/2+" -"+i.height/2+" "+i.height+" 230");break;case"halfmoon":i.svg.attr("height",i.width/2),i.svg.attr("viewBox","-"+i.width/2+" -"+i.width/2+" "+i.width+" "+i.width/2)}},this.updateChart=function(){i.svg.select(".gauge-group").select(".gauge-value").transition().duration(750).call(i.arcTween,i.calculateMinMax()),i.labelTween=i.chart.select(".gauge-number"),i.labelTween.transition().duration(750).call(i.textTween,i.data.value)},this.arcTween=function(t,e){var s=i.calculateCurve(e);t.attrTween("d",function(t){var e=a.interpolate(t.endAngle,s[0].endAngle);return function(a){return t.endAngle=e(a),i.arc({innerRadius:i.radius-i.gaugeWidth,outerRadius:i.radius,startAngle:t.startAngle,endAngle:t.endAngle})}})},this.textTween=function(t,e){e=(e=a.format(".2f")(e)).replace(/,/g,"."),t.tween("text",function(){var t=a.interpolate(a.format(".2f")(+i.oldValue),e);return function(e){i.labelTween.text(function(a){var s=i.labelFormat(t(e));return i.label=s,s})}})}}return t.prototype.ngOnInit=function(){switch(this.height=this.width,this.radius=Math.max(this.width,this.height)/2,this.labelFormat=a.format(this.labelFormatString),this.label=this.labelFormat(this.data.value),this.type){case"halfmoon":this.startAngle=-90,this.endAngle=90,this.rounded=!0;break;case"horseshoe":this.startAngle=-140,this.endAngle=140,this.rounded=!0;break;case"circle":this.startAngle=0,this.endAngle=360,this.rounded=!1}this.arc=a.arc().cornerRadius(this.rounded?this.gaugeWidth:0),this.chart=a.select(this._element.nativeElement).attr("aria-hidden","true"),this.svg=this.chart.append("svg").attr("width",this.width).attr("height",this.height).attr("class","img-fluid").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","-"+this.width/2+" -"+this.height/2+" "+this.width+" "+this.height),this.drawChart()},t.prototype.ngOnChanges=function(t){t.data&&!t.data.firstChange&&(this.oldValue=t.data.previousValue.value,this.updateChart())},t.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-gauge",template:'\n    <div\n      *ngIf="!hideLabel"\n      class="gauge-details"\n      [ngClass]="{ halfmoon: type === \'halfmoon\', \'gauge-details-small\': type === \'halfmoon\' }"\n      [ngStyle]="{ \'max-width.px\': width - 3 * gaugeWidth }"\n    >\n      <div class="gauge-number">{{ label }}</div>\n      <div *ngIf="description" class="gauge-description text-center">{{ description }}</div>\n    </div>\n  '}]}],t.ctorParameters=function(){return[{type:l},{type:e.ElementRef}]},t.propDecorators={chartClass:[{type:e.HostBinding,args:["class.pbds-chart"]}],gaugeClass:[{type:e.HostBinding,args:["class.pbds-chart-gauge"]}],data:[{type:e.Input}],width:[{type:e.Input}],type:[{type:e.Input}],color:[{type:e.Input}],hideLabel:[{type:e.Input}],labelFormatString:[{type:e.Input}],description:[{type:e.Input}],gaugeWidth:[{type:e.Input}]},t}();var p=function(){function t(t){this._element=t,this.chartClass=!0,this.sparklineClass=!0,this.width=160,this.height=40,this.type="line",this.color="#E23DA8",this.colorNegative=null,this.strokeWidth=2,this.yAxisMinBuffer=0,this.yAxisMaxBuffer=0}return t.prototype.ngOnInit=function(){var t=this;this.margin={top:1,right:0,bottom:1,left:0},"bar"===this.type&&(this.margin={top:0,right:0,bottom:0,left:0}),"line-high"!==this.type&&"area-high"!==this.type||(this.strokeWidth=1),null===this.colorNegative&&(this.colorNegative=this.color);var e=a.scaleLinear().range([0,this.width-this.margin.left-this.margin.right]),i=a.scaleLinear().range([this.height-this.margin.top-this.margin.bottom,0]);i.domain([+a.min(this.data)-this.yAxisMinBuffer,+a.max(this.data)+this.yAxisMaxBuffer]),e.domain([0,this.data.length]);var s=a.line().x(function(t,i){return e(i)}).y(function(t){return i(t)}),r=a.area().x(function(t,i){return e(i)}).y0(this.height).y1(function(t){return i(t)});if(this.chart=a.select(this._element.nativeElement).attr("aria-hidden","true"),this.svg=this.chart.append("svg").attr("width",this.width).attr("height",this.height).attr("class","img-fluid").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","-"+this.margin.left+" -"+this.margin.top+" "+this.width+" "+this.height),"line"!==this.type&&"line-high"!==this.type&&"area"!==this.type&&"area-high"!==this.type||this.svg.append("path").datum(this.data).attr("class","sparkline").attr("fill","none").attr("stroke-width",this.strokeWidth).attr("stroke",this.color).attr("d",s),"area"!==this.type&&"area-high"!==this.type||this.svg.append("path").datum(this.data).attr("class","sparkarea").attr("fill",this.color).attr("fill-opacity",.3).attr("d",r),"bar"===this.type){var n=(this.width-this.data.length)/this.data.length;this.svg.selectAll(".bar").data(this.data).enter().append("rect").attr("class","sparkbar").attr("x",function(t,i){return e(i)}).attr("y",function(t){return i(t>0?t:0)}).attr("width",n).attr("height",function(t){return Math.abs(i(t)-i(0))}).attr("fill",function(e){return e>0?t.color:t.colorNegative})}},t.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-sparkline",template:"",changeDetection:e.ChangeDetectionStrategy.OnPush}]}],t.ctorParameters=function(){return[{type:e.ElementRef}]},t.propDecorators={chartClass:[{type:e.HostBinding,args:["class.pbds-chart"]}],sparklineClass:[{type:e.HostBinding,args:["class.pbds-chart-sparkline"]}],data:[{type:e.Input}],width:[{type:e.Input}],height:[{type:e.Input}],type:[{type:e.Input}],color:[{type:e.Input}],colorNegative:[{type:e.Input}],strokeWidth:[{type:e.Input}],yAxisMinBuffer:[{type:e.Input}],yAxisMaxBuffer:[{type:e.Input}]},t}();var g=function(){function t(t,i,s){var r=this;this._dataviz=t,this._element=i,this._scroll=s,this.chartClass=!0,this.stackedBarClass=!0,this.width=306,this.height=400,this.type="medium",this.marginTop=10,this.marginRight=0,this.marginBottom=30,this.marginLeft=55,this.hideXAxis=!1,this.xAxisFormatType=null,this.xAxisFormatString="",this.yAxisFormatType=null,this.yAxisFormatString="",this.yAxisTicks=5,this.yAxisMaxBuffer=.01,this.hideLegend=!1,this.legendWidth=133,this.legendPosition="right",this.legendLabelFormatType=null,this.legendLabelFormatString="",this.tooltipHeadingFormatType=null,this.tooltipHeadingFormatString="",this.tooltipHeadingValueFormatType=null,this.tooltipHeadingValueFormatString="",this.tooltipLabelFormatType=null,this.tooltipLabelFormatString="",this.tooltipValueFormatType=null,this.tooltipValueFormatString="",this.hovered=new e.EventEmitter,this.clicked=new e.EventEmitter,this.updateChart=function(){if(r.dataKeys=Object.keys(r.data[0]).filter(function(t){return"key"!==t}),r.dataStack=a.stack().keys(r.dataKeys).order(a.stackOrderNone)(r.data),r.xAxisScale.domain(r.data.map(function(t){return t.key})),r.yAxisMax=a.max(r.dataStack,function(t){return a.max(t,function(t){return t[1]})}),r.yAxisMax=r.yAxisMax+r.yAxisMax*r.yAxisMaxBuffer,r.yAxisScale.domain([0,r.yAxisMax]).rangeRound([r.height,0]).nice(),r.xAxis.transition().duration(1e3).call(r.xAxisCall),r.yAxis.transition().duration(1e3).call(r.yAxisCall),r.hideXGrid||r.xGrid.transition().duration(1e3).call(r.xGridCall),r.hideYGrid||r.yGrid.transition().duration(1e3).call(r.yGridCall),r.hideGrayBars||r.grayBars.selectAll(".gray-bar").data(r.data).join(function(t){return t.append("rect").attr("class","gray-bar").attr("x",function(t){return r.xAxisScale(t.key)}).attr("width",r.xAxisScale.bandwidth()).attr("height",r.height)},function(t){return t.transition().duration(1e3).attr("x",function(t){return r.xAxisScale(t.key)}).attr("width",r.xAxisScale.bandwidth()).attr("height",r.height)},function(t){return t.remove()}),r.bars.selectAll(".bar-group").data(r.dataStack).join(function(t){return t.append("g").attr("class","bar-group").attr("fill",function(t){return r.colorRange(t.index)})},function(t){return t.attr("fill",function(t){return r.colorRange(t.index)})},function(t){return t.remove()}).selectAll(".bar").data(function(t){return t}).join(function(t){return t.append("rect").attr("class","bar").classed("bar-divided","high"!==r.type).classed("bar-divided-low","low"===r.type).attr("x",function(t,e){return"medium"===r.type?r.xAxisScale(t.data.key)+r.xAxisScale.bandwidth()/8*3:r.xAxisScale(t.data.key)+r.xAxisScale.bandwidth()/4*1}).attr("y",function(t){return r.yAxisScale(t[1])}).attr("width",0).attr("height",0).call(function(t){var e;return e="medium"===r.type?r.xAxisScale.bandwidth()/4:r.xAxisScale.bandwidth()/2,t.transition().duration(1e3).attr("width",e).attr("height",function(t){return r.yAxisScale(t[0])-r.yAxisScale(t[1])}),t})},function(t){return t.call(function(t){return"medium"===r.type?r.xAxisScale.bandwidth()/4:r.xAxisScale.bandwidth()/2,t.transition().duration(1e3).attr("width",r.xAxisScale.bandwidth()/4).attr("x",function(t,e){return r.xAxisScale(t.data.key)+r.xAxisScale.bandwidth()/8*3}).attr("y",function(t){return r.yAxisScale(t[1])}).attr("height",function(t){return r.yAxisScale(t[0])-r.yAxisScale(t[1])}),t})},function(t){return t.remove()}),r.mouseBars.selectAll(".mouseover-bar").data(r.data).join(function(t){return t.append("rect").attr("class","mouseover-bar").style("opacity",0).attr("x",function(t){return r.xAxisScale(t.key)}).attr("width",r.xAxisScale.bandwidth()).attr("height",r.height)},function(t){return t.attr("x",function(t){return r.xAxisScale(t.key)}).attr("width",r.xAxisScale.bandwidth()).attr("height",r.height)},function(t){return t.remove()}).on("mouseover",function(t,e,i){return r.barMouseOver(a.event,t,e,i)}).on("mouseout",function(t,e,i){return r.barMouseOut()}).on("click",function(t,e,i){return r.barMouseClick(a.event,t,e,i)}),r.bars.raise(),r.xAxis.raise(),r.mouseBars.raise(),!r.hideLegend){var t=r.chart.select(".legend").selectAll(".legend-item").data(r.dataStack);t.exit().remove(),t.select(".legend-label").html(function(t){switch(r.legendLabelFormatType){case"number":return r.legendLabelFormat(t.key);case"time":var e=a.isoParse(t.key);return r.legendLabelFormat(e);default:return t.key}});var e=t.enter().append("li").attr("class","legend-item");e.append("span").attr("class","legend-key").style("background-color",function(t){return r.colorRange(t.index)}),e.append("span").attr("class","legend-label").html(function(t){switch(r.legendLabelFormatType){case"number":return r.legendLabelFormat(t.key);case"time":var e=a.isoParse(t.key);return r.legendLabelFormat(e);default:return t.key}}),e.on("mouseover",function(t,e,i){return r.legendMouseOver(a.event,t,e,i)}).on("mouseout",function(){return r.legendMouseOut()}).on("click",function(t,e,i){return r.legendMouseClick(a.event,t,e,i)})}},this.barMouseOver=function(t,e,i,a){r.chart.selectAll(".bar-group").selectAll(".bar").filter(function(t,e){return e!==i}).classed("inactive",!0),r.tooltipShow(e,i,a[i]),r.hovered.emit({event:t,data:e})},this.barMouseOut=function(){r.chart.selectAll(".bar").classed("inactive",!1),r.tooltipHide()},this.barMouseClick=function(t,e,i,a){r.clicked.emit({event:t,data:e})},this.legendMouseOver=function(t,e,i,a){r.chart.selectAll(".legend-item").filter(function(t,e){return e!==i}).classed("inactive",!0),r.chart.selectAll(".bar-group").filter(function(t,e){return e!==i}).classed("inactive",!0),r.hovered.emit({event:t,data:e})},this.legendMouseOut=function(){r.chart.selectAll(".legend-item").classed("inactive",!1),r.chart.selectAll(".bar-group").classed("inactive",!1),r.tooltipHide()},this.legendMouseClick=function(t,e,i,a){r.clicked.emit({event:t,data:e})},this.xAxisFormatter=function(t){switch(r.xAxisFormatType){case"number":return r.xAxisFormat(t);case"time":var e=a.isoParse(t);return r.xAxisFormat(e);default:return t}},this.tooltipShow=function(t,e,i){var s,n,o,l,h,c=r._scroll.getScrollPosition(),d=i.getBoundingClientRect(),u=document.body.clientWidth-10;r.tooltip.select(".tooltip-header").html(function(e){switch(r.tooltipHeadingFormatType){case"time":var i=a.isoParse(t.key);return r.tooltipHeadingFormat(i);default:return t.key}}),r.tooltip.select(".tooltip-header-value").html(function(e){var i=0;return Object.keys(t).map(function(e){"key"!==e&&(i+=t[e])}),r.tooltipHeadingValueFormat(i)}),r.tooltip.select(".tooltip-table").select("tbody").html(function(e){var i,s,n="";return Object.keys(t).map(function(e,o){switch(r.tooltipLabelFormatType){case"time":var l=a.isoParse(e);i=r.tooltipHeadingFormat(l);break;default:i=e}switch(r.tooltipValueFormatType){case"number":s=r.tooltipValueFormat(t[e]);break;default:s=t[e]}"key"!==e&&(n+="\n              <tr class='tooltip-item'>\n                <td style=\"color: "+r.colorRange(o-1)+'">\n                  <span class="pbds-tooltip-key"></span>\n                </td>\n                <td class="tooltip-label pr-2 text-nowrap">'+i+'</td>\n                <td class="tooltip-value text-right text-nowrap">'+s+"</td>\n              </tr>\n            ")}),n}),n=r.tooltip.node().getBoundingClientRect(),s=d.left+d.width+n.width+8,o=+r.tooltip.node().offsetHeight,s>u?(r.tooltip.classed("east",!0),r.tooltip.classed("west",!1),h="medium"===r.type?d.left+d.width/8*3-n.width-8+"px":d.left+d.width/4*1-n.width-8+"px"):s<u&&(r.tooltip.classed("east",!1),r.tooltip.classed("west",!0),h="medium"===r.type?d.left+d.width/8*5+8+"px":d.left+d.width/4*3+8+"px"),l=r.svg.selectAll(".bar-group").filter(":last-child").selectAll(".bar").filter(function(t,i){return i===e}).node().getBoundingClientRect(),r.tooltip.style("top",l.top-o/2+c[1]+"px"),r.tooltip.style("left",h),r.tooltip.style("opacity",1)},this.tooltipHide=function(){r.tooltip.style("opacity",0)},this.yAxisFormatter=function(t){switch(r.yAxisFormatType){case"number":return r.yAxisFormat(t);case"time":var e=a.isoParse(t);return r.yAxisFormat(e);default:return t}}}return t.prototype.ngOnInit=function(){switch(this.dataKeys=Object.keys(this.data[0]).filter(function(t){return"key"!==t}),this.dataStack=a.stack().keys(this.dataKeys).order(a.stackOrderNone)(this.data),this.margin={top:+this.marginTop,right:+this.marginRight,bottom:+this.marginBottom,left:+this.marginLeft},this.xAxisFormatType){case"number":this.xAxisFormat=a.format(this.xAxisFormatString);break;case"time":this.xAxisFormat=a.timeFormat(this.xAxisFormatString)}switch(this.yAxisFormatType){case"number":this.yAxisFormat=a.format(this.yAxisFormatString);break;case"time":this.yAxisFormat=a.timeFormat(this.yAxisFormatString)}switch(this.legendLabelFormatType){case"number":this.legendLabelFormat=a.format(this.legendLabelFormatString);break;case"time":this.legendLabelFormat=a.timeFormat(this.legendLabelFormatString);break;default:this.legendLabelFormat=null}switch(this.tooltipHeadingFormatType){case"time":this.tooltipHeadingFormat=a.timeFormat(this.tooltipHeadingFormatString);break;default:this.tooltipHeadingFormat=null}switch(this.tooltipHeadingValueFormatType){case"number":this.tooltipHeadingValueFormat=a.format(this.tooltipHeadingValueFormatString);break;default:this.tooltipHeadingValueFormat=null}switch(this.tooltipLabelFormatType){case"time":this.tooltipLabelFormat=a.timeFormat(this.tooltipLabelFormatString);break;default:this.tooltipLabelFormat=null}switch(this.tooltipValueFormatType){case"number":this.tooltipValueFormat=a.format(this.tooltipValueFormatString);break;default:this.tooltipValueFormat=null}if(this.hideGrayBars=!1,this.hideYAxis=!1,this.hideXAxisZero=!1,this.hideYAxisZero=!1,this.hideXGrid=!1,this.hideYGrid=!1,this.hideXAxisDomain=!1,this.hideYAxisDomain=!1,this.hideTooltip=!1,this.hideXAxisTicks=!1,this.hideYAxisTicks=!1,this.xAxisTickSize=8,this.xAxisTickSizeOuter=0,this.yAxisTickSize=8,this.yAxisTickSizeOuter=0,"debug"!==this.type)switch(this.type){case"low":this.hideGrayBars=!0,this.hideXAxisTicks=!0,this.hideXGrid=!0,this.hideYAxisDomain=!1,this.hideYAxisTicks=!0,this.legendPosition="bottom";break;case"medium":this.hideXAxisDomain=!0,this.hideXGrid=!0,this.hideXAxisTicks=!0,this.hideYAxisDomain=!0,this.hideYAxisTicks=!0,this.hideYGrid=!0;break;case"high":this.hideXAxis=!0,this.hideXAxisTicks=!0,this.hideXAxisDomain=!0,this.hideXGrid=!0,this.hideYAxisDomain=!0,this.hideYAxisTicks=!0,this.hideYGrid=!0,this.hideLegend=!1,this.legendPosition="bottom"}this.hideXAxis&&(this.margin.bottom=10),this.hideLegend||"right"!==this.legendPosition||(this.width=+this.width-+this.legendWidth),this.chart=a.select(this._element.nativeElement).attr("aria-hidden","true"),this.svg=this.chart.append("svg").attr("width",+this.width).attr("height",+this.height+this.margin.top+this.margin.bottom).attr("class","img-fluid").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","-"+this.margin.left+" -"+this.margin.top+" "+ +this.width+" "+(+this.height+this.margin.top+this.margin.bottom)),this.grayBars=this.svg.append("g").attr("class","gray-bars"),this.mouseBars=this.svg.append("g").attr("class","mouseover-bars"),this.bars=this.svg.append("g").attr("class","bars"),this.colorRange=a.scaleOrdinal().range(this._dataviz.getColors(!1,this.theme)),this.xAxisScale=a.scaleBand().domain(this.data.map(function(t){return t.key})).rangeRound([0,this.width-this.margin.left]).align(0),this.hideGrayBars?this.xAxisScale.paddingInner(0).paddingOuter(0):this.xAxisScale.paddingInner(.1).paddingOuter(0),this.xAxisCall=a.axisBottom(this.xAxisScale).tickSize(this.xAxisTickSize).tickSizeOuter(this.xAxisTickSizeOuter).tickFormat(this.xAxisFormatter),this.xAxis=this.svg.append("g").attr("class","axis axis-x").attr("transform","translate(0, "+this.height+")").classed("axis-hidden",this.hideXAxis).classed("axis-zero-hidden",this.hideXAxisZero).classed("axis-domain-hidden",this.hideXAxisDomain).classed("axis-ticks-hidden",this.hideXAxisTicks).call(this.xAxisCall),this.hideXGrid||(this.xGridCall=a.axisBottom(this.xAxisScale).tickSize(-this.height),this.xGrid=this.svg.append("g").attr("class","grid grid-x").classed("grid-zero-hidden",this.hideXAxisZero).attr("transform","translate(0, "+this.height+")").call(this.xGridCall)),this.yAxisMax=a.max(this.dataStack,function(t){return a.max(t,function(t){return t[1]})}),this.yAxisMax=this.yAxisMax+this.yAxisMax*this.yAxisMaxBuffer,this.yAxisScale=a.scaleLinear().domain([0,this.yAxisMax]).nice().rangeRound([this.height,0]),this.yAxisCall=a.axisLeft(this.yAxisScale).ticks(this.yAxisTicks).tickSize(this.yAxisTickSize).tickSizeOuter(this.yAxisTickSizeOuter).tickFormat(this.yAxisFormatter),this.yAxis=this.svg.append("g").attr("class","axis axis-y").classed("axis-hidden",this.hideYAxis).classed("axis-zero-hidden",this.hideYAxisZero).classed("axis-domain-hidden",this.hideYAxisDomain).classed("axis-ticks-hidden",this.hideYAxisTicks).call(this.yAxisCall),this.hideYGrid||(this.yGridCall=a.axisLeft(this.yAxisScale).ticks(this.yAxisTicks).tickSize(-this.width+this.margin.left+this.margin.right),this.yGrid=this.svg.append("g").attr("class","grid grid-y").classed("grid-zero-hidden",this.hideYAxisZero).attr("transform","translate(0, 0)").call(this.yGridCall)),this.hideTooltip||(this.tooltip=a.select("body").append("div").attr("class","pbds-tooltip west").style("opacity",0).attr("aria-hidden","true"),this.tooltip.append("div").attr("class","tooltip-header"),this.tooltip.append("div").attr("class","tooltip-header-value"),this.tooltip.append("table").attr("class","tooltip-table text-left w-100").append("tbody")),this.hideLegend||(this.chart.classed("pbds-chart-legend-bottom","bottom"===this.legendPosition),this.chart.append("ul").attr("class","legend legend-"+this.legendPosition)),this.updateChart()},t.prototype.ngOnDestroy=function(){this.tooltip&&this.tooltip.remove()},t.prototype.ngOnChanges=function(t){t.data&&!t.data.firstChange&&this.updateChart()},t.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-stacked-bar",template:"",changeDetection:e.ChangeDetectionStrategy.OnPush}]}],t.ctorParameters=function(){return[{type:l},{type:e.ElementRef},{type:i.ViewportScroller}]},t.propDecorators={chartClass:[{type:e.HostBinding,args:["class.pbds-chart"]}],stackedBarClass:[{type:e.HostBinding,args:["class.pbds-chart-stacked-bar"]}],data:[{type:e.Input}],width:[{type:e.Input}],height:[{type:e.Input}],type:[{type:e.Input}],marginTop:[{type:e.Input}],marginRight:[{type:e.Input}],marginBottom:[{type:e.Input}],marginLeft:[{type:e.Input}],hideXAxis:[{type:e.Input}],xAxisFormatType:[{type:e.Input}],xAxisFormatString:[{type:e.Input}],yAxisFormatType:[{type:e.Input}],yAxisFormatString:[{type:e.Input}],yAxisTicks:[{type:e.Input}],yAxisMaxBuffer:[{type:e.Input}],hideLegend:[{type:e.Input}],legendWidth:[{type:e.Input}],legendPosition:[{type:e.Input}],legendLabelFormatType:[{type:e.Input}],legendLabelFormatString:[{type:e.Input}],tooltipHeadingFormatType:[{type:e.Input}],tooltipHeadingFormatString:[{type:e.Input}],tooltipHeadingValueFormatType:[{type:e.Input}],tooltipHeadingValueFormatString:[{type:e.Input}],tooltipLabelFormatType:[{type:e.Input}],tooltipLabelFormatString:[{type:e.Input}],tooltipValueFormatType:[{type:e.Input}],tooltipValueFormatString:[{type:e.Input}],theme:[{type:e.Input}],hovered:[{type:e.Output}],clicked:[{type:e.Output}]},t}();var m=function(){function t(){this.value=0,this.class="",this.indicator="flat",this.inverse=!1}return Object.defineProperty(t.prototype,"hostClasses",{get:function(){return["metric-block-indicator",this.indicator,this.inverse?"inverse":"",this.class].join(" ")},enumerable:!0,configurable:!0}),t.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-metric-indicator",template:"\n    <span>{{ value }}</span>\n  "}]}],t.propDecorators={value:[{type:e.Input}],class:[{type:e.Input}],indicator:[{type:e.Input}],inverse:[{type:e.Input}],hostClasses:[{type:e.HostBinding,args:["class"]}]},t}();var x=function(){function t(){this.class="",this.heading=null,this.value=0,this.unit=null,this.description=null,this.centered=!1,this.centeredText=!1,this.hideValueMargin=!1,this.isPercentUnit=!1,this.isUnit=!1}return Object.defineProperty(t.prototype,"hostClasses",{get:function(){return["metric-block",this.centered?"metric-block-centered":"",this.centeredText?"metric-block-centered-text":"",this.class].join(" ")},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){this.indicatorRef||(this.hideValueMargin=!0),"%"!==this.unit&&null!==this.unit?this.isUnit=!0:"%"===this.unit&&(this.isPercentUnit=!0)},t.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-metric-block",template:'\n    <div class="metric-block-inner">\n      <div *ngIf="heading" class="metric-block-heading">{{ heading }}</div>\n      <div class="metric-block-data-block">\n        <div class="metric-block-contents">\n          <div class="metric-block-value" [ngClass]="{ \'mr-0\': hideValueMargin }">\n            {{ value\n            }}<span [ngClass]="{ \'metric-block-unit\': isUnit, \'metric-block-percentage\': isPercentUnit }">{{\n              unit\n            }}</span>\n          </div>\n\n          <div *ngIf="description" class="metric-block-description">{{ description }}</div>\n          <div>\n            <ng-content select="pbds-dataviz-metric-indicator"></ng-content>\n          </div>\n        </div>\n        <ng-content select="pbds-dataviz-sparkline"></ng-content>\n      </div>\n    </div>\n  '}]}],t.propDecorators={class:[{type:e.Input}],heading:[{type:e.Input}],value:[{type:e.Input}],unit:[{type:e.Input}],description:[{type:e.Input}],centered:[{type:e.Input}],centeredText:[{type:e.Input}],hostClasses:[{type:e.HostBinding,args:["class"]}],indicatorRef:[{type:e.ContentChild,args:[m,{static:!0}]}]},t}();var f=function(){function t(t,i){var s=this;this._element=t,this._scroll=i,this.chartClass=!0,this.bubbleMapClass=!0,this.feature="",this.scale=null,this.center=null,this.width=306,this.height=400,this.type="medium",this.dot=!1,this.marginTop=0,this.marginRight=0,this.marginBottom=0,this.marginLeft=0,this.color="#ef8200",this.textColor="#fff",this.textSizeRange=[14,24],this.dotSize=4,this.bubbleSizeRange=[500,2e3],this.bubbleLabelFormatType=null,this.bubbleLabelFormatString="",this.hideTooltip=!1,this.hideTooltipValue=!1,this.tooltipValueFormatType=null,this.tooltipValueFormatString="",this.hovered=new e.EventEmitter,this.clicked=new e.EventEmitter,this.updateChart=function(){s.bubbleContainer.selectAll("circle").data(s.data).join(function(t){return t.append("circle").attr("class","dot-circle").classed("solid",s.dot).attr("cx",function(t){return s.projection([t.longitude,t.latitude])[0]}).attr("cy",function(t){return s.projection([t.longitude,t.latitude])[1]}).attr("r",function(t){return s.dot?s.dotSize+"px":Math.sqrt(s.bubbleRadius(t.value))})},function(t){return t.transition().duration(1e3).attr("cx",function(t){return s.projection([t.longitude,t.latitude])[0]}).attr("cy",function(t){return s.projection([t.longitude,t.latitude])[1]}).attr("r",function(t){return s.dot?s.dotSize+"px":Math.sqrt(s.bubbleRadius(t.value))})},function(t){return t.remove()}),s.hideTooltip||(s.bubbleContainer.selectAll("circle").on("mouseover",function(t,e,i){return s.bubbleMouseOver(a.event,t,e,i)}).on("mouseout",function(t,e,i){return s.bubbleMouseOut(a.event,t,e,i)}).on("click",function(t,e,i){return s.bubbleMouseClick(a.event,t,e,i)}),"high"===s.type||s.dot||s.bubbleContainer.selectAll("text").data(s.data).join(function(t){return t.append("text").text(function(t){return s.bubbleLabelFormat?s.bubbleLabelFormat(t.value):t.value}).attr("class","dot-text").style("fill",s.textColor).style("font-size",function(t){return Math.round(s.fontRange(t.value))+"px"}).attr("x",function(t){return s.projection([t.longitude,t.latitude])[0]}).attr("y",function(t){return s.projection([t.longitude,t.latitude])[1]}).attr("dy",".4em")},function(t){return t.transition().duration(1e3).text(function(t){return s.bubbleLabelFormat?s.bubbleLabelFormat(t.value):t.value}).style("font-size",function(t){return Math.round(s.fontRange(t.value))+"px"}).attr("x",function(t){return s.projection([t.longitude,t.latitude])[0]}).attr("y",function(t){return s.projection([t.longitude,t.latitude])[1]}).attr("dy",".4em")},function(t){return t.remove()}))},this.bubbleMouseOver=function(t,e,i,a){s.chart.selectAll(".dot-circle").filter(function(t,e){return e!==i}).classed("inactive",!0),s.chart.selectAll(".dot-circle").filter(function(t,e){return e===i}).classed("active",!0),s.tooltipShow(e,a[i]),s.hovered.emit({event:t,data:e})},this.bubbleMouseOut=function(t,e,i,a){s.chart.selectAll(".dot-circle").classed("active",!1).classed("inactive",!1),s.tooltipHide()},this.bubbleMouseClick=function(t,e,i,a){s.clicked.emit({event:t,data:e})},this.tooltipShow=function(t,e){var i=e.getBoundingClientRect(),a=s._scroll.getScrollPosition();s.tooltip.select(".tooltip-header").html(function(e){return""+t.label}),s.hideTooltipValue||s.tooltip.select(".tooltip-value").html(function(e){return s.tooltipValueFormat?""+s.tooltipValueFormat(t.value):""+t.value});var r=+s.tooltip.node().offsetWidth/2,n=+s.tooltip.node().offsetHeight+8;s.tooltip.style("top",+a[1]+ +i.top-n+"px"),s.tooltip.style("left",+a[0]+ +i.left-r+ +i.width/2+"px"),s.tooltip.style("opacity",1)},this.tooltipHide=function(){s.tooltip.style("opacity",0)}}return t.prototype.ngOnInit=function(){switch(this.margin={top:+this.marginTop,right:+this.marginRight,bottom:+this.marginBottom,left:+this.marginLeft},"debug"!==this.type&&this.type,this.projectionType){case"geoAlbers":this.projection=a.geoAlbers();break;case"geoAlbersUsa":this.projection=a.geoAlbersUsa();break;case"geoMercator":this.projection=a.geoMercator()}switch(this.bubbleLabelFormatType){case"number":this.bubbleLabelFormat=a.format(this.bubbleLabelFormatString);break;default:this.bubbleLabelFormat=null}switch(this.tooltipValueFormatType){case"number":this.tooltipValueFormat=a.format(this.tooltipValueFormatString);break;default:this.tooltipValueFormat=null}this.topojsonFeature=s.feature(this.topojson,this.topojson.objects[this.feature]),this.projection.fitSize([+this.width,+this.height],this.topojsonFeature),this.scale&&this.projection.scale(+this.scale),this.center&&this.projection.center(this.center),this.geoPath=a.geoPath().projection(this.projection),this.data&&!this.dot&&(this.bubbleRadius=a.scaleLinear().range(this.bubbleSizeRange).domain([a.min(this.data,function(t){return+t.value}),a.max(this.data,function(t){return+t.value})]),this.fontRange=a.scaleLinear().range(this.textSizeRange).domain([a.min(this.data,function(t){return+t.value}),a.max(this.data,function(t){return+t.value})])),this.hideTooltip||(this.tooltip=a.select("body").append("div").attr("class","pbds-tooltip south").style("opacity",0).attr("aria-hidden","true"),this.tooltip.append("div").attr("class","tooltip-header"),this.hideTooltipValue||this.tooltip.append("div").attr("class","tooltip-value")),this.chart=a.select(this._element.nativeElement).attr("aria-hidden","true"),this.svg=this.chart.append("svg").attr("width",+this.width).attr("height",+this.height+this.margin.top+this.margin.bottom).attr("class","img-fluid").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","-"+this.margin.left+" -"+this.margin.top+" "+ +this.width+" "+(+this.height+this.margin.top+this.margin.bottom)).append("g").attr("class","container"),this.svg.append("g").attr("class","map").selectAll("path").data(this.topojsonFeature.features).enter().append("path").attr("class","feature").attr("d",this.geoPath),this.svg.append("path").attr("class","mesh").datum(s.mesh(this.topojson,this.topojson.objects[this.feature],function(t,e){return t!==e})).attr("d",this.geoPath),this.bubbleContainer=this.svg.append("g").attr("class","dots").style("color",this.color),this.updateChart()},t.prototype.ngOnChanges=function(t){t.data&&!t.data.firstChange&&this.updateChart()},t.prototype.ngOnDestroy=function(){this.tooltip&&this.tooltip.remove()},t.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-bubble-map",template:"",changeDetection:e.ChangeDetectionStrategy.OnPush}]}],t.ctorParameters=function(){return[{type:e.ElementRef},{type:i.ViewportScroller}]},t.propDecorators={chartClass:[{type:e.HostBinding,args:["class.pbds-chart"]}],bubbleMapClass:[{type:e.HostBinding,args:["class.pbds-chart-bubble-map"]}],data:[{type:e.Input}],topojson:[{type:e.Input}],feature:[{type:e.Input}],projectionType:[{type:e.Input}],scale:[{type:e.Input}],center:[{type:e.Input}],width:[{type:e.Input}],height:[{type:e.Input}],type:[{type:e.Input}],dot:[{type:e.Input}],marginTop:[{type:e.Input}],marginRight:[{type:e.Input}],marginBottom:[{type:e.Input}],marginLeft:[{type:e.Input}],color:[{type:e.Input}],textColor:[{type:e.Input}],textSizeRange:[{type:e.Input}],dotSize:[{type:e.Input}],bubbleSizeRange:[{type:e.Input}],bubbleLabelFormatType:[{type:e.Input}],bubbleLabelFormatString:[{type:e.Input}],hideTooltip:[{type:e.Input}],hideTooltipValue:[{type:e.Input}],tooltipValueFormatType:[{type:e.Input}],tooltipValueFormatString:[{type:e.Input}],hovered:[{type:e.Output}],clicked:[{type:e.Output}]},t}();var y=function(){function t(t,i,s){var r=this;this._dataviz=t,this._element=i,this._scroll=s,this.chartClass=!0,this.heatmapClass=!0,this.width=306,this.height=400,this.marginTop=0,this.marginRight=0,this.marginBottom=30,this.marginLeft=55,this.scale="quantile",this.xAxisFormatType=null,this.xAxisFormatString="",this.yAxisFormatType=null,this.yAxisFormatString="",this.hideLegend=!1,this.legendWidth=133,this.legendPosition="right",this.legendLabelFormatType=null,this.legendLabelFormatString="",this.tooltipXLabelFormatType=null,this.tooltipXLabelFormatString="",this.tooltipYLabelFormatType=null,this.tooltipYLabelFormatString="",this.tooltipValueFormatType=null,this.tooltipValueFormatString="",this.theme="classic",this.hovered=new e.EventEmitter,this.clicked=new e.EventEmitter,this.updateChart=function(){r.svg.selectAll("rect").data(r.data).join(function(t){return t.append("rect").attr("class","block").classed("empty",function(t){return void 0===t.value||null===t.value}).attr("x",function(t){return r.xAxisScale(t.xLabel)}).attr("y",function(t){return r.yAxisScale(t.yLabel)}).attr("width",r.xAxisScale.bandwidth()).attr("height",r.yAxisScale.bandwidth()).style("fill",function(t){return r.colorRange(t.value)})},function(t){return t.call(function(t){return t.classed("empty",function(t){return void 0===t.value||null===t.value}).transition().duration(1e3).attr("x",function(t){return r.xAxisScale(t.xLabel)}).attr("y",function(t){return r.yAxisScale(t.yLabel)}).attr("width",r.xAxisScale.bandwidth()).attr("height",r.yAxisScale.bandwidth()).style("fill",function(t){return r.colorRange(t.value)}),t})},function(t){return t.remove()}).on("mouseover",function(t,e,i){return r.blockMouseOver(a.event,t,e,i)}).on("mouseout",function(t,e,i){return r.blockMouseOut()}).on("click",function(t,e,i){return r.blockMouseClick(a.event,t,e,i)}),r.hideLegend||r.chart.select(".legend").selectAll(".legend-item").data(r.colorDomain).join(function(t){var e=t.append("li").attr("class","legend-item");return e.append("span").attr("class","legend-key").style("background-color",function(t){return r.colorRange(t)}),e.append("span").attr("class","legend-label").html(function(t){var e=t;switch(r.legendLabelFormatType){case"number":e=r.legendLabelFormat(t)}return"&ge; "+e}),e},function(t){return t.select(".legend-label").html(function(t){var e=t;switch(r.legendLabelFormatType){case"number":e=r.legendLabelFormat(t)}return"&ge; "+e})},function(t){return t.remove()}).on("mouseover",function(t,e,i){return r.legendMouseOver(a.event,t,e,i)}).on("mouseout",function(){return r.legendMouseOut()}).on("click",function(t,e,i){return r.legendMouseClick(a.event,t,e,i)})},this.blockMouseOver=function(t,e,i,a){null!==e.value&&r.tooltipShow(e,i,a[i]),r.hovered.emit({event:t,data:e})},this.blockMouseOut=function(){r.tooltipHide()},this.blockMouseClick=function(t,e,i,a){r.clicked.emit({event:t,data:e})},this.legendMouseOver=function(t,e,i,s){r.chart.selectAll(".legend-item").filter(function(t,e){return e!==i}).classed("inactive",!0),r.chart.selectAll(".block").filter(function(t,r){return i+1===s.length?t.value<e:t.value<e||t.value>=+a.select(s[i+1]).data()[0]}).classed("inactive",!0),r.hovered.emit({event:t,data:e})},this.legendMouseOut=function(){r.chart.selectAll(".legend-item").classed("inactive",!1),r.chart.selectAll(".block").classed("inactive",!1)},this.legendMouseClick=function(t,e,i,a){r.clicked.emit({event:t,data:e})},this.tooltipShow=function(t,e,i){var s,n,o=i.getBoundingClientRect(),l=r._scroll.getScrollPosition();switch(r.tooltipYLabelFormatType){case"number":s=r.tooltipYLabelFormat(t.yLabel);break;case"time":var h=a.isoParse(t.yLabel);s=r.tooltipYLabelFormat(h);break;default:s=""+t.yLabel+r.tooltipYLabelFormatString}switch(r.tooltipXLabelFormatType){case"number":n=r.tooltipXLabelFormat(t.xLabel);break;case"time":h=a.isoParse(t.xLabel);n=r.tooltipXLabelFormat(h);break;default:n=""+t.xLabel+r.tooltipXLabelFormatString}var c=null===r.tooltipValueFormat?'<div class="tooltip-value">'+t.value+"</div>":'<div class="tooltip-value">'+r.tooltipValueFormat(t.value)+"</div>";r.tooltip.html("\n        "+s+" : "+n+"<br>\n        "+c+"\n      ");var d=+r.tooltip.node().offsetWidth/2,u=+r.tooltip.node().offsetHeight+8;r.tooltip.style("top",+l[1]+ +o.top-u+"px"),r.tooltip.style("left",+l[0]+ +o.left-d+ +o.width/2+"px"),r.tooltip.style("opacity",1),r.tooltip.style("opacity",1)},this.tooltipHide=function(){r.tooltip.style("opacity",0)},this.xAxisFormatter=function(t){switch(r.xAxisFormatType){case"number":return r.xAxisFormat(t);case"time":var e=a.isoParse(t);return r.xAxisFormat(e);default:return t}},this.yAxisFormatter=function(t){switch(r.yAxisFormatType){case"number":return r.yAxisFormat(t);case"time":var e=a.isoParse(t);return r.yAxisFormat(e);default:return t}}}return t.prototype.ngOnInit=function(){switch(this.margin={top:+this.marginTop,right:+this.marginRight,bottom:+this.marginBottom,left:+this.marginLeft},this.yAxisFormatType){case"number":this.yAxisFormat=a.format(this.yAxisFormatString);break;case"time":this.yAxisFormat=a.timeFormat(this.yAxisFormatString);break;default:this.yAxisFormat=null}switch(this.xAxisFormatType){case"number":this.xAxisFormat=a.format(this.xAxisFormatString);break;case"time":this.xAxisFormat=a.timeFormat(this.xAxisFormatString);break;default:this.xAxisFormat=null}switch(this.legendLabelFormatType){case"number":this.legendLabelFormat=a.format(this.legendLabelFormatString);break;default:this.legendLabelFormat=null}switch(this.tooltipYLabelFormatType){case"number":this.tooltipYLabelFormat=a.format(this.tooltipYLabelFormatString);break;case"time":this.tooltipYLabelFormat=a.timeFormat(this.tooltipYLabelFormatString);break;default:this.tooltipYLabelFormat=null}switch(this.tooltipXLabelFormatType){case"number":this.tooltipXLabelFormat=a.format(this.tooltipXLabelFormatString);break;case"time":this.tooltipXLabelFormat=a.timeFormat(this.tooltipXLabelFormatString);break;default:this.tooltipXLabelFormat=null}switch(this.tooltipValueFormatType){case"number":this.tooltipValueFormat=a.format(this.tooltipValueFormatString);break;default:this.tooltipValueFormat=null}this.hideXAxis=!1,this.hideXAxisZero=!1,this.hideXAxisDomain=!0,this.hideYAxisDomain=!0,this.hideTooltip=!1,this.hideXAxisTicks=!0,this.hideYAxisTicks=!0,this.xAxisTickSize=8,this.xAxisTickSizeOuter=0,this.yAxisTickSize=8,this.yAxisTickSizeOuter=0,this.chart=a.select(this._element.nativeElement).attr("aria-hidden","true"),this.svg=this.chart.append("svg").attr("width",+this.width).attr("height",+this.height+this.margin.top+this.margin.bottom).attr("class","img-fluid").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","-"+this.margin.left+" -"+this.margin.top+" "+ +this.width+" "+(+this.height+this.margin.top+this.margin.bottom));var t=this._dataviz.getColors(!0,this.theme).slice().reverse(),e=[+a.min(this.data,function(t){return t.value}),+a.max(this.data,function(t){return t.value})],i=this.data.map(function(t){return t.value});switch(this.scale){case"threshold":this.colorRange=a.scaleThreshold().domain(this.domain).range(t),this.colorDomain=this.colorRange.domain();break;case"quantile":this.colorRange=a.scaleQuantile().domain(i).range(t),this.colorDomain=this.colorRange.quantiles();break;case"quantize":this.colorRange=a.scaleQuantize().domain(e).range(t),this.colorDomain=this.colorRange.thresholds()}var s=o(new Set(this.data.map(function(t){return t.xLabel}))),r=o(new Set(this.data.map(function(t){return t.yLabel}))).reverse();this.xAxisScale=a.scaleBand().domain(s).rangeRound([0,this.width-this.margin.left]).paddingInner(.1),this.xAxisCall=a.axisBottom(this.xAxisScale).tickSize(this.xAxisTickSize).tickSizeOuter(this.xAxisTickSizeOuter).tickFormat(this.xAxisFormatter),this.xAxis=this.svg.append("g").attr("class","axis axis-x").attr("transform","translate(0, "+this.height+")").classed("axis-hidden",this.hideXAxis).classed("axis-zero-hidden",this.hideXAxisZero).classed("axis-domain-hidden",this.hideXAxisDomain).classed("axis-ticks-hidden",this.hideXAxisTicks).call(this.xAxisCall),this.yAxisScale=a.scaleBand().domain(r).rangeRound([this.height,0]).paddingInner(.1),this.yAxisCall=a.axisLeft(this.yAxisScale).tickSize(this.yAxisTickSize).tickSizeOuter(this.yAxisTickSizeOuter).tickFormat(this.yAxisFormatter),this.yAxis=this.svg.append("g").attr("class","axis axis-y").classed("axis-hidden",this.hideYAxis).classed("axis-zero-hidden",this.hideYAxisZero).classed("axis-domain-hidden",this.hideYAxisDomain).classed("axis-ticks-hidden",this.hideYAxisTicks).call(this.yAxisCall),this.hideTooltip||(this.tooltip=a.select("body").append("div").attr("class","pbds-tooltip south").style("opacity",0).attr("aria-hidden","true")),this.hideLegend||(this.chart.classed("pbds-chart-legend-bottom","bottom"===this.legendPosition),this.chart.append("ul").attr("class","legend legend-"+this.legendPosition)),this.updateChart()},t.prototype.ngOnChanges=function(t){t.data&&!t.data.firstChange&&this.updateChart()},t.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-heatmap",template:"",changeDetection:e.ChangeDetectionStrategy.OnPush}]}],t.ctorParameters=function(){return[{type:l},{type:e.ElementRef},{type:i.ViewportScroller}]},t.propDecorators={chartClass:[{type:e.HostBinding,args:["class.pbds-chart"]}],heatmapClass:[{type:e.HostBinding,args:["class.pbds-chart-heatmap"]}],data:[{type:e.Input}],width:[{type:e.Input}],height:[{type:e.Input}],marginTop:[{type:e.Input}],marginRight:[{type:e.Input}],marginBottom:[{type:e.Input}],marginLeft:[{type:e.Input}],scale:[{type:e.Input}],domain:[{type:e.Input}],xAxisFormatType:[{type:e.Input}],xAxisFormatString:[{type:e.Input}],yAxisFormatType:[{type:e.Input}],yAxisFormatString:[{type:e.Input}],hideLegend:[{type:e.Input}],legendWidth:[{type:e.Input}],legendPosition:[{type:e.Input}],legendLabelFormatType:[{type:e.Input}],legendLabelFormatString:[{type:e.Input}],tooltipXLabelFormatType:[{type:e.Input}],tooltipXLabelFormatString:[{type:e.Input}],tooltipYLabelFormatType:[{type:e.Input}],tooltipYLabelFormatString:[{type:e.Input}],tooltipValueFormatType:[{type:e.Input}],tooltipValueFormatString:[{type:e.Input}],theme:[{type:e.Input}],hovered:[{type:e.Output}],clicked:[{type:e.Output}]},t}();var b=function(){function t(t,i,s){var r=this;this._dataviz=t,this._element=i,this._scroll=s,this.chartClass=!0,this.choroplethMapClass=!0,this.feature="",this.dataField="id",this.mesh=null,this.scale=null,this.center=null,this.width=960,this.height=500,this.marginTop=0,this.marginRight=0,this.marginBottom=0,this.marginLeft=0,this.theme="classic",this.colorScale="quantile",this.hideTooltip=!1,this.tooltipValueFormatType=null,this.tooltipValueFormatString="",this.hideLegend=!1,this.legendWidth=260,this.legendLabel=null,this.legendValueFormatType=null,this.legendValueFormatString="",this.legendLeft=20,this.legendTop=20,this.hovered=new e.EventEmitter,this.clicked=new e.EventEmitter,this.updateChart=function(){r.svg.select(".map").selectAll("path").style("fill",function(t,e){var i=r.data.find(function(e){return e[r.dataField]===t[r.dataField]});if(i)return r.colorRange(i.value)}).classed("hasData",function(t,e){return r.data.some(function(e){return e[r.dataField]===t[r.dataField]})}),r.hideTooltip||r.svg.select(".map").selectAll("path").on("mouseover",function(t,e,i){return r.featureMouseOver(a.event,r.data.find(function(e){return e[r.dataField]===t[r.dataField]}),e,i)}).on("mouseout",function(t,e,i){return r.featureMouseOut(a.event,r.data,e,i)}).on("mousemove",function(t,e,i){return r.tooltipMove(r.chart.node())}).on("click",function(t,e,i){return r.featureMouseClick(a.event,r.data.find(function(e){return e[r.dataField]===t[r.dataField]}),e,i)})},this.featureMouseOver=function(t,e,i,a){e&&(r.tooltipShow(e,a[i]),r.hovered.emit({event:t,data:e}))},this.featureMouseOut=function(t,e,i,a){r.tooltipHide()},this.featureMouseClick=function(t,e,i,a){e&&r.clicked.emit({event:t,data:e})},this.tooltipShow=function(t,e){r.tooltipSetPosition(e),t.label&&r.tooltip.select(".tooltip-header").html(function(e){return""+t.label}),r.tooltip.select(".tooltip-value").html(function(e){return r.tooltipValueFormat?""+r.tooltipValueFormat(t.value):""+t.value}),r.tooltip.style("opacity",1)},this.tooltipHide=function(){r.tooltip.style("opacity",0)},this.tooltipMove=function(t){r.tooltipSetPosition(t)},this.tooltipSetPosition=function(t){var e=a.mouse(t),i=+e[0],s=+e[1],n=t.getBoundingClientRect(),o=+n.left,l=+n.top,h=+r._scroll.getScrollPosition()[1],c=+r.tooltip.node().offsetWidth/2,d=+r.tooltip.node().offsetHeight;r.tooltip.style("top",h+s+l-d-14+"px"),r.tooltip.style("left",i+o-c+"px")},this.legend=function(t){var e=r.colorRange.range().length,i=a.scaleLinear().domain([1,e-1]).rangeRound([+r.legendWidth/e,r.legendWidth*(e-1)/e]);t.attr("class","legend").selectAll("rect").data(r.colorRange.range()).join("rect").attr("height",8).attr("x",function(t,e){return i(e)}).attr("width",function(t,e){return i(e+1)-i(e)}).attr("fill",function(t){return t}),r.legendLabel&&t.append("text").attr("y",-6).attr("text-anchor","start").attr("class","legend-label").text(r.legendLabel),t.call(a.axisBottom(i).tickSize(13).tickValues(a.range(1,e)).tickFormat(function(t){return r.legendValueFormat?""+r.legendValueFormat(r.colorDomain[t-1]):""+r.colorDomain[t-1]})).select(".domain").remove()}}return t.prototype.ngOnInit=function(){this.margin={top:+this.marginTop,right:+this.marginRight,bottom:+this.marginBottom,left:+this.marginLeft};var t=this._dataviz.getColors(!0,this.theme).slice().reverse(),e=[+a.min(this.data,function(t){return t.value}),+a.max(this.data,function(t){return t.value})],i=this.data.map(function(t){return t.value});switch(this.colorScale){case"threshold":this.colorRange=a.scaleThreshold().domain(this.domain).range(t),this.colorDomain=this.colorRange.domain();break;case"quantile":this.colorRange=a.scaleQuantile().domain(i).range(t),this.colorDomain=this.colorRange.quantiles();break;case"quantize":this.colorRange=a.scaleQuantize().domain(e).range(t),this.colorDomain=this.colorRange.thresholds()}switch(this.tooltipValueFormatType){case"number":this.tooltipValueFormat=a.format(this.tooltipValueFormatString);break;default:this.tooltipValueFormat=null}switch(this.legendValueFormatType){case"number":this.legendValueFormat=a.format(this.legendValueFormatString);break;default:this.tooltipValueFormat=null}switch(this.projectionType){case"geoAlbers":this.projection=a.geoAlbers();break;case"geoAlbersUsa":this.projection=a.geoAlbersUsa();break;case"geoMercator":this.projection=a.geoMercator()}this.topojsonFeature=s.feature(this.topojson,this.topojson.objects[this.feature]),this.projection.fitSize([+this.width,+this.height],this.topojsonFeature),this.scale&&this.projection.scale(+this.scale),this.center&&this.projection.center(this.center),this.geoPath=a.geoPath().projection(this.projection),this.chart=a.select(this._element.nativeElement).attr("aria-hidden","true"),this.hideTooltip||(this.tooltip=a.select("body").append("div").attr("class","pbds-tooltip south").style("opacity",0).attr("aria-hidden","true"),this.tooltip.append("div").attr("class","tooltip-header"),this.tooltip.append("div").attr("class","tooltip-value")),this.svg=this.chart.append("svg").attr("width",+this.width).attr("height",+this.height+this.margin.top+this.margin.bottom).attr("class","img-fluid").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","-"+this.margin.left+" -"+this.margin.top+" "+ +this.width+" "+(+this.height+this.margin.top+this.margin.bottom)),this.svg.append("g").attr("class","map").selectAll("path").data(this.topojsonFeature.features).enter().append("path").attr("class","feature").attr("d",this.geoPath),this.svg.append("path").attr("class","mesh").datum(s.mesh(this.topojson,this.topojson.objects[this.mesh||this.feature],function(t,e){return t!==e})).attr("d",this.geoPath),this.hideLegend||this.svg.append("g").attr("transform","translate("+ +this.legendLeft+", "+ +this.legendTop+")").call(this.legend),this.updateChart()},t.prototype.ngOnChanges=function(t){t.data&&!t.data.firstChange&&this.updateChart()},t.prototype.ngOnDestroy=function(){this.tooltip&&this.tooltip.remove()},t.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-choropleth-map",template:"",changeDetection:e.ChangeDetectionStrategy.OnPush}]}],t.ctorParameters=function(){return[{type:l},{type:e.ElementRef},{type:i.ViewportScroller}]},t.propDecorators={chartClass:[{type:e.HostBinding,args:["class.pbds-chart"]}],choroplethMapClass:[{type:e.HostBinding,args:["class.pbds-chart-choropleth-map"]}],data:[{type:e.Input}],topojson:[{type:e.Input}],feature:[{type:e.Input}],projectionType:[{type:e.Input}],dataField:[{type:e.Input}],mesh:[{type:e.Input}],scale:[{type:e.Input}],center:[{type:e.Input}],width:[{type:e.Input}],height:[{type:e.Input}],marginTop:[{type:e.Input}],marginRight:[{type:e.Input}],marginBottom:[{type:e.Input}],marginLeft:[{type:e.Input}],theme:[{type:e.Input}],colorScale:[{type:e.Input}],domain:[{type:e.Input}],hideTooltip:[{type:e.Input}],tooltipValueFormatType:[{type:e.Input}],tooltipValueFormatString:[{type:e.Input}],hideLegend:[{type:e.Input}],legendWidth:[{type:e.Input}],legendLabel:[{type:e.Input}],legendValueFormatType:[{type:e.Input}],legendValueFormatString:[{type:e.Input}],legendLeft:[{type:e.Input}],legendTop:[{type:e.Input}],hovered:[{type:e.Output}],clicked:[{type:e.Output}]},t}();var v=function(){function t(t,i,s,r){var n=this;this._dataviz=t,this._element=i,this._scroll=s,this._location=r,this.chartClass=!0,this.groupedBarClass=!0,this.width=306,this.height=400,this.vertical=!0,this.hideXAxis=!1,this.xAxisMaxBuffer=.01,this.xAxisFormatType=null,this.xAxisFormatString="",this.xAxisTicks=5,this.hideYAxis=!1,this.yAxisMaxBuffer=.01,this.yAxisFormatType=null,this.yAxisFormatString="",this.yAxisTicks=5,this.marginTop=10,this.marginRight=this.vertical?0:55,this.marginBottom=30,this.marginLeft=55,this.hideLegend=!1,this.legendWidth=133,this.legendPosition="right",this.legendLabelFormatType=null,this.legendLabelFormatString="",this.hideTooltip=!1,this.tooltipLabelFormatType=null,this.tooltipLabelFormatString="",this.tooltipValueFormatType=null,this.tooltipValueFormatString="",this.showGrid=!1,this.theme="classic",this.hovered=new e.EventEmitter,this.clicked=new e.EventEmitter,this.barMouseOver=function(t,e,i,s){var r=a.select(s[i]);n.chart.selectAll(".bar-group").selectAll(".bar").classed("inactive",!0),r.classed("inactive",!1).style("fill",r.attr("data-color")),n.tooltipShow(e,s[i]),n.hovered.emit({event:t,data:e})},this.barMouseOut=function(){n.chart.selectAll(".bar").classed("inactive",!1).style("fill",null),n.tooltipHide()},this.barMouseClick=function(t,e,i,a){n.clicked.emit({event:t,data:e})},this.legendMouseOver=function(t,e,i,a){n.chart.selectAll(".legend-item").filter(function(t,e){return e!==i}).classed("inactive",!0),n.chart.selectAll(".bar-group").selectAll(".bar").filter(function(t,e){return e!==i}).classed("inactive",!0);var s=n.chart.selectAll(".bar-group").selectAll(".bar").filter(function(t,e){return e===i}).classed("inactive",null),r=s.attr("data-color");s.style("fill",function(){return r}),n.hovered.emit({event:t,data:e})},this.legendMouseOut=function(){n.chart.selectAll(".legend-item").classed("inactive",!1),n.chart.selectAll(".bar-group").selectAll(".bar").classed("inactive",!1).style("fill",null)},this.legendMouseClick=function(t,e,i,a){n.clicked.emit({event:t,data:e})},this.tooltipShow=function(t,e){var i,s=e.getBoundingClientRect(),r=n._scroll.getScrollPosition();switch(n.tooltipLabelFormatType){case"number":i=n.tooltipLabelFormat(t.label);break;case"time":var o=a.isoParse(t.label);i=n.tooltipLabelFormat(o);break;default:i=t.label}var l=null===n.tooltipValueFormat?'<div class="tooltip-value">'+t.value+"</div>":'<div class="tooltip-value">'+n.tooltipValueFormat(t.value)+"</div>";n.tooltip.html("\n        "+i+"\n        "+l+"\n      ");var h=+n.tooltip.node().offsetWidth/2,c=+n.tooltip.node().offsetHeight;n.vertical?(n.tooltip.style("top",+r[1]+ +s.top-c-8+"px"),n.tooltip.style("left",+r[0]+ +s.left-h+ +s.width/2+"px")):(n.tooltip.style("top",+r[1]+ +s.top+ +s.height/2-c/2+"px"),n.tooltip.style("left",+r[0]+ +s.right+8+"px")),n.tooltip.style("opacity",1)},this.tooltipHide=function(){n.tooltip.style("opacity",0)},this.xAxisFormatter=function(t){switch(n.xAxisFormatType){case"number":return n.xAxisFormat(t);case"time":var e=a.isoParse(t);return n.xAxisFormat(e);default:return t}},this.yAxisFormatter=function(t){switch(n.yAxisFormatType){case"number":return n.yAxisFormat(t);case"time":var e=a.isoParse(t);return n.yAxisFormat(e);default:return t}}}return t.prototype.ngOnInit=function(){var t=this;switch(this.margin={top:+this.marginTop,right:+this.marginRight,bottom:+this.marginBottom,left:+this.marginLeft},this.xAxisFormatType){case"number":this.xAxisFormat=a.format(this.xAxisFormatString);break;case"time":this.xAxisFormat=a.timeFormat(this.xAxisFormatString)}switch(this.yAxisFormatType){case"number":this.yAxisFormat=a.format(this.yAxisFormatString);break;case"time":this.yAxisFormat=a.timeFormat(this.yAxisFormatString)}switch(this.legendLabelFormatType){case"number":this.legendLabelFormat=a.format(this.legendLabelFormatString);break;case"time":this.legendLabelFormat=a.timeFormat(this.legendLabelFormatString);break;default:this.legendLabelFormat=null}switch(this.tooltipLabelFormatType){case"time":this.tooltipLabelFormat=a.timeFormat(this.tooltipLabelFormatString);break;default:this.tooltipLabelFormat=null}switch(this.tooltipValueFormatType){case"number":this.tooltipValueFormat=a.format(this.tooltipValueFormatString);break;default:this.tooltipValueFormat=null}this.hideGrayBars=!1,this.hideXAxisZero=!1,this.hideXAxisDomain=!1,this.hideXAxisTicks=!0,this.xAxisTickSize=8,this.xAxisTickSizeOuter=0,this.hideYAxisZero=!1,this.hideYAxisDomain=!1,this.hideYAxisTicks=!0,this.yAxisTickSize=8,this.yAxisTickSizeOuter=0,this.hideLegend||"right"!==this.legendPosition||(this.width=+this.width-+this.legendWidth),this.chart=a.select(this._element.nativeElement).attr("aria-hidden","true"),this.svg=this.chart.append("svg").attr("width",function(){return t.vertical?+t.width:+t.width+t.margin.left+t.margin.right}).attr("height",+this.height+this.margin.top+this.margin.bottom).attr("class","img-fluid").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox",function(){return t.vertical?"-"+t.margin.left+" -"+t.margin.top+" "+ +t.width+" "+(+t.height+t.margin.top+t.margin.bottom):"-"+t.margin.left+" -"+t.margin.top+" "+(+t.width+t.margin.left+t.margin.right)+" "+(+t.height+t.margin.top+t.margin.bottom)}),this.hideTooltip||(this.tooltip=a.select("body").append("div").attr("class",function(){return t.vertical?"pbds-tooltip south":"pbds-tooltip west"}).style("opacity",0).attr("aria-hidden","true")),this.hideLegend||(this.chart.classed("pbds-chart-legend-bottom","bottom"===this.legendPosition),this.chart.append("ul").attr("class","legend legend-"+this.legendPosition)),this.colorRange=a.scaleOrdinal().range(this._dataviz.createGradientDefs(this.svg,!1,this.theme,this.vertical)),this.vertical?(this.xAxisScale=a.scaleBand().domain(this.data.map(function(t){return t.key})).rangeRound([0,this.width-this.margin.left]).align(0),this.hideGrayBars?this.xAxisScale.paddingInner(0).paddingOuter(0):this.xAxisScale.paddingInner(.1).paddingOuter(0),this.xAxisCall=a.axisBottom(this.xAxisScale).tickSize(this.xAxisTickSize).tickSizeOuter(this.xAxisTickSizeOuter).tickFormat(this.xAxisFormatter),this.xAxis=this.svg.append("g").attr("class","axis axis-x").attr("transform","translate(0, "+this.height+")").classed("axis-hidden",this.hideXAxis).classed("axis-zero-hidden",this.hideXAxisZero).classed("axis-domain-hidden",this.hideXAxisDomain).classed("axis-ticks-hidden",this.hideXAxisTicks).call(this.xAxisCall),this.yAxisMax=a.max(this.data,function(t){var e=r({},t);return delete e.key,a.max(a.values(e))}),this.yAxisMax=this.yAxisMax+this.yAxisMax*this.yAxisMaxBuffer,this.yAxisScale=a.scaleLinear().domain([0,this.yAxisMax]).nice().rangeRound([this.height,0]),this.yAxisCall=a.axisLeft(this.yAxisScale).ticks(this.yAxisTicks).tickSize(this.yAxisTickSize).tickSizeOuter(this.yAxisTickSizeOuter).tickFormat(this.yAxisFormatter),this.yAxis=this.svg.append("g").attr("class","axis axis-y").classed("axis-hidden",this.hideYAxis).classed("axis-zero-hidden",this.hideYAxisZero).classed("axis-domain-hidden",this.hideYAxisDomain).classed("axis-ticks-hidden",this.hideYAxisTicks).call(this.yAxisCall),this.showGrid&&(this.yGridCall=a.axisLeft(this.yAxisScale).ticks(this.yAxisTicks).tickSize(-this.width+this.margin.left+this.margin.right),this.yGrid=this.svg.append("g").attr("class","grid grid-y").classed("grid-zero-hidden",this.hideYAxisZero).attr("transform","translate(0, 0)").call(this.yGridCall)),this.barScale=a.scaleBand().domain(Object.keys(this.data[0]).slice(1)).rangeRound([0,this.xAxisScale.bandwidth()]).paddingInner(.1).paddingOuter(.5),this.updateChartVertical()):(this.xAxisMax=a.max(this.data,function(t){var e=r({},t);return delete e.key,a.max(a.values(e))}),this.xAxisMax=this.xAxisMax+this.xAxisMax*this.xAxisMaxBuffer,this.xAxisScale=a.scaleLinear().domain([0,this.xAxisMax]).rangeRound([0,this.width]).nice(),this.xAxisCall=a.axisBottom(this.xAxisScale).ticks(this.xAxisTicks).tickSize(this.xAxisTickSize).tickSizeOuter(this.xAxisTickSizeOuter).tickFormat(this.xAxisFormatter),this.xAxis=this.svg.append("g").attr("class","axis axis-x").attr("transform","translate(0, "+this.height+")").classed("axis-hidden",this.hideXAxis).classed("axis-zero-hidden",this.hideXAxisZero).classed("axis-domain-hidden",this.hideXAxisDomain).classed("axis-ticks-hidden",this.hideXAxisTicks).call(this.xAxisCall),this.yAxisScale=a.scaleBand().domain(this.data.map(function(t){return t.key})).rangeRound([0,this.height]).align(1),this.hideGrayBars?this.yAxisScale.paddingInner(0).paddingOuter(0):this.yAxisScale.paddingInner(.1).paddingOuter(0),this.yAxisCall=a.axisLeft(this.yAxisScale).tickSize(this.yAxisTickSize).tickSizeOuter(this.yAxisTickSizeOuter).tickFormat(this.yAxisFormatter),this.yAxis=this.svg.append("g").attr("class","axis axis-y").classed("axis-hidden",this.hideYAxis).classed("axis-zero-hidden",this.hideYAxisZero).classed("axis-domain-hidden",this.hideYAxisDomain).classed("axis-ticks-hidden",this.hideYAxisTicks).call(this.yAxisCall),this.showGrid&&(this.xGridCall=a.axisBottom(this.xAxisScale).tickSize(-this.height),this.xGrid=this.svg.append("g").attr("class","grid grid-x").classed("grid-zero-hidden",this.hideXAxisZero).attr("transform","translate(0, "+this.height+")").call(this.xGridCall)),this.barScale=a.scaleBand().domain(Object.keys(this.data[0]).slice(1)).rangeRound([this.yAxisScale.bandwidth(),0]).paddingInner(.1).paddingOuter(.5),this.updateChartHorizontal())},t.prototype.ngOnDestroy=function(){this.tooltip&&this.tooltip.remove()},t.prototype.ngOnChanges=function(t){t.data&&!t.data.firstChange&&(this.vertical?this.updateChartVertical():this.updateChartHorizontal())},t.prototype.updateChartVertical=function(){var t=this;this.xAxisScale.domain(this.data.map(function(t){return t.key})),this.yAxisMax=a.max(this.data,function(t){var e=r({},t);return delete e.key,a.max(a.values(e))}),this.yAxisMax=this.yAxisMax+this.yAxisMax*this.yAxisMaxBuffer,this.yAxisScale.domain([0,this.yAxisMax]).rangeRound([this.height,0]).nice(),this.xAxis.transition().duration(1e3).call(this.xAxisCall),this.yAxis.transition().duration(1e3).call(this.yAxisCall),this.showGrid&&this.yGrid.transition().duration(1e3).call(this.yGridCall),this.barScale.domain(Object.keys(this.data[0]).slice(1)).rangeRound([0,this.xAxisScale.bandwidth()]),this.svg.selectAll(".gray-bar").data(this.data).join(function(e){return e.append("rect").attr("class","gray-bar").attr("x",function(e){return t.xAxisScale(e.key)}).attr("y",function(e){return t.yAxisScale(e.value)}).attr("width",t.xAxisScale.bandwidth()).attr("height",t.height)},function(e){return e.transition().duration(1e3).attr("x",function(e){return t.xAxisScale(e.key)}).attr("y",function(e){return t.yAxisScale(e.value)}).attr("width",t.xAxisScale.bandwidth()).attr("height",t.height)}),this.svg.selectAll(".bar-group").data(this.data).join(function(e){return e.append("g").attr("class","bar-group").attr("transform",function(e,i){return"translate("+t.xAxisScale(e.key)+", 0)"})},function(e){return e.transition().duration(1e3).attr("transform",function(e,i){return"translate("+t.xAxisScale(e.key)+", 0)"})}),this.svg.selectAll(".bar-group").selectAll(".bar").data(function(t,e){var i=r({},t);return delete i.key,Object.keys(i).map(function(i){return{label:i,value:t[i],parentIndex:e}})}).join(function(e){return e.append("rect").attr("class","bar").attr("fill",function(e){return"url("+t._location.path()+"#gradient-"+t.colorRange(e.label).substr(1)+")"}).attr("data-color",function(e){return t.colorRange(e.label)}).attr("data-parent-index",function(t){return t.parentIndex}).attr("x",function(e){return t.barScale(e.label)}).attr("width",t.barScale.bandwidth()).attr("y",t.height).attr("height",0).call(function(e){return e.transition().duration(500).attr("height",function(e){return t.height-t.yAxisScale(e.value)}).attr("y",function(e){return t.yAxisScale(e.value)})})},function(e){return e.transition().duration(1e3).attr("x",function(e){return t.barScale(e.label)}).attr("width",t.barScale.bandwidth()).attr("height",function(e){return t.height-t.yAxisScale(e.value)}).attr("y",function(e){return t.yAxisScale(e.value)})},function(e){return e.transition().duration(100).attr("height",0).attr("y",t.height)}).on("mouseover",function(e,i,s){return t.barMouseOver(a.event,e,i,s)}).on("mouseout",function(e,i,a){return t.barMouseOut()}).on("click",function(e,i,s){return t.barMouseClick(a.event,e,i,s)}),this.updateLegend(),this.svg.selectAll(".axis").raise()},t.prototype.updateChartHorizontal=function(){var t=this;this.xAxisMax=a.max(this.data,function(t){var e=r({},t);return delete e.key,a.max(a.values(e))}),this.xAxisMax=this.xAxisMax+this.xAxisMax*this.xAxisMaxBuffer,this.xAxisScale.domain([0,this.xAxisMax]).rangeRound([0,this.width]).nice(),this.yAxisScale.domain(this.data.map(function(t){return t.key})),this.xAxis.transition().duration(1e3).call(this.xAxisCall),this.yAxis.transition().duration(1e3).call(this.yAxisCall),this.showGrid&&this.xGrid.transition().duration(1e3).call(this.xGridCall),this.barScale.domain(Object.keys(this.data[0]).slice(1)).rangeRound([0,this.yAxisScale.bandwidth()]),this.svg.selectAll(".gray-bar").data(this.data).join(function(e){return e.append("rect").attr("class","gray-bar").attr("y",function(e){return t.yAxisScale(e.key)}).attr("width",t.width).attr("height",t.yAxisScale.bandwidth())},function(e){return e.transition().duration(1e3).attr("y",function(e){return t.yAxisScale(e.key)}).attr("width",t.width).attr("height",t.yAxisScale.bandwidth())}),this.svg.selectAll(".bar-group").data(this.data).join(function(e){return e.append("g").attr("class","bar-group").attr("transform",function(e,i){return"translate(0, "+t.yAxisScale(e.key)+")"})},function(e){return e.transition().duration(1e3).attr("transform",function(e,i){return"translate(0, "+t.yAxisScale(e.key)+")"})}),this.svg.selectAll(".bar-group").selectAll(".bar").data(function(t,e){var i=r({},t);return delete i.key,Object.keys(i).map(function(i){return{label:i,value:t[i],parentIndex:e}})}).join(function(e){return e.append("rect").attr("class","bar").attr("fill",function(e){return"url("+t._location.path()+"#gradient-horizontal-"+t.colorRange(e.label).substr(1)+")"}).attr("data-color",function(e){return t.colorRange(e.label)}).attr("data-parent-index",function(t){return t.parentIndex}).attr("x",0).attr("width",0).attr("y",function(e){return t.barScale(e.label)}).attr("height",t.barScale.bandwidth()).call(function(e){return e.transition().duration(500).attr("width",function(e){return t.xAxisScale(e.value)})})},function(e){return e.transition().duration(1e3).attr("width",function(e){return t.xAxisScale(e.value)}).attr("height",t.barScale.bandwidth()).attr("y",function(e){return t.barScale(e.label)})},function(t){return t.transition().duration(100).attr("width",0)}).on("mouseover",function(e,i,s){return t.barMouseOver(a.event,e,i,s)}).on("mouseout",function(e,i,a){return t.barMouseOut()}).on("click",function(e,i,s){return t.barMouseClick(a.event,e,i,s)}),this.updateLegend(),this.svg.selectAll(".axis").raise()},t.prototype.updateLegend=function(){var t=this;if(!this.hideLegend){var e=r({},this.data[0]);delete e.key;var i=Object.keys(e).map(function(t){return{label:t}});this.chart.select(".legend").selectAll(".legend-item").data(i).join(function(e){var i=e.append("li").attr("class","legend-item");return i.insert("span").attr("class","legend-key").style("background-color",function(e){return t.colorRange(e.label)}),i.insert("span",".legend-item").attr("class","legend-label").html(function(e){switch(t.legendLabelFormatType){case"number":return t.legendLabelFormat(e.label);case"time":var i=a.isoParse(e.label);return t.legendLabelFormat(i);default:return e.label}}),i},function(e){return e.select(".legend-label").html(function(e){switch(t.legendLabelFormatType){case"number":return t.legendLabelFormat(e.label);case"time":var i=a.isoParse(e.label);return t.legendLabelFormat(i);default:return e.label}}),e},function(t){return t.remove()}).on("mouseover",function(e,i,s){return t.legendMouseOver(a.event,e,i,s)}).on("mouseout",function(){return t.legendMouseOut()}).on("click",function(e,i,s){return t.legendMouseClick(a.event,e,i,s)})}},t.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-grouped-bar",template:"",changeDetection:e.ChangeDetectionStrategy.OnPush}]}],t.ctorParameters=function(){return[{type:l},{type:e.ElementRef},{type:i.ViewportScroller},{type:i.Location}]},t.propDecorators={chartClass:[{type:e.HostBinding,args:["class.pbds-chart"]}],groupedBarClass:[{type:e.HostBinding,args:["class.pbds-chart-grouped-bar"]}],data:[{type:e.Input}],width:[{type:e.Input}],height:[{type:e.Input}],vertical:[{type:e.Input}],hideXAxis:[{type:e.Input}],xAxisMaxBuffer:[{type:e.Input}],xAxisFormatType:[{type:e.Input}],xAxisFormatString:[{type:e.Input}],xAxisTicks:[{type:e.Input}],hideYAxis:[{type:e.Input}],yAxisMaxBuffer:[{type:e.Input}],yAxisFormatType:[{type:e.Input}],yAxisFormatString:[{type:e.Input}],yAxisTicks:[{type:e.Input}],marginTop:[{type:e.Input}],marginRight:[{type:e.Input}],marginBottom:[{type:e.Input}],marginLeft:[{type:e.Input}],hideLegend:[{type:e.Input}],legendWidth:[{type:e.Input}],legendPosition:[{type:e.Input}],legendLabelFormatType:[{type:e.Input}],legendLabelFormatString:[{type:e.Input}],hideTooltip:[{type:e.Input}],tooltipLabelFormatType:[{type:e.Input}],tooltipLabelFormatString:[{type:e.Input}],tooltipValueFormatType:[{type:e.Input}],tooltipValueFormatString:[{type:e.Input}],showGrid:[{type:e.Input}],theme:[{type:e.Input}],hovered:[{type:e.Output}],clicked:[{type:e.Output}]},t}();var A=function(){function t(t,i,s,r){var n=this;this._dataviz=t,this._element=i,this._scroll=s,this._location=r,this.chartClass=!0,this.singleStackedBarClass=!0,this.width=300,this.height=40,this.nullValueText="No data available",this.percentage=!1,this.marginTop=10,this.marginRight=20,this.marginBottom=35,this.marginLeft=15,this.barMargin=2,this.hideXAxis=!1,this.xAxisTicks=6,this.xAxisTitle=null,this.xAxisFormatType=null,this.xAxisFormatString="",this.xAxisTickLabelSuffix="",this.hideXGrid=!1,this.hideLegend=!1,this.hideLegendTooltip=!0,this.legendWidth=133,this.legendPosition="bottom",this.legendLabelFormatType=null,this.legendLabelFormatString="",this.hideTooltip=!1,this.tooltipLabelFormatType=null,this.tooltipLabelFormatString="",this.tooltipDateFormatString="%b %e, %Y",this.tooltipValueFormatType=null,this.tooltipValueFormatString="",this.tooltipValueSuffix="",this.tooltipPercentFormatString=".2%",this.compareChangeFormatString=".2%",this.monochrome=!1,this.hovered=new e.EventEmitter,this.clicked=new e.EventEmitter,this.isSingleData=!1,this.isCompare=!1,this.barPadding=40,this.barMouseOver=function(t,e,i,s){var r=a.select(s[i]);n.chart.selectAll(".bar").classed("inactive",!0),r.classed("inactive",!1),n.chart.selectAll(".legend-item").filter(function(t,e){return e!==i}).classed("inactive",!0),n.tooltipShow(e,s[i]),n.hovered.emit({event:t,data:e})},this.barMouseOut=function(){n.chart.selectAll(".bar").classed("inactive",!1).style("fill",null),n.chart.selectAll(".legend-item").classed("inactive",!1),n.tooltipHide()},this.barMouseClick=function(t,e,i,a){n.clicked.emit({event:t,data:e})},this.tooltipShow=function(t,e){var i=e.getBoundingClientRect(),s=n._scroll.getScrollPosition(),r=t.value/a.sum(n.data,function(t){return t.value}),o=t.compareValue/a.sum(n.data,function(t){return t.compareValue}),l="",h="",c="",d="",u="",p="",g=""+n.nullValueText,m="";if(!n.isSingleData)switch(n.tooltipLabelFormatType){case"number":l=n.tooltipLabelFormat(t.label);break;case"time":var x=a.isoParse(t.label);l=n.tooltipLabelFormat(x);break;default:l=t.label}n.isCompare&&t.compareStartDate&&t.compareEndDate&&(h="mt-2",c=n.tooltipDateFormat(a.isoParse(t.compareStartDate))+" - "+n.tooltipDateFormat(a.isoParse(t.compareEndDate))),n.percentage&&n.isCompare&&t.compareValue?d=null===n.tooltipValueFormat?n.tooltipPercentFormat(o)+" ("+t.comparveValue+n.tooltipValueSuffix+")":n.tooltipPercentFormat(o)+" ("+n.tooltipValueFormat(t.compareValue)+n.tooltipValueSuffix+")":n.isCompare&&null!==t.compareValue?d=null===n.tooltipValueFormat?""+t.compareValue+n.tooltipValueSuffix+" ("+n.tooltipPercentFormat(o)+")":""+n.tooltipValueFormat(t.compareValue)+n.tooltipValueSuffix+" ("+n.tooltipPercentFormat(o)+")":n.isCompare&&null===t.compareValue&&(d=""+n.nullValueText),t.startDate&&t.endDate&&(p=n.tooltipDateFormat(a.isoParse(t.startDate))+" - "+n.tooltipDateFormat(a.isoParse(t.endDate))),""!==l&&(u="mt-2"),n.isSingleData&&n.percentage&&t.value?g=null===n.tooltipValueFormat?""+t.value:""+n.tooltipValueFormat(t.value):n.isSingleData&&null!==t.value?g=null===n.tooltipValueFormat?""+t.value+n.tooltipValueSuffix:""+n.tooltipValueFormat(t.value)+n.tooltipValueSuffix:!n.isSingleData&&n.percentage&&null!==t.value?g=null===n.tooltipValueFormat?n.tooltipPercentFormat(r)+" ("+t.value+n.tooltipValueSuffix+")":n.tooltipPercentFormat(r)+" ("+n.tooltipValueFormat(t.value)+n.tooltipValueSuffix+")":n.isSingleData||null===t.value||(g=null===n.tooltipValueFormat?""+t.value+n.tooltipValueSuffix+" ("+n.tooltipPercentFormat(r)+")":""+n.tooltipValueFormat(t.value)+n.tooltipValueSuffix+" ("+n.tooltipPercentFormat(r)+")"),!n.isSingleData&&n.isCompare&&null!==t.value&&null!==t.compareValue&&(m='<div class="metric-block-indicator '+t.compareChangeDirection+" "+(t.compareChangeInverse?"inverse":"")+' ml-2"><span>'+n.tooltipCompareChangeFormat(t.compareChangeValue)+"</span></div>"),n.tooltip.html(function(){return'\n        <div class="tooltip-label font-weight-bold">'+l+'</div>\n        <div class="'+h+'">'+c+'</div>\n        <div class="tooltip-value font-weight-bold">'+d+'</div>\n        <div class="'+u+'">'+p+'</div>\n        <div class="tooltip-value"><span class="font-weight-bold">'+g+"</span> <span>"+m+"</span></div>\n      "});var f=+n.tooltip.node().offsetWidth/2,y=+n.tooltip.node().offsetHeight;n.tooltip.style("top",+s[1]+ +i.top-y-8+"px"),n.data.length>1?n.tooltip.style("left",+s[0]+ +i.left-f+ +i.width/2+"px"):n.tooltip.style("left",+s[0]-f+ +i.right+"px"),n.tooltip.style("opacity",1)},this.tooltipHide=function(){n.tooltip.style("opacity",0)},this.legendMouseOver=function(t,e,i,a){if(!n.hideLegendTooltip){var s=n.svg.selectAll(".bar").filter(function(t,e){return e===i}).node();n.tooltipShow(e,s)}n.chart.selectAll(".legend-item").filter(function(t,e){return e!==i}).classed("inactive",!0),n.chart.selectAll(".bar").filter(function(t,e){return e!==i}).classed("inactive",!0),n.chart.selectAll(".bar").filter(function(t,e){return e===i}).classed("inactive",null),n.hovered.emit({event:t,data:e})},this.legendMouseOut=function(){n.chart.selectAll(".legend-item").classed("inactive",!1),n.chart.selectAll(".bar").classed("inactive",!1).style("fill",null),n.tooltipHide()},this.legendMouseClick=function(t,e,i,a){n.clicked.emit({event:t,data:e})},this.xAxisFormatter=function(t){switch(n.xAxisFormatType){case"number":return""+n.xAxisFormat(t)+n.xAxisTickLabelSuffix;default:return""+t+n.xAxisTickLabelSuffix}}}return t.prototype.ngOnInit=function(){var t,e=this;switch(this.height=+this.height+this.barPadding,this.margin={top:+this.marginTop,right:+this.marginRight,bottom:+this.marginBottom,left:+this.marginLeft},this.isSingleData=1===this.data.length,this.isCompare=Object.keys(this.data[0]).includes("compareValue"),this.xAxisFormatType){case"number":this.xAxisFormat=a.format(this.xAxisFormatString)}switch(this.legendLabelFormatType){case"number":this.legendLabelFormat=a.format(this.legendLabelFormatString);break;case"time":this.legendLabelFormat=a.timeFormat(this.legendLabelFormatString);break;default:this.legendLabelFormat=null}switch(this.tooltipValueFormatType){case"number":this.tooltipValueFormat=a.format(this.tooltipValueFormatString);break;default:this.tooltipValueFormat=null}this.tooltipDateFormat=a.timeFormat(this.tooltipDateFormatString),this.tooltipPercentFormat=a.format(this.tooltipPercentFormatString),this.tooltipCompareChangeFormat=a.format(this.compareChangeFormatString),this.hideXAxisZero=!1,this.hideXAxisDomain=!0,this.hideXAxisTicks=!0,this.xAxisTickSize=8,this.xAxisTickSizeOuter=0,this.xAxisTitleMargin=this.xAxisTitle?20:0,this.hideLegend||"right"!==this.legendPosition||(this.width=+this.width-+this.legendWidth),this.chart=a.select(this._element.nativeElement).attr("aria-hidden","true"),this.svg=this.chart.append("svg").attr("width",function(){return+e.width+e.margin.left+e.margin.right}).attr("height",+this.height+this.margin.top+this.margin.bottom+this.xAxisTitleMargin).attr("class","img-fluid").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox",function(){return"-"+e.margin.left+" -"+e.margin.top+" "+(+e.width+e.margin.left+e.margin.right)+" "+(+e.height+e.margin.top+e.margin.bottom+e.xAxisTitleMargin)}),this.hideTooltip||(this.tooltip=a.select("body").append("div").attr("class","pbds-tooltip south").classed("pbds-tooltip-compare",this.isCompare).style("opacity",0).attr("aria-hidden","true")),!this.hideLegend&&this.data.length>1&&(this.chart.classed("pbds-chart-legend-bottom","bottom"===this.legendPosition),this.chart.append("ul").attr("class","legend legend-"+this.legendPosition)),this.xAxisScale=a.scaleLinear().domain([0,Math.ceil(a.sum(this.data,function(t){return t.value}))]).range([0,+this.width]),this.xAxisCall=a.axisBottom(this.xAxisScale).ticks(this.xAxisTicks).tickSize(this.xAxisTickSize).tickSizeOuter(this.xAxisTickSizeOuter).tickFormat(this.xAxisFormatter),this.xAxis=this.svg.append("g").attr("class","axis axis-x").attr("transform","translate(0, "+this.height+")").classed("axis-hidden",this.hideXAxis).classed("axis-zero-hidden",this.hideXAxisZero).classed("axis-domain-hidden",this.hideXAxisDomain).classed("axis-ticks-hidden",this.hideXAxisTicks),this.hideXGrid||(this.xGridCall=a.axisBottom(this.xAxisScale).tickSize(-this.height),this.xGrid=this.svg.append("g").attr("class","grid grid-x").classed("grid-zero-hidden",this.hideXAxisZero).attr("transform","translate(0, "+this.height+")").call(this.xGridCall)),this.xAxisTitle&&this.svg.append("text").attr("class","axis-title").attr("text-anchor","center").attr("x",this.width/2-this.margin.left).attr("y",this.height+this.margin.top+(this.hideXAxis?0:40)).text(this.xAxisTitle),t=this.isSingleData?this._dataviz.createGradientDefs(this.svg,this.monochrome,this.theme,!1):this.monochrome?this._dataviz.getColors(this.monochrome,this.theme).reverse():this._dataviz.getColors(this.monochrome,this.theme),this.colorRange=a.scaleOrdinal().range(t),this.updateChart()},t.prototype.ngOnChanges=function(t){t.data&&!t.data.firstChange&&this.updateChart()},t.prototype.ngOnDestroy=function(){this.tooltip&&this.tooltip.remove()},t.prototype.updateChart=function(){var t=this,e=a.sum(this.data,function(t){return t.value}),i=0===this.data[this.data.length-1].value||null===this.data[this.data.length-1].value,s=0,r=o(this.data),n=!1;r.reverse().forEach(function(t,e,i){0!==t.value&&null!==t.value||n?n=!0:s++}),this.percentage&&!this.isSingleData?(this.xAxisScale.domain([0,e]).range([0,+this.width]),this.xAxisCall.tickValues([0,.25*e,.5*e,.75*e,e]),this.xAxis.call(this.xAxisCall),this.xGridCall.tickValues([0,.25*e,.5*e,.75*e,e]),this.xGrid.call(this.xGridCall),this.svg.select(".axis-x").selectAll("text").html(function(t,e){return a.format(".0%")(.25*e)})):this.percentage&&this.isSingleData?(this.xAxisScale.domain([0,1]).range([0,+this.width]),this.xAxisCall.tickValues([0,.25,.5,.75,1]),this.xAxis.call(this.xAxisCall),this.xGridCall.tickValues([0,.25,.5,.75,1]),this.xGrid.call(this.xGridCall),this.svg.select(".axis-x").selectAll("text").html(function(t,e){return a.format(".0%")(.25*e)})):(this.xAxisScale.domain([0,Math.ceil(e)]).range([0,+this.width]),this.xGridCall.tickValues(this.xAxisScale.ticks().filter(function(t){return Number.isInteger(t)})),this.xAxis.transition().duration(1e3).call(this.xAxisCall),this.hideXGrid||this.xGrid.transition().duration(1e3).call(this.xGridCall)),this.svg.selectAll(".bar").data(this.data).join(function(e){return e.append("rect").attr("class","bar").attr("width",0).attr("height",function(){return t.height-t.barPadding}).attr("fill",function(e){return t.isSingleData?"url("+t._location.path()+"#gradient-horizontal-"+t.colorRange(e.label).substr(1)+")":t.colorRange(e.label)}).attr("y",function(){return t.barPadding/2}).attr("x",function(e,i){return t.data.slice(0,i).reduce(function(e,i){return+e+ +t.xAxisScale(i.value)},1)}).attr("pointer-events","none").call(function(e){return e.transition().delay(function(t,e){return 250*e}).ease(a.easeLinear).attr("width",function(e,a){if(a===t.data.length-s-1&&i)return t.xAxisScale(e.value);if(a!==t.data.length-1){var r=t.xAxisScale(e.value)-+t.barMargin;return r=-1===Math.sign(r)?0:r}return t.xAxisScale(e.value)}).transition().attr("pointer-events","auto")})},function(e){return e.attr("pointer-events","none").transition().duration(1e3).attr("width",function(e,i){return i===t.data.length-1?t.xAxisScale(e.value):t.xAxisScale(e.value)-t.barMargin}).attr("x",function(e,i){return t.data.slice(0,i).reduce(function(e,i){return e+ +t.xAxisScale(i.value)},0)}).transition().attr("pointer-events","auto")},function(t){return t.transition().attr("pointer-events","none").remove()}).on("mouseover",function(e,i,s){return t.barMouseOver(a.event,e,i,s)}).on("mouseout",function(e,i,a){return t.barMouseOut()}).on("click",function(e,i,s){return t.barMouseClick(a.event,e,i,s)}),this.hideLegend||this.chart.select(".legend").selectAll(".legend-item").data(this.data).join(function(e){var i=e.append("li").attr("class","legend-item").classed("align-items-start",t.isCompare);return i.insert("span").attr("class","legend-key").style("background-color",function(e){return t.colorRange(e.label)}).classed("mt-1",t.isCompare),i.insert("span").attr("class","legend-description").classed("d-flex",t.isCompare).classed("flex-column",t.isCompare),i.select(".legend-description").insert("span").attr("class","legend-label").html(function(e){switch(t.legendLabelFormatType){case"number":return t.legendLabelFormat(e.label);case"time":var i=a.isoParse(e.label);return t.legendLabelFormat(i);default:return e.label}}),t.isCompare&&(i.select(".legend-description").insert("div").attr("class","legend-change"),i.select(".legend-change").html(function(e){return'<div class="metric-block-indicator '+e.compareChangeDirection+" "+(e.compareChangeInverse?"inverse":"")+' mt-1"><span>'+t.tooltipCompareChangeFormat(e.compareChangeValue)+"</span></div>"})),i},function(e){return e.select(".legend-label").html(function(e){switch(t.legendLabelFormatType){case"number":return t.legendLabelFormat(e.label);case"time":var i=a.isoParse(e.label);return t.legendLabelFormat(i);default:return e.label}}),e},function(t){return t.remove()}).on("mouseover",function(e,i,s){return t.legendMouseOver(a.event,e,i,s)}).on("mouseout",function(){return t.legendMouseOut()}).on("click",function(e,i,s){return t.legendMouseClick(a.event,e,i,s)})},t.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-single-stacked-bar",template:"",changeDetection:e.ChangeDetectionStrategy.OnPush}]}],t.ctorParameters=function(){return[{type:l},{type:e.ElementRef},{type:i.ViewportScroller},{type:i.Location}]},t.propDecorators={chartClass:[{type:e.HostBinding,args:["class.pbds-chart"]}],singleStackedBarClass:[{type:e.HostBinding,args:["class.pbds-chart-single-stacked-bar"]}],data:[{type:e.Input}],width:[{type:e.Input}],height:[{type:e.Input}],nullValueText:[{type:e.Input}],percentage:[{type:e.Input}],marginTop:[{type:e.Input}],marginRight:[{type:e.Input}],marginBottom:[{type:e.Input}],marginLeft:[{type:e.Input}],barMargin:[{type:e.Input}],hideXAxis:[{type:e.Input}],xAxisTicks:[{type:e.Input}],xAxisTitle:[{type:e.Input}],xAxisFormatType:[{type:e.Input}],xAxisFormatString:[{type:e.Input}],xAxisTickLabelSuffix:[{type:e.Input}],hideXGrid:[{type:e.Input}],hideLegend:[{type:e.Input}],hideLegendTooltip:[{type:e.Input}],legendWidth:[{type:e.Input}],legendPosition:[{type:e.Input}],legendLabelFormatType:[{type:e.Input}],legendLabelFormatString:[{type:e.Input}],hideTooltip:[{type:e.Input}],tooltipLabelFormatType:[{type:e.Input}],tooltipLabelFormatString:[{type:e.Input}],tooltipDateFormatString:[{type:e.Input}],tooltipValueFormatType:[{type:e.Input}],tooltipValueFormatString:[{type:e.Input}],tooltipValueSuffix:[{type:e.Input}],tooltipPercentFormatString:[{type:e.Input}],compareChangeFormatString:[{type:e.Input}],monochrome:[{type:e.Input}],theme:[{type:e.Input}],hovered:[{type:e.Output}],clicked:[{type:e.Output}]},t}();var F=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{declarations:[h,c,d,u,p,g,x,f,m,y,b,v,A],imports:[i.CommonModule],exports:[h,c,d,u,p,g,x,f,m,y,b,v,A]}]}],t}();var S=function(){function t(t){this._scroll=t}return t.prototype.onWindowScroll=function(){var t=this._scroll.getScrollPosition();this.shadow=t[1]>20},t.decorators=[{type:e.Directive,args:[{selector:"header.bg-brand-header"}]}],t.ctorParameters=function(){return[{type:i.ViewportScroller}]},t.propDecorators={shadow:[{type:e.HostBinding,args:["class.pbds-header-shadow"]}],onWindowScroll:[{type:e.HostListener,args:["window:scroll",[]]}]},t}();var k=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{declarations:[S],imports:[i.CommonModule],exports:[S]}]}],t}();t.DatavizBubbleMapComponent=f,t.PbdsDatavizBarComponent=c,t.PbdsDatavizChoroplethMapComponent=b,t.PbdsDatavizGaugeComponent=u,t.PbdsDatavizGroupedBarComponent=v,t.PbdsDatavizHeatmapComponent=y,t.PbdsDatavizLineComponent=d,t.PbdsDatavizMetricBlockComponent=x,t.PbdsDatavizMetricIndicatorComponent=m,t.PbdsDatavizModule=F,t.PbdsDatavizPieComponent=h,t.PbdsDatavizService=l,t.PbdsDatavizSingleStackedBarComponent=A,t.PbdsDatavizSparklineComponent=p,t.PbdsDatavizStackedBarComponent=g,t.PbdsHeaderShadowDirective=S,t.PbdsHeaderShadowModule=k,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=pb-design-system.umd.min.js.map