{"version":3,"sources":["../../../node_modules/tslib/tslib.es6.js","ng://pb-design-system/lib/dataviz/dataviz.service.ts","ng://pb-design-system/lib/dataviz/dataviz-pie.component.ts","ng://pb-design-system/lib/dataviz/dataviz-bar.component.ts","ng://pb-design-system/lib/dataviz/dataviz-line.component.ts","ng://pb-design-system/lib/dataviz/dataviz-gauge.component.ts","ng://pb-design-system/lib/dataviz/dataviz-sparkline.component.ts","ng://pb-design-system/lib/dataviz/dataviz-bar-stacked.component.ts","ng://pb-design-system/lib/dataviz/dataviz-metric-indicator.component.ts","ng://pb-design-system/lib/dataviz/dataviz-metric-block.component.ts","ng://pb-design-system/lib/dataviz/dataviz-bubble-map.component.ts","ng://pb-design-system/lib/dataviz/dataviz-heatmap.component.ts","ng://pb-design-system/lib/dataviz/dataviz-choropleth-map.component.ts","ng://pb-design-system/lib/dataviz/dataviz-bar-grouped.component.ts","ng://pb-design-system/lib/dataviz/dataviz-bar-single-horizontal.component.ts","ng://pb-design-system/lib/dataviz/dataviz.module.ts","ng://pb-design-system/lib/header-shadow/header-shadow.directive.ts","ng://pb-design-system/lib/header-shadow/header-shadow.module.ts"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__read","o","m","Symbol","iterator","r","e","ar","next","done","push","value","error","__spread","concat","PbdsDatavizService","_this","colors","classic","full","mono","twilight","ocean","sunset","getColors","theme","createGradientDefs","svg","vertical","color","gradient","append","attr","replace","createGlowFilter","glow","feOffsets","dy","slope","y","merge","x","Injectable","args","providedIn","PbdsDatavizPieComponent","_dataviz","_element","chartClass","pieClass","width","type","monochrome","legendLabelFormatType","legendLabelFormatString","legendValueFormatString","tooltipLabelFormatType","tooltipLabelFormatString","tooltipValueFormatString","hovered","EventEmitter","clicked","currentData","updateChart","paths","selectAll","data","pie","exit","transition","remove","each","d","outerRadius","duration","attrTween","arcTween","enterPaths","enter","arc","colorRange","label","nodes","splice","style","legendItem","chart","select","html","parsedTime","d3_isoParse","legendLabelFormat","legendValueFormat","enterLegendItem","legendDescription","on","index","legendMouseOverFocus","pathMouseOver","d3_event","legendMouseOutBlur","pathMouseOut","emit","tooltipShow","node","tooltipMove","tooltipHide","pathClick","d3_interpolate","filter","classed","event","slices","slice","delay","arcZoom","tooltipSetPosition","percentage","endAngle","startAngle","Math","PI","tooltipLabelFormat","tooltip","tooltipValueFormat","coordinates","d3_mouse","ngOnInit","margin","top","right","bottom","left","height","innerRadius","min","anglePad","d3_format","d3_timeFormat","d3_scaleOrdinal","range","domain","map","c","d3_pie","padAngle","sort","d3_arc","padRadius","d3_select","nativeElement","legend","ngOnChanges","changes","firstChange","ngOnDestroy","Component","selector","template","changeDetection","ChangeDetectionStrategy","OnPush","ElementRef","HostBinding","Input","Output","PbdsDatavizBarComponent","_scroll","_location","barClass","singleSeries","xAxisFormatType","xAxisFormatString","yAxisFormatType","yAxisFormatString","yAxisTicks","yAxisMinBuffer","yAxisMaxBuffer","hideLegend","legendWidth","legendPosition","tooltipValueFormatType","marginTop","marginRight","marginBottom","marginLeft","threshold","average","group","groupEnter","xAxisScale","yAxisScale","d3_min","d3_max","rangeRound","nice","xAxis","xAxisCall","yAxis","yAxisCall","hideXGrid","xGrid","xGridCall","hideYGrid","yGrid","yGridCall","hideGrayBars","bandwidth","path","substr","barMouseOver","barMouseOut","barMouseClick","legendMouseOver","legendMouseOut","legendMouseClick","yThreshold","raise","yAverage","bar","barColor","_groups","dimensions","getBoundingClientRect","scroll","getScrollPosition","hideTooltipLabel","tooltipOffsetWidth","offsetWidth","tooltipOffsetHeight","offsetHeight","xAxisFormatter","item","xAxisFormat","parseDate","yAxisFormatter","yAxisFormat","hideXAxis","hideYAxis","hideXAxisZero","hideYAxisZero","hideXAxisDomain","hideYAxisDomain","hideTooltip","hideXAxisTicks","hideYAxisTicks","xAxisTickSize","xAxisTickSizeOuter","yAxisTickSize","yAxisTickSizeOuter","d3_scaleBand","align","paddingInner","paddingOuter","d3_axisBottom","tickSize","tickSizeOuter","tickFormat","d3_scaleLinear","d3_axisLeft","ticks","ViewportScroller","Location","PbdsDatavizLineComponent","lineClass","area","xAxisTicks","tooltipHeadingFormatString","tooltipHovered","tooltipClicked","mouserect","d3_extent","dates","series","minVal","values","maxVal","d3line","d3area","line","lineWidth","linePoints","tooltipItem","tooltipHeadingFormat","entertooltipItem","mouserectMouseMove","mouseXDate","invert","leftIndex","d3_bisectLeft","d3_isoFormat","dateLower","Date","dateUpper","closestDate","closestIndex","indexOf","circles","tooltipLine","mousedata","date","mouserectMouseOut","mouserectMouseClick","position","mouserectDimensions","tooltipDimensions","dimensionCalculated","clientWidth","document","body","lineCurved","d3_line","curve","d3_curveCatmullRom","alpha","d3_area","y0","y1","d3_scaleTime","PbdsDatavizGaugeComponent","gaugeClass","hideLabel","labelFormatString","gaugeWidth","degreesToRadians","degree","calculateMinMax","minvalue","maxvalue","calculateCurve","start","drawChart","gauge","radius","labelTween","textTween","newAngle","interpolate","tween","oldValue","text","updatedNumber","labelFormat","max","rounded","cornerRadius","previousValue","PbdsDatavizSparklineComponent","sparklineClass","colorNegative","strokeWidth","datum","barWidth","abs","PbdsDatavizBarStackedComponent","stackedBarClass","tooltipHeadingFormatType","tooltipHeadingValueFormatType","tooltipHeadingValueFormatString","dataKeys","keys","dataStack","d3_stack","order","d3_stackOrderNone","key","yAxisMax","grayBars","join","update","bars","mouseBars","yPosition","xPosition","total","tooltipHeadingValueFormat","PbdsDatavizMetricIndicatorComponent","class","indicator","inverse","defineProperty","PbdsDatavizMetricBlockComponent","heading","unit","description","centered","centeredText","hideValueMargin","isPercentUnit","isUnit","indicatorRef","ContentChild","static","DatavizBubbleMapComponent","bubbleMapClass","feature","scale","center","dot","textColor","textSizeRange","dotSize","bubbleSizeRange","bubbleLabelFormatType","bubbleLabelFormatString","hideTooltipValue","bubbleContainer","projection","longitude","latitude","sqrt","bubbleRadius","bubbleMouseOver","bubbleMouseOut","bubbleMouseClick","bubbleLabelFormat","round","fontRange","projectionType","d3_geoAlbers","d3_geoAlbersUsa","d3_geoMercator","topojsonFeature","topojson.feature","topojson","objects","fitSize","geoPath","d3_geoPath","features","topojson.mesh","a","b","PbdsDatavizHeatmapComponent","heatmapClass","tooltipXLabelFormatType","tooltipXLabelFormatString","tooltipYLabelFormatType","tooltipYLabelFormatString","undefined","xLabel","yLabel","blockMouseOver","blockMouseOut","blockMouseClick","colorDomain","li","tooltipYLabelFormat","tooltipXLabelFormat","reverse","colorValues","d3_scaleThreshold","d3_scaleQuantile","quantiles","d3_scaleQuantize","thresholds","xAxisLabels","Set","yAxisLabels","tslib_1.__spread","PbdsDatavizChoroplethMapComponent","choroplethMapClass","dataField","mesh","colorScale","legendLabel","legendValueFormatType","legendLeft","legendTop","match","find","obj","some","featureMouseOver","featureMouseOut","featureMouseClick","mouse","mouseLeft","mouseTop","geometry","geometryLeft","geometryTop","scrollTop","g","tickValues","d3_range","PbdsDatavizBarGroupedComponent","groupedBarClass","xAxisMaxBuffer","showGrid","clone","d3_values","barScale","updateChartVertical","xAxisMax","updateChartHorizontal","parentIndex","updateLegend","legendData","legendKeys","insert","PbdsDatavizBarSingleHorizontalComponent","singleStackedBarClass","nullValueText","barMargin","xAxisTitle","xAxisTickLabelSuffix","hideLegendTooltip","tooltipDateFormatString","tooltipValueSuffix","tooltipPercentFormatString","compareChangeFormatString","isSingleData","isCompare","barPadding","d3_sum","comparePercentage","compareValue","tooltipLabel","tooltipCompareDaterangeMargin","tooltipCompareDaterange","tooltipCompareValue","tooltipDaterangeMargin","tooltipDaterange","tooltipValue","tooltipIndicator","compareStartDate","compareEndDate","tooltipDateFormat","tooltipPercentFormat","comparveValue","startDate","endDate","compareChangeDirection","compareChangeInverse","tooltipCompareChangeFormat","compareChangeValue","barHover","includes","xAxisTitleMargin","ceil","sumValues","isLastBarZero","lastBarZeroCount","cloneData","isLast","forEach","array","format","Number","isInteger","reduce","acc","ease","d3_easeLinear","sign","PbdsDatavizModule","NgModule","declarations","imports","CommonModule","exports","PbdsHeaderShadowDirective","onWindowScroll","offset","shadow","Directive","HostListener","PbdsHeaderShadowModule"],"mappings":"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","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class PbdsDatavizService {\n  private colors = {\n    classic: {\n      full: [\n        '#e23da8',\n        '#314183',\n        '#1bb9ff',\n        '#ff8b00',\n        '#0384d4',\n        '#00b140',\n        '#a319b1',\n        '#ffc500',\n        '#8b98c8',\n        '#ccb8ce',\n        '#e6c49c',\n        '#9b9b9b'\n      ],\n      mono: ['#000E7B', '#2C4DCC', '#5678FF', '#B1C1FF', '#C9DBFF', '#D4D7ED'] // blue\n    },\n    twilight: {\n      full: [\n        '#0384d4',\n        '#314183',\n        '#1bb9ff',\n        '#ff8b00',\n        '#e23da8',\n        '#00b140',\n        '#a319b1',\n        '#ffc500',\n        '#8b98c8',\n        '#ccb8ce',\n        '#e6c49c',\n        '#9b9b9b'\n      ],\n      mono: ['#05395C', '#0A5B92', '#0072B8', '#5DA9DC', '#A5D4F3', '#D1EDFF'] // light blue\n    },\n    ocean: {\n      full: [\n        '#00b140',\n        '#0384d4',\n        '#314183',\n        '#1bb9ff',\n        '#e23da8',\n        '#ffc500',\n        '#a319b1',\n        '#ff8b00',\n        '#8b98c8',\n        '#e6c49c',\n        '#ccb8ce',\n        '#9b9b9b'\n      ],\n      mono: ['#394B4D', '#3A6B6E', '#14767D', '#99BFC2', '#C9E6E8', '#DEECED'] // blue-green\n    },\n    sunset: {\n      full: [\n        '#512e8b',\n        '#ff8b00',\n        '#1bb9ff',\n        '#e23da8',\n        '#ffc500',\n        '#00b140',\n        '#0384d4',\n        '#ccb8ce',\n        '#314183',\n        '#e6c49c',\n        '#8b98c8',\n        '#9b9b9b'\n      ],\n      mono: ['#31254A', '#50248F', '#7945C4', '#9A79E2', '#C4A8FF', '#D9C7FF'] // purple\n    }\n  };\n\n  constructor() {}\n\n  getColors = (mono = false, theme = 'classic') => {\n    return mono ? this.colors[theme].mono : this.colors[theme].full;\n  };\n\n  createGradientDefs = (svg, mono = false, theme = 'classic', vertical = true) => {\n    const colors = mono ? [this.colors[theme].mono[2]] : this.colors[theme].full;\n\n    for (let i = 0; i < colors.length; i++) {\n      const color = mono ? this.colors[theme].mono[2] : this.colors[theme].full[i];\n      let gradient;\n\n      if (vertical) {\n        gradient = svg\n          .append('defs')\n          .append('linearGradient')\n          .attr('id', `gradient-${color.replace('#', '')}`)\n          .attr('x1', '0')\n          .attr('y1', '0')\n          .attr('x2', '0')\n          .attr('y2', '1')\n          .attr('spreadMethod', 'pad');\n\n        gradient\n          .append('stop')\n          .attr('offset', '0%')\n          .attr('stop-color', color)\n          .attr('stop-opacity', '1'); // top of bar will be full opacity\n\n        gradient\n          .append('stop')\n          .attr('offset', '100%')\n          .attr('stop-color', color)\n          .attr('stop-opacity', '.3'); // bottom of bar will be .3 opacity\n      } else {\n        gradient = svg\n          .append('defs')\n          .append('linearGradient')\n          .attr('id', `gradient-horizontal-${color.replace('#', '')}`)\n          .attr('x1', '1')\n          .attr('y1', '0')\n          .attr('x2', '0')\n          .attr('y2', '0')\n          .attr('spreadMethod', 'pad');\n\n        gradient\n          .append('stop')\n          .attr('offset', '0%')\n          .attr('stop-color', color)\n          .attr('stop-opacity', '1'); // top of bar will be full opacity\n\n        gradient\n          .append('stop')\n          .attr('offset', '100%')\n          .attr('stop-color', color)\n          .attr('stop-opacity', '.3'); // bottom of bar will be .3 opacity\n      }\n    }\n\n    return colors;\n  };\n\n  createGlowFilter = svg => {\n    // add a new definition\n    const glow = svg\n      .append('defs')\n      .append('filter')\n      .attr('id', 'glow')\n      .attr('width', '200%')\n      .attr('height', '200%');\n\n    glow\n      .append('feGaussianBlur')\n      .attr('in', 'SourceGraphic')\n      .attr('stdDeviation', 4);\n\n    // build two dropshadows with different intensities\n    const feOffsets = [\n      {\n        dy: 2,\n        slope: 0.2\n      },\n      {\n        dy: 5,\n        slope: 0.05\n      }\n    ];\n\n    for (let i = 0; i < feOffsets.length; i++) {\n      glow\n        .append('feOffset')\n        .attr('result', 'offsetBlur' + i)\n        .attr('dx', 0)\n        .attr('dy', feOffsets[i].dy);\n    }\n\n    for (let y = 0; y < feOffsets.length; y++) {\n      glow\n        .append('feComponentTransfer')\n        .attr('result', 'coloredBlur' + y)\n        .attr('in', 'offsetBlur' + y)\n        .append('feFuncA')\n        .attr('type', 'linear')\n        .attr('slope', feOffsets[y].slope);\n    }\n\n    const merge = glow.append('feMerge');\n\n    merge.append('feMergeNode').attr('in', 'SourceGraphic');\n\n    for (let x = 0; x < feOffsets.length; x++) {\n      merge.append('feMergeNode').attr('in', 'coloredBlur' + x);\n    }\n  };\n}\n","import {\n  Component,\n  OnInit,\n  Input,\n  ElementRef,\n  HostBinding,\n  OnChanges,\n  SimpleChanges,\n  Output,\n  EventEmitter,\n  ChangeDetectionStrategy,\n  OnDestroy\n} from '@angular/core';\n\nimport {\n  select as d3_select,\n  scaleOrdinal as d3_scaleOrdinal,\n  pie as d3_pie,\n  arc as d3_arc,\n  interpolate as d3_interpolate,\n  mouse as d3_mouse,\n  format as d3_format,\n  event as d3_event,\n  timeFormat as d3_timeFormat,\n  isoParse as d3_isoParse\n} from 'd3';\n\nimport { PbdsDatavizService } from './dataviz.service';\nimport { PbdsDatavizPie } from './dataviz.interfaces';\n\n@Component({\n  selector: 'pbds-dataviz-pie',\n  template: ``,\n  styleUrls: [],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class PbdsDatavizPieComponent implements OnInit, OnChanges, OnDestroy {\n  @HostBinding('class.pbds-chart')\n  chartClass = true;\n\n  @HostBinding('class.pbds-chart-pie')\n  pieClass = true;\n\n  @Input()\n  data: Array<PbdsDatavizPie>;\n\n  @Input()\n  width = 300;\n\n  @Input()\n  type: 'pie' | 'donut' = 'pie';\n\n  @Input()\n  monochrome = false;\n\n  @Input()\n  legendLabelFormatType: 'time' = null;\n\n  @Input()\n  legendLabelFormatString = '';\n\n  @Input()\n  legendValueFormatString = '';\n\n  @Input()\n  tooltipLabelFormatType: 'time' = null;\n\n  @Input()\n  tooltipLabelFormatString = '';\n\n  @Input()\n  tooltipValueFormatString = '';\n\n  @Input()\n  theme;\n\n  @Output()\n  hovered: EventEmitter<object> = new EventEmitter<object>();\n\n  @Output()\n  clicked: EventEmitter<object> = new EventEmitter<object>();\n\n  private currentData = [];\n  private height;\n  private chart;\n  private margin;\n  private colors;\n  private colorRange;\n  private arc;\n  private arcZoom;\n  private svg;\n  private pie;\n  private legend;\n  private legendLabelFormat;\n  private legendValueFormat;\n  private innerRadius;\n  private anglePad;\n  private outerRadius;\n  private tooltip;\n  private tooltipLabelFormat;\n  private tooltipValueFormat;\n\n  constructor(private _dataviz: PbdsDatavizService, private _element: ElementRef) {}\n\n  ngOnInit() {\n    this.margin = { top: 10, right: 10, bottom: 10, left: 10 };\n    this.width = this.width - this.margin.left - this.margin.right;\n    this.height = this.width - this.margin.top - this.margin.bottom;\n    this.colors = this._dataviz.getColors(this.monochrome, this.theme);\n    this.innerRadius = Math.min(this.width, this.height) / 2.5;\n    this.outerRadius = Math.min(this.width, this.height) / 2;\n    this.arcZoom = 10;\n    this.anglePad = 0.02;\n    this.legendValueFormat = d3_format(this.legendValueFormatString);\n    this.tooltipValueFormat = d3_format(this.tooltipValueFormatString);\n\n    switch (this.legendLabelFormatType) {\n      case 'time':\n        this.legendLabelFormat = d3_timeFormat(this.legendLabelFormatString);\n        break;\n      default:\n        this.legendLabelFormat = null;\n        break;\n    }\n\n    switch (this.tooltipLabelFormatType) {\n      case 'time':\n        this.tooltipLabelFormat = d3_timeFormat(this.tooltipLabelFormatString);\n        break;\n      default:\n        this.tooltipLabelFormat = null;\n        break;\n    }\n\n    this.colorRange = d3_scaleOrdinal()\n      .range(this.colors)\n      .domain(this.data.map(c => c.label));\n\n    if (this.type === 'pie') {\n      this.innerRadius = 0;\n      this.anglePad = 0;\n    }\n\n    this.pie = d3_pie()\n      .padAngle(this.anglePad)\n      .value((d: any) => d.value)\n      .sort(null);\n\n    this.arc = d3_arc()\n      .padRadius(this.outerRadius)\n      .innerRadius(this.innerRadius);\n\n    this.chart = d3_select(this._element.nativeElement).attr('aria-hidden', 'true');\n\n    this.svg = this.chart\n      .append('svg')\n      .attr('width', this.width)\n      .attr('height', this.height)\n      .attr('class', 'img-fluid')\n      .attr('preserveAspectRatio', 'xMinYMin meet')\n      .attr(\n        'viewBox',\n        `-${this.width / 2 + this.margin.left} -${this.height / 2 + this.margin.top} ${this.width +\n          this.margin.left +\n          this.margin.right} ${this.height + this.margin.top + this.margin.bottom}`\n      );\n\n    this.legend = this.chart.append('ul').attr('class', 'legend legend-right');\n\n    this.tooltip = this.chart\n      .append('div')\n      .style('opacity', 0)\n      .attr('class', 'pbds-tooltip')\n      .attr('aria-hidden', 'true');\n\n    this.updateChart();\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (changes.data && !changes.data.firstChange) {\n      this.updateChart();\n    }\n  }\n\n  ngOnDestroy() {\n    if (this.tooltip) this.tooltip.remove();\n  }\n\n  updateChart = () => {\n    const paths = this.svg.selectAll('path').data(this.pie(this.data));\n\n    paths\n      .exit()\n      .transition()\n      .attr('pointer-events', 'none')\n      .remove();\n\n    //update existing items\n    paths\n      .each((d: any) => (d.outerRadius = this.outerRadius))\n      .attr('pointer-events', 'none')\n      .transition()\n      .duration(500)\n      .attrTween('d', this.arcTween)\n      .transition()\n      .attr('pointer-events', 'auto');\n\n    // paths on enter\n    const enterPaths = paths\n      .enter()\n      .append('path')\n      .each((d: any) => (d.outerRadius = this.outerRadius))\n      .attr('d', this.arc)\n      .attr('fill', (d: any) => this.colorRange(d.data.label))\n      .attr('class', 'slice')\n      .each((d, i, nodes) => {\n        this.currentData.splice(i, 1, d);\n      });\n\n    if (this.type === 'pie') {\n      enterPaths\n        .style('stroke', '#fff')\n        .style('stroke-width', 2)\n        .style('stroke-alignment', 'inner');\n    }\n\n    const legendItem = this.chart\n      .select('.legend')\n      .selectAll('.legend-item')\n      .data(this.data);\n\n    legendItem.exit().remove();\n\n    // update existing items\n    legendItem.select('.legend-label').html((d: any) => {\n      switch (this.legendLabelFormatType) {\n        case 'time':\n          const parsedTime = d3_isoParse(d.label);\n          return this.legendLabelFormat(parsedTime);\n\n        default:\n          return d.label;\n      }\n    });\n\n    legendItem.select('.legend-value').html((d: any) => this.legendValueFormat(d.value));\n\n    // legend items on enter\n    const enterLegendItem = legendItem\n      .enter()\n      .append('li')\n      // .attr('tabindex', 0)\n      .attr('class', 'legend-item');\n\n    enterLegendItem\n      .append('span')\n      .attr('class', 'legend-key')\n      .style('background-color', (d: any) => this.colorRange(d.label));\n\n    const legendDescription = enterLegendItem.append('span').attr('class', 'legend-description');\n\n    legendDescription\n      .append('span')\n      .attr('class', 'legend-label')\n      .html((d: any) => {\n        switch (this.legendLabelFormatType) {\n          case 'time':\n            const parsedTime = d3_isoParse(d.label);\n            return this.legendLabelFormat(parsedTime);\n\n          default:\n            return d.label;\n        }\n      });\n\n    legendDescription\n      .append('span')\n      .attr('class', 'legend-value')\n      .html((d: any) => this.legendValueFormat(d.value));\n\n    enterLegendItem\n      .on('mouseover focus', (data, index, nodes) => {\n        this.legendMouseOverFocus(data, index, nodes);\n        this.pathMouseOver(d3_event, data, index, nodes);\n      })\n      .on('mouseout blur', (data, index, nodes) => {\n        this.legendMouseOutBlur(data, index, nodes);\n        this.pathMouseOut(data, index, nodes);\n      })\n      .on('click', (data, index, nodes) => {\n        this.clicked.emit(data);\n      });\n\n    enterPaths\n      .on('mouseover', (data, index, nodes) => {\n        this.pathMouseOver(d3_event, data, index, nodes);\n        this.tooltipShow(this.chart.node(), data);\n      })\n      .on('mousemove', (data, index, nodes) => {\n        this.tooltipMove(this.chart.node());\n      })\n      .on('mouseout', (data, index, nodes) => {\n        this.pathMouseOut(data, index, nodes);\n        this.tooltipHide();\n      })\n      .on('click', (data, index, nodes) => {\n        this.pathClick(d3_event, data, index, nodes);\n      });\n  };\n\n  private arcTween = (data, index, nodes) => {\n    // console.log('ARGS: ', data, index, nodes);\n    const i = d3_interpolate(this.currentData[index], data);\n\n    this.currentData[index] = i(1);\n    return t => this.arc(i(t));\n  };\n\n  private legendMouseOverFocus = (data, index, nodes) => {\n    this.chart\n      .selectAll('.legend-item')\n      .filter((d, i) => i !== index)\n      .classed('inactive', true);\n  };\n\n  private legendMouseOutBlur = (data, index, nodes) => {\n    this.chart.selectAll('.legend-item').classed('inactive', false);\n  };\n\n  private pathMouseOver = (event, data, index, nodes) => {\n    const slices = this.chart.selectAll('.slice');\n    const slice = slices.filter((d, i) => i === index);\n\n    this.chart\n      .selectAll('.legend-item')\n      .filter((d, i) => i !== index)\n      .classed('inactive', true);\n\n    slices.filter((d, i) => i !== index).classed('inactive', true);\n\n    slice\n      .transition()\n      .duration(300)\n      .delay(0)\n      .attrTween('d', (d: any) => {\n        const i = d3_interpolate(d.outerRadius, this.outerRadius + this.arcZoom);\n        return t => {\n          d.outerRadius = i(t);\n          return this.arc(d);\n        };\n      });\n\n    this.hovered.emit({\n      event: event,\n      data: data.data ? data.data : data // legend hover data is different than slice hover data\n    });\n  };\n\n  private pathMouseOut = (data, index, value) => {\n    const slices = this.chart.selectAll('.slice');\n    const slice = slices.filter((d, i) => i === index);\n\n    this.chart\n      .selectAll('.legend-item')\n      .filter((d, i) => i !== index)\n      .classed('inactive', false);\n\n    slices.classed('inactive', false);\n\n    slice\n      .transition()\n      .duration(300)\n      .delay(0)\n      .attrTween('d', (d: any) => {\n        const i = d3_interpolate(d.outerRadius, this.outerRadius);\n        return t => {\n          d.outerRadius = i(t);\n          return this.arc(d);\n        };\n      });\n  };\n\n  private pathClick = (event, data, index, nodes) => {\n    this.clicked.emit({\n      event: event,\n      data: data.data\n    });\n  };\n\n  private tooltipShow = (node, data) => {\n    this.tooltipSetPosition(node);\n\n    const percentage = (data.endAngle - data.startAngle) / (2 * Math.PI);\n    let label;\n\n    switch (this.tooltipLabelFormatType) {\n      case 'time':\n        const parsedTime = d3_isoParse(data.data.label);\n        label = this.tooltipLabelFormat(parsedTime);\n        break;\n\n      default:\n        label = data.data.label;\n    }\n\n    this.tooltip.html(\n      `\n        <div class=\"tooltip-label\">${label}</div>\n        <div class=\"tooltip-value\">${this.tooltipValueFormat(percentage)}</div>\n      `\n    );\n\n    this.tooltip.style('opacity', 1);\n  };\n\n  private tooltipMove = node => {\n    this.tooltipSetPosition(node);\n  };\n\n  private tooltipHide = () => {\n    this.tooltip.style('opacity', 0);\n  };\n\n  private tooltipSetPosition = node => {\n    const coordinates = d3_mouse(node);\n\n    this.tooltip.style('left', `${coordinates[0] + 16}px`);\n    this.tooltip.style('top', `${coordinates[1] + 16}px`);\n  };\n}\n","import {\n  Component,\n  OnInit,\n  OnChanges,\n  Input,\n  Output,\n  EventEmitter,\n  ElementRef,\n  HostBinding,\n  OnDestroy,\n  SimpleChanges,\n  ChangeDetectionStrategy\n} from '@angular/core';\n\nimport { ViewportScroller, Location } from '@angular/common';\n\nimport {\n  select as d3_select,\n  isoParse as d3_isoParse,\n  timeFormat as d3_timeFormat,\n  format as d3_format,\n  scaleOrdinal as d3_scaleOrdinal,\n  scaleBand as d3_scaleBand,\n  scaleLinear as d3_scaleLinear,\n  min as d3_min,\n  max as d3_max,\n  axisBottom as d3_axisBottom,\n  axisLeft as d3_axisLeft,\n  event as d3_event\n} from 'd3';\n\nimport { PbdsDatavizService } from './dataviz.service';\nimport { PbdsDatavizBar } from './dataviz.interfaces';\n\n@Component({\n  selector: 'pbds-dataviz-bar',\n  template: ``,\n  styles: [],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class PbdsDatavizBarComponent implements OnInit, OnDestroy, OnChanges {\n  @HostBinding('class.pbds-chart')\n  chartClass = true;\n\n  @HostBinding('class.pbds-chart-bar')\n  barClass = true;\n\n  @Input()\n  data: PbdsDatavizBar[];\n\n  @Input()\n  width = 306;\n\n  @Input()\n  height = 400;\n\n  @Input()\n  type: 'low' | 'medium' | 'high' | 'debug' = 'medium'; // debug to show all chart options\n\n  @Input()\n  singleSeries = false;\n\n  @Input()\n  xAxisFormatType: 'number' | 'time' = null;\n\n  @Input()\n  xAxisFormatString = '';\n\n  @Input()\n  yAxisFormatType: 'number' | 'time' = null;\n\n  @Input()\n  yAxisFormatString = '';\n\n  @Input()\n  yAxisTicks = 5;\n\n  @Input()\n  yAxisMinBuffer = 0.01;\n\n  @Input()\n  yAxisMaxBuffer = 0.01;\n\n  @Input()\n  hideLegend = false;\n\n  @Input()\n  legendWidth = 105 + 28; // hardcoded legend width + left margin, do not document until feedback\n\n  @Input()\n  legendPosition: 'right' | 'bottom' = 'right';\n\n  @Input()\n  legendLabelFormatType: 'number' | 'time' = null;\n\n  @Input()\n  legendLabelFormatString = '';\n\n  @Input()\n  tooltipLabelFormatType: 'number' | 'time' = null;\n\n  @Input()\n  tooltipLabelFormatString = '';\n\n  @Input()\n  tooltipValueFormatType: 'number' | 'time' = null;\n\n  @Input()\n  tooltipValueFormatString = '';\n\n  @Input()\n  marginTop = 10; // hardcoded on purpose, do not document until feedback\n\n  @Input()\n  marginRight = 0; // hardcoded on purpose, do not document until feedback\n\n  @Input()\n  marginBottom = 30; // hardcoded on purpose, do not document until feedback\n\n  @Input()\n  marginLeft = 55; // hardcoded on purpose, do not document until feedback\n\n  @Input()\n  threshold = null;\n\n  @Input()\n  average = null;\n\n  @Input()\n  theme;\n\n  @Output()\n  hovered: EventEmitter<object> = new EventEmitter<object>();\n\n  @Output()\n  clicked: EventEmitter<object> = new EventEmitter<object>();\n\n  private chart;\n  private svg;\n  private margin;\n  private colorRange;\n  private hideGrayBars: boolean;\n  private yThreshold;\n  private yAverage;\n  private xAxisScale;\n  private xAxisCall;\n  private xAxis;\n  private xAxisFormat;\n  private yAxisScale;\n  private yAxisCall;\n  private yAxis;\n  private yAxisFormat;\n  private xGrid;\n  private xGridCall;\n  private yGrid;\n  private yGridCall;\n  private xAxisTickSize: number;\n  private xAxisTickSizeOuter: number;\n  private yAxisTickSize: number;\n  private yAxisTickSizeOuter: number;\n  private hideXAxis: boolean;\n  private hideYAxis: boolean;\n  private hideXAxisDomain: boolean;\n  private hideYAxisDomain: boolean;\n  private hideXAxisZero: boolean;\n  private hideYAxisZero: boolean;\n  private hideXGrid: boolean;\n  private hideYGrid: boolean;\n  private hideXAxisTicks: boolean;\n  private hideYAxisTicks: boolean;\n  private legendLabelFormat;\n  private tooltip;\n  private hideTooltip: boolean;\n  private hideTooltipLabel: boolean;\n  private tooltipValueFormat;\n  private tooltipLabelFormat;\n\n  constructor(\n    private _dataviz: PbdsDatavizService,\n    private _element: ElementRef,\n    private _scroll: ViewportScroller,\n    private _location: Location\n  ) {}\n\n  ngOnInit() {\n    this.margin = {\n      top: +this.marginTop,\n      right: +this.marginRight,\n      bottom: +this.marginBottom,\n      left: +this.marginLeft\n    };\n\n    switch (this.xAxisFormatType) {\n      case 'number':\n        this.xAxisFormat = d3_format(this.xAxisFormatString);\n        break;\n      case 'time':\n        this.xAxisFormat = d3_timeFormat(this.xAxisFormatString);\n        break;\n    }\n\n    switch (this.yAxisFormatType) {\n      case 'number':\n        this.yAxisFormat = d3_format(this.yAxisFormatString);\n        break;\n      case 'time':\n        this.yAxisFormat = d3_timeFormat(this.yAxisFormatString);\n        break;\n    }\n\n    switch (this.legendLabelFormatType) {\n      case 'number':\n        this.legendLabelFormat = d3_format(this.legendLabelFormatString);\n        break;\n      case 'time':\n        this.legendLabelFormat = d3_timeFormat(this.legendLabelFormatString);\n        break;\n      default:\n        this.legendLabelFormat = null;\n        break;\n    }\n\n    switch (this.tooltipLabelFormatType) {\n      case 'number':\n        this.tooltipLabelFormat = d3_format(this.tooltipLabelFormatString);\n        break;\n      case 'time':\n        this.tooltipLabelFormat = d3_timeFormat(this.tooltipLabelFormatString);\n        break;\n      default:\n        this.tooltipLabelFormat = null;\n        break;\n    }\n\n    switch (this.tooltipValueFormatType) {\n      case 'number':\n        this.tooltipValueFormat = d3_format(this.tooltipValueFormatString);\n        break;\n      case 'time':\n        this.tooltipValueFormat = d3_timeFormat(this.tooltipValueFormatString);\n        break;\n      default:\n        this.tooltipValueFormat = null;\n    }\n\n    // defaults for all chart types\n    this.hideGrayBars = false;\n    this.hideXAxis = false;\n    this.hideYAxis = false;\n    this.hideXAxisZero = false;\n    this.hideYAxisZero = false;\n    this.hideXGrid = false;\n    this.hideYGrid = false;\n    this.hideXAxisDomain = false;\n    this.hideYAxisDomain = false;\n    this.hideTooltip = false;\n    this.hideXAxisTicks = false;\n    this.hideYAxisTicks = false;\n    this.xAxisTickSize = 8;\n    this.xAxisTickSizeOuter = 0;\n    this.yAxisTickSize = 8;\n    this.yAxisTickSizeOuter = 0;\n    this.hideTooltipLabel = false;\n\n    if (this.type !== 'debug') {\n      // set type defaults\n      switch (this.type) {\n        case 'low':\n          this.hideGrayBars = true;\n          this.hideXAxis = !this.hideLegend;\n          this.hideXAxisTicks = true;\n          this.hideXGrid = true;\n          this.hideYAxisDomain = false;\n          this.hideYAxisTicks = true;\n          this.legendPosition = 'bottom';\n          this.hideTooltipLabel = true;\n          break;\n\n        case 'medium':\n          this.hideXAxisDomain = true;\n          this.hideXAxis = !this.hideLegend;\n          this.hideXGrid = true;\n          this.hideXAxisTicks = true;\n          this.hideYAxisDomain = true;\n          this.hideYAxisTicks = true;\n          this.hideYGrid = true;\n          this.hideTooltipLabel = true;\n          break;\n\n        case 'high':\n          this.hideXAxis = true;\n          this.hideXAxisDomain = true;\n          this.hideXGrid = true;\n          this.hideYAxisDomain = true;\n          this.hideYAxisTicks = true;\n          this.hideYGrid = true;\n          this.hideLegend = true;\n          this.hideTooltipLabel = false;\n          break;\n      }\n\n      // single series overrides\n      if (this.singleSeries) {\n        this.hideLegend = true;\n        this.hideXAxis = true;\n        this.hideXGrid = true;\n        this.hideTooltipLabel = false;\n      }\n    }\n\n    // adjust margin if xAxis hidden\n    if (this.hideXAxis) this.margin.bottom = 10; // need small margin for yAxis with 0 tick label\n\n    if (!this.hideLegend && this.legendPosition === 'right') {\n      this.width = +this.width - +this.legendWidth;\n    }\n\n    // create the chart\n    this.chart = d3_select(this._element.nativeElement).attr('aria-hidden', 'true');\n\n    // create chart svg\n    this.svg = this.chart\n      .append('svg')\n      .attr('width', +this.width)\n      .attr('height', +this.height + this.margin.top + this.margin.bottom)\n      .attr('class', 'img-fluid')\n      .attr('preserveAspectRatio', 'xMinYMin meet')\n      .attr(\n        'viewBox',\n        `-${this.margin.left} -${this.margin.top} ${+this.width} ${+this.height + this.margin.top + this.margin.bottom}`\n      );\n\n    // build color ranges\n    this.colorRange = d3_scaleOrdinal().range(\n      this._dataviz.createGradientDefs(this.svg, this.singleSeries, this.theme)\n    );\n\n    // X AXIS\n    this.xAxisScale = d3_scaleBand()\n      .domain(this.data.map(d => d.label))\n      .rangeRound([0, this.width - this.margin.left])\n      .align(0);\n\n    // add padding to the scale for gray bars\n    !this.hideGrayBars\n      ? this.xAxisScale.paddingInner(0.1).paddingOuter(0)\n      : this.xAxisScale.paddingInner(0).paddingOuter(0);\n\n    this.xAxisCall = d3_axisBottom(this.xAxisScale)\n      .tickSize(this.xAxisTickSize)\n      .tickSizeOuter(this.xAxisTickSizeOuter)\n      .tickFormat(this.xAxisFormatter);\n\n    this.xAxis = this.svg\n      .append('g')\n      .attr('class', 'axis axis-x')\n      .attr('transform', `translate(0, ${this.height})`)\n      .classed('axis-hidden', this.hideXAxis)\n      .classed('axis-zero-hidden', this.hideXAxisZero)\n      .classed('axis-domain-hidden', this.hideXAxisDomain)\n      .classed('axis-ticks-hidden', this.hideXAxisTicks)\n      .call(this.xAxisCall);\n\n    // X GRIDLINES\n    if (!this.hideXGrid) {\n      this.xGridCall = d3_axisBottom(this.xAxisScale).tickSize(-this.height);\n\n      this.xGrid = this.svg\n        .append('g')\n        .attr('class', 'grid grid-x')\n        .classed('grid-zero-hidden', this.hideXAxisZero)\n        .attr('transform', `translate(0, ${this.height})`)\n        .call(this.xGridCall);\n    }\n\n    // Y AXIS\n    this.yAxisScale = d3_scaleLinear()\n      .domain([\n        d3_min(this.data, d => d.value - d.value * +this.yAxisMinBuffer),\n        d3_max(this.data, d => d.value + d.value * +this.yAxisMaxBuffer)\n      ])\n      .nice()\n      .rangeRound([this.height, 0]);\n\n    this.yAxisCall = d3_axisLeft(this.yAxisScale)\n      .ticks(this.yAxisTicks)\n      .tickSize(this.yAxisTickSize)\n      .tickSizeOuter(this.yAxisTickSizeOuter)\n      .tickFormat(this.yAxisFormatter);\n\n    this.yAxis = this.svg\n      .append('g')\n      .attr('class', 'axis axis-y')\n      .classed('axis-hidden', this.hideYAxis)\n      .classed('axis-zero-hidden', this.hideYAxisZero)\n      .classed('axis-domain-hidden', this.hideYAxisDomain)\n      .classed('axis-ticks-hidden', this.hideYAxisTicks)\n      .call(this.yAxisCall);\n\n    // Y GRIDLINES\n    if (!this.hideYGrid) {\n      this.yGridCall = d3_axisLeft(this.yAxisScale)\n        .ticks(this.yAxisTicks)\n        .tickSize(-this.width + this.margin.left + this.margin.right);\n\n      this.yGrid = this.svg\n        .append('g')\n        .attr('class', 'grid grid-y')\n        .classed('grid-zero-hidden', this.hideYAxisZero)\n        .attr('transform', `translate(0, 0)`)\n        .call(this.yGridCall);\n    }\n\n    // Y THRESHOLD\n    if (this.threshold) {\n      this.yThreshold = this.svg\n        .append('line')\n        .attr('class', 'threshold')\n        .attr('x2', +this.width)\n        .attr('transform', `translate(0,  ${this.yAxisScale(+this.threshold)})`);\n    }\n\n    // Y AVERAGE\n    if (this.average) {\n      this.yAverage = this.svg\n        .append('line')\n        .attr('class', 'average')\n        .attr('x2', +this.width)\n        .attr('transform', `translate(0,  ${this.yAxisScale(+this.average)})`);\n    }\n\n    // TOOLTIP\n    if (!this.hideTooltip) {\n      this.tooltip = d3_select('body')\n        .append('div')\n        .attr('class', 'pbds-tooltip south')\n        .style('opacity', 0)\n        .attr('aria-hidden', 'true'); // hide tooltip for accessibility\n    }\n\n    // add legend classes\n    if (!this.hideLegend) {\n      this.chart.classed('pbds-chart-legend-bottom', this.legendPosition === 'bottom' ? true : false);\n      this.chart.append('ul').attr('class', `legend legend-${this.legendPosition}`);\n    }\n\n    this.updateChart();\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (changes.data && !changes.data.firstChange) {\n      this.updateChart();\n    }\n  }\n\n  ngOnDestroy() {\n    if (this.tooltip) this.tooltip.remove();\n  }\n\n  updateChart = () => {\n    let group;\n    let groupEnter;\n\n    // update the xScale\n    this.xAxisScale.domain(this.data.map(d => d.label));\n\n    // update the yScale\n    this.yAxisScale\n      .domain([\n        d3_min(this.data, d => d.value - d.value * +this.yAxisMinBuffer),\n        d3_max(this.data, d => d.value + d.value * +this.yAxisMaxBuffer)\n      ])\n      .rangeRound([this.height, 0])\n      .nice();\n\n    this.xAxis\n      .transition()\n      .duration(1000)\n      .call(this.xAxisCall);\n\n    this.yAxis\n      .transition()\n      .duration(1000)\n      .call(this.yAxisCall);\n\n    // update the grids\n    if (!this.hideXGrid) {\n      this.xGrid\n        .transition()\n        .duration(1000)\n        .call(this.xGridCall);\n    }\n\n    if (!this.hideYGrid) {\n      this.yGrid\n        .transition()\n        .duration(1000)\n        .call(this.yGridCall);\n    }\n\n    if (!this.hideGrayBars) {\n      // rebind data to groups\n      group = this.svg.selectAll('.bar-group').data(this.data);\n\n      // remove bars\n      // add bars on enter\n      group\n        .exit()\n        .transition()\n        .attr('pointer-events', 'none')\n        .remove();\n\n      // update gray bars\n      group\n        .select('.gray-bar')\n        .transition()\n        .duration(1000)\n        .attr('x', d => this.xAxisScale(d.label))\n        .attr('width', this.xAxisScale.bandwidth());\n\n      // update the existing bars\n      group\n        .select('.bar')\n        .attr('pointer-events', 'none')\n        .transition()\n        .duration(1000)\n        .attr('x', d => this.xAxisScale(d.label) + this.xAxisScale.bandwidth() / 4)\n        .attr('width', this.xAxisScale.bandwidth() / 2)\n        .attr('height', d => this.height - this.yAxisScale(d.value))\n        .attr('y', d => this.yAxisScale(d.value))\n        .transition()\n        .attr('pointer-events', 'auto');\n\n      // add group on enter\n      groupEnter = group\n        .enter()\n        .append('g')\n        .attr('class', 'bar-group');\n\n      // add gray bars on enter\n      groupEnter\n        .append('rect')\n        .attr('class', 'gray-bar')\n        .attr('rx', 0)\n        .attr('height', 0)\n        .attr('x', d => this.xAxisScale(d.label))\n        .attr('width', this.xAxisScale.bandwidth())\n        .transition()\n        .attr('height', this.height)\n        .attr('width', this.xAxisScale.bandwidth());\n\n      // add bars on enter\n      groupEnter\n        .append('rect')\n        .attr('class', 'bar')\n        .attr('rx', 2)\n        .attr('fill', d => `url(${this._location.path()}#gradient-${this.colorRange(d.label).substr(1)})`) // removes hash to prevent safari bug;\n        .attr('x', d => this.xAxisScale(d.label) + this.xAxisScale.bandwidth() / 4)\n        .attr('width', this.xAxisScale.bandwidth() / 2)\n        .attr('y', this.height)\n        .attr('height', 0)\n        .attr('pointer-events', 'none')\n        .transition()\n        .duration(1000)\n        .attr('y', d => this.yAxisScale(d.value))\n        .attr('height', d => this.height - this.yAxisScale(d.value))\n        .attr('data-color', d => this.colorRange(d.label))\n        .transition()\n        .attr('pointer-events', 'auto');\n\n      groupEnter\n        .select('.bar')\n        .on('mouseover', (data, index, nodes) => this.barMouseOver(d3_event, data, index, nodes))\n        .on('mouseout', (data, index, nodes) => this.barMouseOut())\n        .on('click', (data, index, nodes) => this.barMouseClick(d3_event, data, index, nodes));\n    } else {\n      // rebind data to groups\n      group = this.svg.selectAll('.bar-group').data(this.data);\n\n      // remove bars\n      group\n        .exit()\n        .transition()\n        .attr('pointer-events', 'none')\n        .remove();\n\n      // update the existing bars\n      group\n        .select('.bar')\n        .attr('x', d => this.xAxisScale(d.label) + this.xAxisScale.bandwidth() / 5.5)\n        .attr('width', this.xAxisScale.bandwidth() / 1.5)\n        .attr('pointer-events', 'none')\n        .transition()\n        .duration(1000)\n        .attr('y', d => this.yAxisScale(d.value))\n        .attr('height', d => this.height - this.yAxisScale(d.value))\n        .transition()\n        .attr('pointer-events', 'auto');\n\n      // add group on enter\n      groupEnter = group\n        .enter()\n        .append('g')\n        .attr('class', 'bar-group');\n\n      // add bars on enter\n      groupEnter\n        .append('rect')\n        .attr('class', 'bar')\n        .attr('rx', 2)\n        .attr('fill', d => `url(${this._location.path()}#gradient-${this.colorRange(d.label).substr(1)})`) // removes hash to prevent safari bug;\n        .attr('x', d => this.xAxisScale(d.label) + this.xAxisScale.bandwidth() / 5.5)\n        .attr('width', this.xAxisScale.bandwidth() / 1.5)\n        .attr('y', this.height)\n        .attr('height', 0)\n        .attr('pointer-events', 'none')\n        .transition()\n        .duration(1000)\n        .attr('y', d => this.yAxisScale(d.value))\n        .attr('height', d => this.height - this.yAxisScale(d.value))\n        .attr('data-color', d => this.colorRange(d.label))\n        .transition()\n        .attr('pointer-events', 'auto');\n\n      groupEnter\n        .select('.bar')\n        .on('mouseover', (data, index, nodes) => this.barMouseOver(d3_event, data, index, nodes))\n        .on('mouseout', () => this.barMouseOut())\n        .on('click', (data, index, nodes) => this.barMouseClick(d3_event, data, index, nodes));\n    }\n\n    if (!this.hideLegend) {\n      const legendItem = this.chart\n        .select('.legend')\n        .selectAll('.legend-item')\n        .data(this.data);\n\n      legendItem.exit().remove();\n\n      // update existing items\n      legendItem.select('.legend-label').html(d => {\n        // return this.legendLabelFormat === null ? d.label : this.legendLabelFormat(d.label);\n        switch (this.legendLabelFormatType) {\n          case 'number':\n            return this.legendLabelFormat(d.label);\n\n          case 'time':\n            const parsedTime = d3_isoParse(d.label);\n            return this.legendLabelFormat(parsedTime);\n\n          default:\n            return d.label;\n        }\n      });\n\n      // legend items on enter\n      const enterLegendItem = legendItem\n        .enter()\n        .append('li')\n        .attr('class', 'legend-item');\n\n      enterLegendItem\n        .append('span')\n        .attr('class', 'legend-key')\n        .style('background-color', d => this.colorRange(d.label));\n\n      enterLegendItem\n        .append('span')\n        .attr('class', 'legend-label')\n        .html(d => {\n          // return this.legendLabelFormat === null ? d.label : this.legendLabelFormat(d.label);\n          switch (this.legendLabelFormatType) {\n            case 'number':\n              return this.legendLabelFormat(d.label);\n\n            case 'time':\n              const parsedTime = d3_isoParse(d.label);\n              return this.legendLabelFormat(parsedTime);\n\n            default:\n              return d.label;\n          }\n        });\n\n      enterLegendItem\n        .on('mouseover', (data, index, nodes) => this.legendMouseOver(d3_event, data, index, nodes))\n        .on('mouseout', () => this.legendMouseOut())\n        .on('click', (data, index, nodes) => this.legendMouseClick(d3_event, data, index, nodes));\n    }\n\n    if (this.threshold) {\n      this.yThreshold\n        .raise()\n        .transition()\n        .duration(1000)\n        .attr('transform', `translate(0,  ${this.yAxisScale(+this.threshold)})`);\n    }\n\n    if (this.average) {\n      this.yAverage\n        .raise()\n        .transition()\n        .duration(1000)\n        .attr('transform', `translate(0,  ${this.yAxisScale(+this.average)})`);\n    }\n  };\n\n  barMouseOver = (event, data, index, nodes) => {\n    this.chart\n      .selectAll('.bar-group')\n      .filter((d, i) => i !== index)\n      .classed('inactive', true);\n\n    const bar = this.chart\n      .selectAll('.bar-group')\n      .filter((d, i) => i === index)\n      .select('.bar');\n\n    const barColor = bar.attr('data-color');\n\n    bar.style('fill', () => barColor);\n\n    this.chart\n      .selectAll('.legend-item')\n      .filter((d, i) => i !== index)\n      .classed('inactive', true);\n\n    this.tooltipShow(data, nodes.filter((d, i) => i === index));\n\n    this.hovered.emit({ event, data });\n  };\n\n  barMouseOut = () => {\n    this.chart\n      .selectAll('.bar-group')\n      .classed('inactive', false)\n      .select('.bar')\n      .style('fill', null);\n\n    this.chart.selectAll('.legend-item').classed('inactive', false);\n\n    this.tooltipHide();\n  };\n\n  barMouseClick = (event, data, index, nodes) => {\n    this.clicked.emit({ event, data });\n  };\n\n  legendMouseOver = (event, data, index, nodes) => {\n    this.chart\n      .selectAll('.legend-item')\n      .filter((d, i) => i !== index)\n      .classed('inactive', true);\n\n    this.chart\n      .selectAll('.bar-group')\n      .filter((d, i) => i !== index)\n      .classed('inactive', true);\n\n    const bar = this.chart\n      .selectAll('.bar-group')\n      .filter((d, i) => i === index)\n      .select('.bar');\n\n    const barColor = bar.attr('data-color');\n\n    bar.style('fill', () => barColor);\n\n    this.tooltipShow(data, this.chart.selectAll('.bar').filter((d, i) => i === index)._groups[0]); // TODO: find better way than using _groups\n\n    this.hovered.emit({ event, data });\n  };\n\n  legendMouseOut = () => {\n    this.chart.selectAll('.legend-item').classed('inactive', false);\n\n    this.chart\n      .selectAll('.bar-group')\n      .classed('inactive', false)\n      .select('.bar')\n      .style('fill', null);\n\n    this.tooltipHide();\n  };\n\n  legendMouseClick = (event, data, index, nodes) => {\n    this.clicked.emit({ event, data });\n  };\n\n  private tooltipShow = (data, node) => {\n    const dimensions = node[0].getBoundingClientRect();\n    const scroll = this._scroll.getScrollPosition();\n    let label;\n\n    switch (this.tooltipLabelFormatType) {\n      case 'number':\n        label = this.tooltipLabelFormat(data.label);\n        break;\n\n      case 'time':\n        const parsedTime = d3_isoParse(data.label);\n        label = this.tooltipLabelFormat(parsedTime);\n        break;\n\n      default:\n        label = data.label;\n    }\n    const value =\n      this.tooltipValueFormat === null\n        ? `<div class=\"tooltip-value\">${data.value}</div>`\n        : `<div class=\"tooltip-value\">${this.tooltipValueFormat(data.value)}</div>`;\n\n    this.tooltip.html(\n      `\n        ${this.hideTooltipLabel ? '' : `${label}`}\n        ${value}\n      `\n    );\n\n    const tooltipOffsetWidth = +this.tooltip.node().offsetWidth / 2;\n    const tooltipOffsetHeight = +this.tooltip.node().offsetHeight + 8;\n\n    this.tooltip.style('top', `${+scroll[1] + +dimensions.top - tooltipOffsetHeight}px`); //\n    this.tooltip.style('left', `${+scroll[0] + +dimensions.left - tooltipOffsetWidth + +dimensions.width / 2}px`);\n    this.tooltip.style('opacity', 1);\n  };\n\n  private tooltipHide = () => {\n    this.tooltip.style('opacity', 0);\n  };\n\n  private xAxisFormatter = item => {\n    switch (this.xAxisFormatType) {\n      case 'number':\n        return this.xAxisFormat(item);\n\n      case 'time':\n        const parseDate = d3_isoParse(item);\n        return this.xAxisFormat(parseDate);\n\n      default:\n        return item;\n    }\n  };\n\n  private yAxisFormatter = item => {\n    switch (this.yAxisFormatType) {\n      case 'number':\n        return this.yAxisFormat(item);\n\n      case 'time':\n        const parseDate = d3_isoParse(item);\n        return this.yAxisFormat(parseDate);\n\n      default:\n        return item;\n    }\n  };\n}\n","import {\n  Component,\n  OnInit,\n  OnChanges,\n  Input,\n  Output,\n  EventEmitter,\n  ElementRef,\n  HostBinding,\n  OnDestroy,\n  SimpleChanges,\n  ChangeDetectionStrategy\n} from '@angular/core';\n\nimport { ViewportScroller, Location } from '@angular/common';\n\nimport {\n  select as d3_select,\n  isoParse as d3_isoParse,\n  isoFormat as d3_isoFormat,\n  timeFormat as d3_timeFormat,\n  format as d3_format,\n  scaleOrdinal as d3_scaleOrdinal,\n  scaleTime as d3_scaleTime,\n  line as d3_line,\n  scaleLinear as d3_scaleLinear,\n  extent as d3_extent,\n  min as d3_min,\n  max as d3_max,\n  axisBottom as d3_axisBottom,\n  axisLeft as d3_axisLeft,\n  event as d3_event,\n  curveCatmullRom as d3_curveCatmullRom,\n  mouse as d3_mouse,\n  bisectLeft as d3_bisectLeft,\n  area as d3_area\n} from 'd3';\n\nimport { PbdsDatavizService } from './dataviz.service';\nimport { PbdsDatavizLine } from './dataviz.interfaces';\n\n@Component({\n  selector: 'pbds-dataviz-line',\n  template: ``,\n  styles: [],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class PbdsDatavizLineComponent implements OnInit, OnDestroy, OnChanges {\n  @HostBinding('class.pbds-chart')\n  chartClass = true;\n\n  @HostBinding('class.pbds-chart-line')\n  lineClass = true;\n\n  @Input()\n  data: PbdsDatavizLine;\n\n  @Input()\n  width = 306;\n\n  @Input()\n  height = 400;\n\n  @Input()\n  type: 'medium' | 'high' | 'debug' = 'medium'; // debug to show all chart options\n\n  @Input()\n  area = false;\n\n  @Input()\n  xAxisFormatString = '';\n\n  @Input()\n  xAxisTicks = 6;\n\n  @Input()\n  yAxisFormatString = '';\n\n  @Input()\n  yAxisTicks = 5;\n\n  @Input()\n  yAxisMinBuffer = 0.01;\n\n  @Input()\n  yAxisMaxBuffer = 0.01;\n\n  @Input()\n  hideXGrid = true;\n\n  @Input()\n  hideYGrid = true;\n\n  @Input()\n  hideLegend = false;\n\n  @Input()\n  legendWidth = 105 + 28; // hardcoded legend width + left margin, do not document until feedback\n\n  @Input()\n  legendPosition: 'right' | 'bottom' = 'right';\n\n  @Input()\n  legendLabelFormatType: 'number' | 'time' = null;\n\n  @Input()\n  legendLabelFormatString = '';\n\n  @Input()\n  tooltipHeadingFormatString = '';\n\n  @Input()\n  tooltipLabelFormatType: 'number' | 'time' = null;\n\n  @Input()\n  tooltipLabelFormatString = '';\n\n  @Input()\n  tooltipValueFormatType: 'number' | 'time' = null;\n\n  @Input()\n  tooltipValueFormatString = '';\n\n  @Input()\n  marginTop = 10; // hardcoded on purpose, do not document until feedback\n\n  @Input()\n  marginRight = 20; // hardcoded on purpose, do not document until feedback\n\n  @Input()\n  marginBottom = 30; // hardcoded on purpose, do not document until feedback\n\n  @Input()\n  marginLeft = 55; // hardcoded on purpose, do not document until feedback\n\n  @Input()\n  theme;\n\n  @Output()\n  hovered: EventEmitter<object> = new EventEmitter<object>();\n\n  @Output()\n  clicked: EventEmitter<object> = new EventEmitter<object>();\n\n  @Output()\n  tooltipHovered: EventEmitter<object> = new EventEmitter<object>();\n\n  @Output()\n  tooltipClicked: EventEmitter<object> = new EventEmitter<object>();\n\n  private chart;\n  private svg;\n  private mouserect;\n  private tooltipLine;\n  private margin;\n  private d3line;\n  private d3area;\n  private lineWidth;\n  private lineCurved;\n  private linePoints;\n  private colorRange;\n  private xAxisScale;\n  private xAxisCall;\n  private xAxis;\n  private xAxisFormat;\n  private yAxisScale;\n  private yAxisCall;\n  private yAxis;\n  private yAxisFormat;\n  private xGrid;\n  private xGridCall;\n  private yGrid;\n  private yGridCall;\n  private xAxisTickSize: number;\n  private xAxisTickSizeOuter: number;\n  private yAxisTickSize: number;\n  private yAxisTickSizeOuter: number;\n  private hideXAxis: boolean;\n  private hideYAxis: boolean;\n  private hideXAxisDomain: boolean;\n  private hideYAxisDomain: boolean;\n  private hideXAxisZero: boolean;\n  private hideYAxisZero: boolean;\n  private hideXAxisTicks: boolean;\n  private hideYAxisTicks: boolean;\n  private legendLabelFormat;\n  private tooltip;\n  private hideTooltip: boolean;\n  private tooltipHeadingFormat;\n  private tooltipValueFormat;\n  private tooltipLabelFormat;\n  private mousedata;\n\n  constructor(\n    private _dataviz: PbdsDatavizService,\n    private _element: ElementRef,\n    private _scroll: ViewportScroller,\n    private _location: Location\n  ) {}\n\n  ngOnInit() {\n    this.margin = {\n      top: +this.marginTop,\n      right: +this.marginRight,\n      bottom: +this.marginBottom,\n      left: +this.marginLeft\n    };\n\n    this.xAxisFormat = d3_timeFormat(this.xAxisFormatString);\n\n    this.yAxisFormat = d3_format(this.yAxisFormatString);\n\n    switch (this.legendLabelFormatType) {\n      case 'number':\n        this.legendLabelFormat = d3_format(this.legendLabelFormatString);\n        break;\n      case 'time':\n        this.legendLabelFormat = d3_timeFormat(this.legendLabelFormatString);\n        break;\n      default:\n        this.legendLabelFormat = null;\n        break;\n    }\n\n    this.tooltipHeadingFormat = d3_timeFormat(this.tooltipHeadingFormatString);\n\n    switch (this.tooltipLabelFormatType) {\n      case 'number':\n        this.tooltipLabelFormat = d3_format(this.tooltipLabelFormatString);\n        break;\n      case 'time':\n        this.tooltipLabelFormat = d3_timeFormat(this.tooltipLabelFormatString);\n        break;\n      default:\n        this.tooltipLabelFormat = null;\n        break;\n    }\n\n    switch (this.tooltipValueFormatType) {\n      case 'number':\n        this.tooltipValueFormat = d3_format(this.tooltipValueFormatString);\n        break;\n      case 'time':\n        this.tooltipValueFormat = d3_timeFormat(this.tooltipValueFormatString);\n        break;\n      default:\n        this.tooltipValueFormat = null;\n    }\n\n    // defaults for all chart types\n    this.lineWidth = 3;\n    this.lineCurved = true;\n    this.linePoints = true;\n    this.hideXAxis = false;\n    this.hideYAxis = false;\n    this.hideXAxisZero = false;\n    this.hideYAxisZero = false;\n    this.hideXAxisDomain = false;\n    this.hideYAxisDomain = false;\n    this.hideTooltip = false;\n    this.hideXAxisTicks = false;\n    this.hideYAxisTicks = false;\n    this.xAxisTickSize = 8;\n    this.xAxisTickSizeOuter = 0;\n    this.yAxisTickSize = 8;\n    this.yAxisTickSizeOuter = 0;\n\n    if (this.type !== 'debug') {\n      // set type defaults\n      switch (this.type) {\n        case 'medium':\n          this.hideXAxisTicks = true;\n          this.hideYAxisTicks = true;\n          break;\n\n        case 'high':\n          this.lineWidth = 2;\n          this.lineCurved = false;\n          this.linePoints = false;\n          this.hideXAxisTicks = true;\n          this.hideYAxisTicks = true;\n          this.hideXGrid = false;\n          this.hideYGrid = false;\n          break;\n      }\n    }\n\n    // adjust margin if xAxis hidden\n    if (this.hideXAxis) this.margin.bottom = 10; // need small margin for yAxis with 0 tick label\n\n    if (!this.hideLegend && this.legendPosition === 'right') {\n      this.width = +this.width - +this.legendWidth;\n    }\n\n    // define line\n    this.d3line = d3_line()\n      .x((d: any, i) => this.xAxisScale(d3_isoParse(this.data.dates[i])))\n      .y((d: any) => this.yAxisScale(d));\n\n    // define line curve\n    if (this.lineCurved) {\n      this.d3line.curve(d3_curveCatmullRom.alpha(0.5));\n    }\n\n    // define area\n    if (this.area) {\n      this.d3area = d3_area()\n        .x((d: any, i) => this.xAxisScale(d3_isoParse(this.data.dates[i])))\n        .y0(this.height)\n        .y1((d: any, i) => this.yAxisScale(d));\n\n      if (this.lineCurved) {\n        this.d3area.curve(d3_curveCatmullRom.alpha(0.5));\n      }\n    }\n\n    // create the chart\n    this.chart = d3_select(this._element.nativeElement).attr('aria-hidden', 'true');\n\n    // create chart svg\n    this.svg = this.chart\n      .append('svg')\n      .attr('width', +this.width + this.margin.right)\n      .attr('height', +this.height + this.margin.top + this.margin.bottom)\n      .attr('class', 'img-fluid')\n      .attr('preserveAspectRatio', 'xMinYMin meet')\n      .attr(\n        'viewBox',\n        `-${this.margin.left} -${this.margin.top} ${+this.width + this.margin.right} ${+this.height +\n          this.margin.top +\n          this.margin.bottom}`\n      );\n\n    // add rectangle to capture mouse\n    this.mouserect = this.svg\n      .append('rect')\n      .attr('width', this.width - this.margin.left - this.margin.right)\n      .attr('height', this.height)\n      .attr('class', 'mouserect')\n      .on('mousemove', (data, index, nodes) => this.mouserectMouseMove(d3_event, index, nodes))\n      .on('mouseout', (data, index, nodes) => this.mouserectMouseOut(d3_event, index, nodes))\n      .on('click', (data, index, nodes) => this.mouserectMouseClick());\n\n    this.tooltipLine = this.svg\n      .append('line')\n      .attr('y1', 0)\n      .attr('y2', this.height)\n      .attr('class', 'tooltip-line');\n\n    // define color range\n    this.colorRange = d3_scaleOrdinal().range(this._dataviz.getColors(false, this.theme));\n\n    // add glow def\n    this._dataviz.createGlowFilter(this.svg);\n\n    // X AXIS\n    this.xAxisScale = d3_scaleTime()\n      .domain(\n        d3_extent(this.data.dates, (d: any, i) => {\n          return d3_isoParse(d);\n        })\n      )\n      .range([0, this.width - this.margin.left - this.margin.right]);\n\n    this.xAxisCall = d3_axisBottom(this.xAxisScale)\n      .ticks(+this.xAxisTicks)\n      .tickSize(this.xAxisTickSize)\n      .tickSizeOuter(this.xAxisTickSizeOuter)\n      .tickFormat(this.xAxisFormatter);\n\n    this.xAxis = this.svg\n      .append('g')\n      .attr('class', 'axis axis-x')\n      .attr('transform', `translate(0, ${this.height})`) //${-this.margin.right / 2}\n      .classed('axis-hidden', this.hideXAxis)\n      .classed('axis-zero-hidden', this.hideXAxisZero)\n      .classed('axis-domain-hidden', this.hideXAxisDomain)\n      .classed('axis-ticks-hidden', this.hideXAxisTicks)\n      .call(this.xAxisCall);\n\n    // X GRIDLINES\n    if (!this.hideXGrid) {\n      this.xGridCall = d3_axisBottom(this.xAxisScale).tickSize(-this.height);\n\n      this.xGrid = this.svg\n        .append('g')\n        .attr('class', 'grid grid-x')\n        .classed('grid-zero-hidden', this.hideXAxisZero)\n        .attr('transform', `translate(0, ${this.height})`) //${-this.margin.right / 2}\n        .call(this.xGridCall);\n    }\n\n    // Y AXIS\n    this.yAxisScale = d3_scaleLinear()\n      .domain([\n        d3_min(this.data.series, (d: any, i) => {\n          const minVal = +d3_min(d.values);\n          return minVal - minVal * +this.yAxisMinBuffer;\n        }),\n        d3_max(this.data.series, (d: any, i) => {\n          const maxVal = +d3_max(d.values);\n          return maxVal + maxVal * this.yAxisMaxBuffer;\n        })\n      ])\n      .nice()\n      .range([this.height, 0]);\n\n    this.yAxisCall = d3_axisLeft(this.yAxisScale)\n      .ticks(this.yAxisTicks)\n      .tickSize(this.yAxisTickSize)\n      .tickSizeOuter(this.yAxisTickSizeOuter)\n      .tickFormat(this.yAxisFormatter);\n\n    this.yAxis = this.svg\n      .append('g')\n      .attr('class', 'axis axis-y')\n      .classed('axis-hidden', this.hideYAxis)\n      .classed('axis-zero-hidden', this.hideYAxisZero)\n      .classed('axis-domain-hidden', this.hideYAxisDomain)\n      .classed('axis-ticks-hidden', this.hideYAxisTicks)\n      .call(this.yAxisCall);\n\n    // Y GRIDLINES\n    if (!this.hideYGrid) {\n      this.yGridCall = d3_axisLeft(this.yAxisScale)\n        .ticks(this.yAxisTicks)\n        .tickSize(-this.width + this.margin.left + this.margin.right);\n\n      this.yGrid = this.svg\n        .append('g')\n        .attr('class', 'grid grid-y')\n        .classed('grid-zero-hidden', this.hideYAxisZero)\n        .attr('transform', `translate(0, 0)`)\n        .call(this.yGridCall);\n    }\n\n    // TOOLTIP\n    if (!this.hideTooltip) {\n      this.tooltip = d3_select('body')\n        .append('div')\n        .attr('class', 'pbds-tooltip west')\n        .style('opacity', 0)\n        .attr('aria-hidden', 'true'); // hide tooltip for accessibility\n\n      // tooltip header\n      this.tooltip.append('div').attr('class', 'tooltip-header');\n\n      // tooltip table\n      const tooltipTable = this.tooltip.append('table').attr('class', 'tooltip-table text-left w-100');\n\n      const tooltipTableTbody = tooltipTable.append('tbody');\n\n      tooltipTableTbody\n        .selectAll('tr')\n        .data(this.data)\n        .enter()\n        .append('tr');\n    }\n\n    // add legend classes\n    if (!this.hideLegend) {\n      this.chart.classed('pbds-chart-legend-bottom', this.legendPosition === 'bottom' ? true : false);\n      this.chart.append('ul').attr('class', `legend legend-${this.legendPosition}`);\n    }\n\n    this.updateChart();\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (changes.data && !changes.data.firstChange) {\n      this.updateChart();\n    }\n  }\n\n  ngOnDestroy() {\n    if (this.tooltip) this.tooltip.remove();\n  }\n\n  updateChart = () => {\n    this.mouserect.data(this.data);\n\n    // update the xScale\n    this.xAxisScale.domain(\n      d3_extent(this.data.dates, (d: any, i) => {\n        return d3_isoParse(d);\n      })\n    );\n\n    // update the yScale\n    this.yAxisScale\n      .domain([\n        d3_min(this.data.series, (d: any, i) => {\n          const minVal = +d3_min(d.values);\n          return minVal - minVal * +this.yAxisMinBuffer;\n        }),\n        d3_max(this.data.series, (d: any, i) => {\n          const maxVal = +d3_max(d.values);\n          return maxVal + maxVal * this.yAxisMaxBuffer;\n        })\n      ])\n      .nice();\n\n    this.xAxis\n      .transition()\n      .duration(1000)\n      .call(this.xAxisCall);\n\n    this.yAxis\n      .transition()\n      .duration(1000)\n      .call(this.yAxisCall);\n\n    // update the grids\n    if (!this.hideXGrid) {\n      this.xGrid\n        .transition()\n        .duration(1000)\n        .call(this.xGridCall);\n    }\n\n    if (!this.hideYGrid) {\n      this.yGrid\n        .transition()\n        .duration(1000)\n        .call(this.yGridCall);\n    }\n\n    const group = this.svg.selectAll('.line-group').data(this.data.series);\n\n    // remove lines\n    group.exit().remove();\n\n    // update existing\n    group\n      .select('path.line')\n      .transition()\n      .duration(1000)\n      .attr('d', d => this.d3line(d.values));\n\n    if (this.area) {\n      group\n        .select('path.area')\n        .transition()\n        .duration(1000)\n        .attr('d', d => this.d3area(d.values));\n    }\n\n    group\n      .selectAll('circle')\n      .data(d => d.values)\n      .transition()\n      .duration(1000)\n      .attr('cx', (d, i) => this.xAxisScale(d3_isoParse(this.data.dates[i])))\n      .attr('cy', d => this.yAxisScale(d));\n\n    // add group on enter\n    const groupEnter = group\n      .enter()\n      .append('g')\n      .attr('class', 'line-group');\n\n    // add line on enter\n    const line = groupEnter\n      .append('path')\n      .attr('class', 'line')\n      .style('color', d => this.colorRange(d.label))\n      .style('stroke-width', this.lineWidth)\n      .transition()\n      .duration(1000)\n      .attr('d', data => this.d3line(data.values));\n\n    if (this.area) {\n      groupEnter\n        .append('path')\n        .attr('class', 'area')\n        .attr('d', data => this.d3area(data.values))\n        .style('color', d => this.colorRange(d.label));\n    }\n\n    // add points\n    if (this.linePoints) {\n      const points = groupEnter\n        .append('g')\n        .attr('class', 'points')\n        .style('color', d => this.colorRange(d.label));\n\n      const circles = points.selectAll('circle').data(d => d.values);\n\n      circles\n        .enter()\n        .append('circle')\n        .attr('cx', (d, i) => this.xAxisScale(d3_isoParse(this.data.dates[i])))\n        .attr('cy', d => this.yAxisScale(d))\n        .attr('r', this.lineWidth * 2)\n        .style('stroke-width', this.lineWidth);\n    }\n\n    if (this.type !== 'high') {\n      line.attr('filter', `url(${this._location.path()}#glow)`);\n    }\n\n    if (!this.hideLegend) {\n      const legendItem = this.chart\n        .select('.legend')\n        .selectAll('.legend-item')\n        .data(this.data.series);\n\n      legendItem.exit().remove();\n\n      // update existing items\n      legendItem.select('.legend-label').html(d => {\n        switch (this.legendLabelFormatType) {\n          case 'number':\n            return this.legendLabelFormat(d.label);\n\n          case 'time':\n            const parsedTime = d3_isoParse(d.label);\n            return this.legendLabelFormat(parsedTime);\n\n          default:\n            return d.label;\n        }\n      });\n\n      // legend items on enter\n      const enterLegendItem = legendItem\n        .enter()\n        .append('li')\n        .attr('class', 'legend-item');\n\n      enterLegendItem\n        .append('span')\n        .attr('class', 'legend-key')\n        .style('background-color', d => this.colorRange(d.label));\n\n      enterLegendItem\n        .append('span')\n        .attr('class', 'legend-label')\n        .html(d => {\n          switch (this.legendLabelFormatType) {\n            case 'number':\n              return this.legendLabelFormat(d.label);\n\n            case 'time':\n              const parsedTime = d3_isoParse(d.label);\n              return this.legendLabelFormat(parsedTime);\n\n            default:\n              return d.label;\n          }\n        });\n\n      enterLegendItem\n        .on('mouseover', (data, index, nodes) => this.legendMouseOver(d3_event, data, index, nodes))\n        .on('mouseout', () => this.legendMouseOut())\n        .on('click', (data, index, nodes) => this.legendMouseClick(d3_event, data, index, nodes));\n    }\n\n    if (!this.hideTooltip) {\n      const tooltipItem = this.tooltip\n        .select('.tooltip-table')\n        .selectAll('tr')\n        .data(this.data.series);\n\n      tooltipItem.exit().remove();\n\n      // update existing items\n      tooltipItem.select('.tooltip-label pr-2').html(d => {\n        return this.tooltipHeadingFormat(d.label);\n      });\n\n      // items on enter\n      const entertooltipItem = tooltipItem\n        .enter()\n        .append('tr')\n        .attr('class', 'tooltip-item');\n\n      entertooltipItem\n        .append('td')\n        .style('color', d => this.colorRange(d.label))\n        .append('span')\n        .attr('class', 'pbds-tooltip-key');\n\n      entertooltipItem\n        .append('td')\n        .attr('class', 'tooltip-label pr-2 text-nowrap')\n        .html(d => {\n          return this.tooltipLabelFormatType ? this.tooltipLabelFormat(d.label) : d.label;\n        });\n\n      entertooltipItem\n        .append('td')\n        .attr('class', 'tooltip-value text-right text-nowrap')\n        .html(d => '');\n    }\n\n    this.mouserect.raise();\n  };\n\n  legendMouseOver = (event, data, index, nodes) => {\n    this.chart\n      .selectAll('.legend-item')\n      .filter((d, i) => i !== index)\n      .classed('inactive', true);\n\n    this.chart\n      .selectAll('.line-group')\n      .filter((d, i) => i !== index)\n      .classed('inactive', true);\n\n    const line = this.chart.selectAll('.line-group').filter((d, i) => i === index);\n    line.classed('active', true);\n\n    if (this.linePoints) {\n      const circles = line.selectAll('circle');\n      circles.classed('active', true);\n    }\n\n    this.hovered.emit({ event, data });\n  };\n\n  legendMouseOut = () => {\n    this.chart.selectAll('.legend-item').classed('inactive', false);\n\n    this.chart\n      .selectAll('.line-group')\n      .classed('inactive', false)\n      .classed('active', false);\n\n    if (this.linePoints) {\n      const circles = this.chart.selectAll('circle');\n      circles.classed('active', false);\n    }\n  };\n\n  legendMouseClick = (event, data, index, nodes) => {\n    this.clicked.emit({ event, data });\n  };\n\n  mouserectMouseMove = (event, index, nodes) => {\n    const mouseXDate = this.xAxisScale.invert(d3_mouse(nodes[0])[0]); // return date at mouse x position\n    const leftIndex = d3_bisectLeft(this.data.dates, d3_isoFormat(mouseXDate)); // index of left closest date\n\n    // prevent error for 0 index\n    if (leftIndex === 0) return false;\n\n    const dateLower = new Date(this.data.dates[leftIndex - 1]);\n    const dateUpper = new Date(this.data.dates[leftIndex]);\n    const closestDate = +mouseXDate - +dateLower > +dateUpper - mouseXDate ? dateUpper : dateLower; // date mouse is closest to\n    const closestIndex = this.data.dates.indexOf(d3_isoFormat(closestDate)); // which index the mouse is closest to\n    // console.log(+mouseXDate, leftIndex, +dateLower, +dateUpper, +closestDate, closestIndex);\n\n    const circles = this.svg.selectAll('.line-group').selectAll('circle');\n    circles.filter((d, i) => i === closestIndex).classed('active', true);\n    circles.filter((d, i) => i !== closestIndex).classed('active', false);\n\n    this.tooltipLine\n      .attr('x1', this.xAxisScale(closestDate))\n      .attr('x2', this.xAxisScale(closestDate))\n      .classed('active', true);\n\n    // console.log(this.tooltipLine.node().getBoundingClientRect(), this._scroll.getScrollPosition());\n    this.tooltipShow(this.tooltipLine.node(), closestIndex);\n\n    this.mousedata = {\n      date: closestDate,\n      series: this.data.series.map(d => {\n        return {\n          label: d.label,\n          value: d.values[closestIndex]\n        };\n      })\n    };\n\n    this.tooltipHovered.emit({ event, data: this.mousedata });\n  };\n\n  mouserectMouseOut = (event, index, nodes) => {\n    this.svg.selectAll('circle').classed('active', false);\n    this.tooltipLine.classed('active', false);\n    this.tooltipHide();\n  };\n\n  mouserectMouseClick = () => {\n    this.tooltipClicked.emit({ event, data: this.mousedata });\n  };\n\n  private tooltipShow = (node, closestIndex) => {\n    const scroll = this._scroll.getScrollPosition();\n    const mouserectDimensions = node.getBoundingClientRect();\n    const tooltipOffsetHeight = +this.tooltip.node().offsetHeight;\n    const tooltipDimensions = this.tooltip.node().getBoundingClientRect();\n    const dimensionCalculated = mouserectDimensions.left + tooltipDimensions.width + 8;\n    const clientWidth = document.body.clientWidth - 10;\n    let position;\n\n    // console.log(scroll, mouserectDimensions, tooltipOffsetHeight, tooltipDimensions, dimensionCalculated, clientWidth);\n\n    this.tooltip.select('.tooltip-header').html(d => {\n      const parsedTime = d3_isoParse(this.data.dates[closestIndex]);\n      return this.tooltipHeadingFormat(parsedTime);\n    });\n\n    this.tooltip.selectAll('.tooltip-value').html((d, i) => {\n      return this.tooltipValueFormatType\n        ? this.tooltipValueFormat(this.data.series[i].values[closestIndex])\n        : this.data.series[i].values[closestIndex];\n    });\n\n    // flip the tooltip positions if near the right edge of the screen\n    if (dimensionCalculated > clientWidth) {\n      this.tooltip.classed('east', true);\n      this.tooltip.classed('west', false);\n      position = `${mouserectDimensions.left - tooltipDimensions.width - 8}px`;\n    } else if (dimensionCalculated < clientWidth) {\n      this.tooltip.classed('east', false);\n      this.tooltip.classed('west', true);\n      position = `${mouserectDimensions.left + 8}px`;\n    }\n\n    // console.log('POSITION: ', position, mouserectDimensions);\n\n    // set the tooltip styles\n    this.tooltip.style(\n      'top',\n      `${mouserectDimensions.top + mouserectDimensions.height / 2 - tooltipOffsetHeight / 2 + scroll[1]}px`\n    );\n    this.tooltip.style('left', position);\n    this.tooltip.style('opacity', 1);\n  };\n\n  private tooltipHide = () => {\n    this.tooltip.style('opacity', 0);\n  };\n\n  private xAxisFormatter = item => {\n    const parseDate = d3_isoParse(item);\n    return this.xAxisFormat(parseDate);\n  };\n\n  private yAxisFormatter = item => {\n    return this.yAxisFormat(item);\n  };\n}\n","import { Component, OnInit, Input, ElementRef, HostBinding, OnChanges, SimpleChanges } from '@angular/core';\n\nimport { select as d3_select, arc as d3_arc, interpolate as d3_interpolate, format as d3_format } from 'd3';\n\nimport { PbdsDatavizService } from './dataviz.service';\nimport { PbdsDatavizGauge } from './dataviz.interfaces';\n\n@Component({\n  selector: 'pbds-dataviz-gauge',\n  template: `\n    <div\n      *ngIf=\"!hideLabel\"\n      class=\"gauge-details\"\n      [ngClass]=\"{ halfmoon: type === 'halfmoon', 'gauge-details-small': type === 'halfmoon' }\"\n      [ngStyle]=\"{ 'max-width.px': width - 3 * gaugeWidth }\"\n    >\n      <div class=\"gauge-number\">{{ label }}</div>\n      <div *ngIf=\"description\" class=\"gauge-description text-center\">{{ description }}</div>\n    </div>\n  `,\n  styles: []\n})\nexport class PbdsDatavizGaugeComponent implements OnInit, OnChanges {\n  @HostBinding('class.pbds-chart')\n  chartClass = true;\n\n  @HostBinding('class.pbds-chart-gauge')\n  gaugeClass = true;\n\n  @Input()\n  data: PbdsDatavizGauge;\n\n  @Input()\n  width = 300;\n\n  @Input()\n  type: 'halfmoon' | 'horseshoe' | 'circle' = 'halfmoon';\n\n  @Input()\n  color = '#E23DA8';\n\n  @Input()\n  hideLabel = false;\n\n  @Input()\n  labelFormatString = '';\n\n  @Input()\n  description;\n\n  @Input()\n  gaugeWidth = 20;\n\n  private chart;\n  private svg;\n  private gauge;\n  private labelTween; // TODO: rename this\n  public label;\n  private startAngle;\n  private endAngle;\n  private radius;\n  private arc;\n  private labelFormat;\n  private oldValue;\n  private height;\n  private rounded;\n\n  constructor(private _dataviz: PbdsDatavizService, private _element: ElementRef) {}\n\n  ngOnInit() {\n    this.height = this.width;\n    this.radius = Math.max(this.width, this.height) / 2;\n    this.labelFormat = d3_format(this.labelFormatString);\n    this.label = this.labelFormat(this.data.value);\n\n    switch (this.type) {\n      case 'halfmoon':\n        this.startAngle = -90;\n        this.endAngle = 90;\n        this.rounded = true;\n        break;\n\n      case 'horseshoe':\n        this.startAngle = -140;\n        this.endAngle = 140;\n        this.rounded = true;\n        break;\n\n      case 'circle':\n        this.startAngle = 0;\n        this.endAngle = 360;\n        this.rounded = false;\n        break;\n    }\n\n    this.arc = d3_arc().cornerRadius(this.rounded ? this.gaugeWidth : 0);\n\n    this.chart = d3_select(this._element.nativeElement).attr('aria-hidden', 'true');\n\n    this.svg = this.chart\n      .append('svg')\n      .attr('width', this.width)\n      .attr('height', this.height)\n      .attr('class', 'img-fluid') // to resize chart\n      .attr('preserveAspectRatio', 'xMinYMin meet')\n      .attr('viewBox', `-${this.width / 2} -${this.height / 2} ${this.width} ${this.height}`);\n\n    this.drawChart();\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (changes.data && !changes.data.firstChange) {\n      // console.log(changes.data.previousValue.value, changes.data.currentValue.value);\n\n      this.oldValue = changes.data.previousValue.value;\n      this.updateChart();\n    }\n  }\n\n  degreesToRadians = degree => {\n    return (degree * Math.PI) / 180;\n  };\n\n  calculateMinMax = () => {\n    const percentage = this.data.minvalue / (this.data.maxvalue - this.data.minvalue);\n\n    return percentage * (this.data.value - this.data.minvalue) + (this.data.value - this.data.minvalue);\n  };\n\n  calculateCurve = data => {\n    const start = this.degreesToRadians(this.startAngle);\n    const end = start + (data * (this.degreesToRadians(this.endAngle) - start)) / this.data.maxvalue;\n\n    return [\n      {\n        startAngle: start,\n        endAngle: end\n      }\n    ];\n  };\n\n  drawChart = () => {\n    this.gauge = this.svg.append('g').attr('class', 'gauge-group');\n\n    // background arc\n    this.gauge\n      .append('path')\n      .data(this.calculateCurve(this.data.maxvalue))\n      .attr('class', 'gauge-background')\n      .attr('d', d => {\n        return this.arc({\n          innerRadius: this.radius - this.gaugeWidth,\n          outerRadius: this.radius,\n          startAngle: d.startAngle,\n          endAngle: d.endAngle\n        });\n      });\n\n    // value arc\n    this.gauge\n      .append('path')\n      .data(this.calculateCurve(this.calculateMinMax()))\n      .attr('class', 'gauge-value')\n      .attr('fill', this.color)\n      .attr('d', d => {\n        return this.arc({\n          innerRadius: this.radius - this.gaugeWidth,\n          outerRadius: this.radius,\n          startAngle: d.startAngle,\n          endAngle: d.endAngle\n        });\n      });\n\n    switch (this.type) {\n      case 'horseshoe':\n        this.svg.attr('height', 230).attr('viewBox', `-${this.width / 2} -${this.height / 2} ${this.height} 230`);\n        break;\n      case 'halfmoon':\n        this.svg.attr('height', this.width / 2);\n        this.svg.attr('viewBox', `-${this.width / 2} -${this.width / 2} ${this.width} ${this.width / 2}`);\n        break;\n    }\n  };\n\n  updateChart = () => {\n    const group = this.svg.select('.gauge-group');\n\n    group\n      .select('.gauge-value')\n      .transition()\n      .duration(750)\n      .call(this.arcTween, this.calculateMinMax());\n\n    this.labelTween = this.chart.select('.gauge-number');\n\n    this.labelTween\n      .transition()\n      .duration(750)\n      .call(this.textTween, this.data.value);\n  };\n\n  arcTween = (transition, value) => {\n    const newAngle = this.calculateCurve(value);\n\n    transition.attrTween('d', d => {\n      const interpolate = d3_interpolate(d.endAngle, newAngle[0].endAngle);\n\n      return t => {\n        d.endAngle = interpolate(t);\n\n        return this.arc({\n          innerRadius: this.radius - this.gaugeWidth,\n          outerRadius: this.radius,\n          startAngle: d.startAngle,\n          endAngle: d.endAngle\n        });\n      };\n    });\n  };\n\n  textTween = (transition, value) => {\n    value = d3_format('.2f')(value); // TODO: check these .1f formats here, should they be inputs?\n    value = value.replace(/,/g, '.');\n\n    transition.tween('text', () => {\n      const interpolate = d3_interpolate(d3_format('.2f')(+this.oldValue), value);\n\n      return t => {\n        this.labelTween.text(d => {\n          const updatedNumber = this.labelFormat(interpolate(t));\n          this.label = updatedNumber;\n          return updatedNumber;\n        });\n      };\n    });\n  };\n}\n","import { Component, OnInit, Input, ElementRef, HostBinding, ChangeDetectionStrategy } from '@angular/core';\n\nimport {\n  select as d3_select,\n  line as d3_line,\n  scaleLinear as d3_scaleLinear,\n  min as d3_min,\n  max as d3_max,\n  area as d3_area\n} from 'd3';\n\nimport { PbdsDatavizSparkline } from './dataviz.interfaces';\n\n@Component({\n  selector: 'pbds-dataviz-sparkline',\n  template: ``,\n  styles: [],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class PbdsDatavizSparklineComponent implements OnInit {\n  @HostBinding('class.pbds-chart')\n  chartClass = true;\n\n  @HostBinding('class.pbds-chart-sparkline')\n  sparklineClass = true;\n\n  @Input()\n  data: PbdsDatavizSparkline;\n\n  @Input()\n  width = 160;\n\n  @Input()\n  height = 40;\n\n  @Input()\n  type: 'line' | 'line-high' | 'area' | 'area-high' | 'bar' = 'line';\n\n  @Input()\n  color = '#E23DA8';\n\n  @Input()\n  colorNegative: string | null = null; // undocumented, may add if needed\n\n  @Input()\n  strokeWidth = 2; // undocumented, width is automatically set by the type\n\n  @Input()\n  yAxisMinBuffer = 0;\n\n  @Input()\n  yAxisMaxBuffer = 0;\n\n  private chart;\n  private svg;\n  private margin;\n\n  constructor(private _element: ElementRef) {}\n\n  ngOnInit() {\n    this.margin = { top: 1, right: 0, bottom: 1, left: 0 };\n\n    if (this.type === 'bar') {\n      this.margin = { top: 0, right: 0, bottom: 0, left: 0 };\n    }\n\n    if (this.type === 'line-high' || this.type === 'area-high') {\n      this.strokeWidth = 1;\n    }\n\n    if (this.colorNegative === null) {\n      this.colorNegative = this.color;\n    }\n\n    let x = d3_scaleLinear().range([0, this.width - this.margin.left - this.margin.right]);\n    let y = d3_scaleLinear().range([this.height - this.margin.top - this.margin.bottom, 0]);\n\n    y.domain([+d3_min(this.data) - this.yAxisMinBuffer, +d3_max(this.data) + this.yAxisMaxBuffer]);\n    x.domain([0, this.data.length]);\n\n    let line = d3_line()\n      .x((d, i) => x(i))\n      .y((d: any) => y(d));\n\n    let area = d3_area()\n      .x((d, i) => x(i))\n      .y0(this.height)\n      .y1((d: any) => y(d));\n\n    this.chart = d3_select(this._element.nativeElement).attr('aria-hidden', 'true');\n\n    this.svg = this.chart\n      .append('svg')\n      .attr('width', this.width)\n      .attr('height', this.height)\n      .attr('class', 'img-fluid')\n      .attr('preserveAspectRatio', 'xMinYMin meet')\n      .attr('viewBox', `-${this.margin.left} -${this.margin.top} ${this.width} ${this.height}`);\n\n    if (this.type === 'line' || this.type === 'line-high' || this.type === 'area' || this.type === 'area-high') {\n      this.svg\n        .append('path')\n        .datum(this.data)\n        .attr('class', 'sparkline')\n        .attr('fill', 'none')\n        .attr('stroke-width', this.strokeWidth)\n        .attr('stroke', this.color)\n        .attr('d', line);\n    }\n\n    if (this.type === 'area' || this.type === 'area-high') {\n      this.svg\n        .append('path')\n        .datum(this.data)\n        .attr('class', 'sparkarea')\n        .attr('fill', this.color)\n        .attr('fill-opacity', 0.3)\n        .attr('d', area);\n    }\n\n    if (this.type === 'bar') {\n      const barWidth = (this.width - this.data.length) / this.data.length;\n\n      // handles negative values, see example https://www.essycode.com/posts/create-sparkline-charts-d3/\n      this.svg\n        .selectAll('.bar')\n        .data(this.data)\n        .enter()\n        .append('rect')\n        .attr('class', 'sparkbar')\n        .attr('x', (d, i) => x(i))\n        .attr('y', d => (d > 0 ? y(d) : y(0)))\n        .attr('width', barWidth)\n        .attr('height', d => Math.abs(y(d) - y(0)))\n        .attr('fill', d => (d > 0 ? this.color : this.colorNegative)); // still uses undocumented negative color values\n    }\n  }\n}\n","import {\n  Component,\n  OnInit,\n  OnChanges,\n  Input,\n  Output,\n  EventEmitter,\n  ElementRef,\n  HostBinding,\n  OnDestroy,\n  SimpleChanges,\n  ChangeDetectionStrategy\n} from '@angular/core';\n\nimport { ViewportScroller } from '@angular/common';\n\nimport {\n  select as d3_select,\n  isoParse as d3_isoParse,\n  timeFormat as d3_timeFormat,\n  format as d3_format,\n  scaleOrdinal as d3_scaleOrdinal,\n  scaleBand as d3_scaleBand,\n  scaleLinear as d3_scaleLinear,\n  max as d3_max,\n  axisBottom as d3_axisBottom,\n  axisLeft as d3_axisLeft,\n  event as d3_event,\n  stack as d3_stack,\n  stackOrderNone as d3_stackOrderNone\n} from 'd3';\n\nimport { PbdsDatavizService } from './dataviz.service';\nimport { PbdsDatavizBarStacked } from './dataviz.interfaces';\n\n@Component({\n  selector: 'pbds-dataviz-bar-stacked',\n  template: ``,\n  styles: [],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class PbdsDatavizBarStackedComponent implements OnInit, OnDestroy, OnChanges {\n  @HostBinding('class.pbds-chart')\n  chartClass = true;\n\n  @HostBinding('class.pbds-chart-stacked-bar')\n  stackedBarClass = true;\n\n  @Input()\n  data: Array<PbdsDatavizBarStacked>;\n\n  @Input()\n  width = 306;\n\n  @Input()\n  height = 400;\n\n  @Input()\n  type: 'low' | 'medium' | 'high' | 'debug' = 'medium'; // debug to show all chart options\n\n  @Input()\n  marginTop = 10; // hardcoded on purpose, do not document until feedback\n\n  @Input()\n  marginRight = 0; // hardcoded on purpose, do not document until feedback\n\n  @Input()\n  marginBottom = 30; // hardcoded on purpose, do not document until feedback\n\n  @Input()\n  marginLeft = 55; // hardcoded on purpose, do not document until feedback\n\n  @Input()\n  hideXAxis = false;\n\n  @Input()\n  xAxisFormatType: 'number' | 'time' = null;\n\n  @Input()\n  xAxisFormatString = '';\n\n  @Input()\n  yAxisFormatType: 'number' | 'time' = null;\n\n  @Input()\n  yAxisFormatString = '';\n\n  @Input()\n  yAxisTicks = 5;\n\n  @Input()\n  yAxisMaxBuffer = 0.01;\n\n  @Input()\n  hideLegend = false;\n\n  @Input()\n  legendWidth = 105 + 28; // hardcoded legend width + left margin, do not document until feedback\n\n  @Input()\n  legendPosition: 'right' | 'bottom' = 'right';\n\n  @Input()\n  legendLabelFormatType: 'number' | 'time' = null;\n\n  @Input()\n  legendLabelFormatString = '';\n\n  @Input()\n  tooltipHeadingFormatType: 'time' = null;\n\n  @Input()\n  tooltipHeadingFormatString = '';\n\n  @Input()\n  tooltipHeadingValueFormatType: 'number' = null;\n\n  @Input()\n  tooltipHeadingValueFormatString = '';\n\n  @Input()\n  tooltipLabelFormatType: 'time' = null;\n\n  @Input()\n  tooltipLabelFormatString = '';\n\n  @Input()\n  tooltipValueFormatType: 'number' = null;\n\n  @Input()\n  tooltipValueFormatString = '';\n\n  @Input()\n  theme;\n\n  @Output()\n  hovered: EventEmitter<object> = new EventEmitter<object>();\n\n  @Output()\n  clicked: EventEmitter<object> = new EventEmitter<object>();\n\n  private dataStack;\n  private dataKeys;\n  private chart;\n  private svg;\n  private grayBars;\n  private mouseBars;\n  private bars;\n  private margin;\n  private colorRange;\n  private hideGrayBars: boolean;\n  private xAxisScale;\n  private xAxisCall;\n  private xAxis;\n  private xAxisFormat;\n  private xAxisTickSize: number;\n  private xAxisTickSizeOuter: number;\n  private hideXAxisDomain: boolean;\n  private hideXAxisZero: boolean;\n  private hideXAxisTicks: boolean;\n  private hideXGrid: boolean;\n  private hideYGrid: boolean;\n  private yAxisMax;\n  private yAxisScale;\n  private yAxisCall;\n  private yAxis;\n  private yAxisFormat;\n  private yAxisTickSize: number;\n  private yAxisTickSizeOuter: number;\n  private xGrid;\n  private xGridCall;\n  private yGrid;\n  private yGridCall;\n  private hideYAxis: boolean;\n  private hideYAxisZero: boolean;\n  private hideYAxisDomain: boolean;\n  private hideYAxisTicks: boolean;\n  private legendLabelFormat;\n  private tooltip;\n  private hideTooltip: boolean;\n  private tooltipHeadingFormat;\n  private tooltipHeadingValueFormat;\n  private tooltipValueFormat;\n  private tooltipLabelFormat;\n\n  constructor(private _dataviz: PbdsDatavizService, private _element: ElementRef, private _scroll: ViewportScroller) {}\n\n  ngOnInit() {\n    // extract keys for stack data\n    this.dataKeys = Object.keys(this.data[0]).filter(item => item !== 'key');\n\n    // create the D3 stack data\n    this.dataStack = d3_stack()\n      .keys(this.dataKeys)\n      .order(d3_stackOrderNone)(this.data);\n\n    //////////////////////////////////////////\n\n    this.margin = {\n      top: +this.marginTop,\n      right: +this.marginRight,\n      bottom: +this.marginBottom,\n      left: +this.marginLeft\n    };\n\n    switch (this.xAxisFormatType) {\n      case 'number':\n        this.xAxisFormat = d3_format(this.xAxisFormatString);\n        break;\n      case 'time':\n        this.xAxisFormat = d3_timeFormat(this.xAxisFormatString);\n        break;\n    }\n\n    switch (this.yAxisFormatType) {\n      case 'number':\n        this.yAxisFormat = d3_format(this.yAxisFormatString);\n        break;\n      case 'time':\n        this.yAxisFormat = d3_timeFormat(this.yAxisFormatString);\n        break;\n    }\n\n    switch (this.legendLabelFormatType) {\n      case 'number':\n        this.legendLabelFormat = d3_format(this.legendLabelFormatString);\n        break;\n      case 'time':\n        this.legendLabelFormat = d3_timeFormat(this.legendLabelFormatString);\n        break;\n      default:\n        this.legendLabelFormat = null;\n        break;\n    }\n\n    switch (this.tooltipHeadingFormatType) {\n      case 'time':\n        this.tooltipHeadingFormat = d3_timeFormat(this.tooltipHeadingFormatString);\n        break;\n      default:\n        this.tooltipHeadingFormat = null;\n        break;\n    }\n\n    switch (this.tooltipHeadingValueFormatType) {\n      case 'number':\n        this.tooltipHeadingValueFormat = d3_format(this.tooltipHeadingValueFormatString);\n        break;\n      default:\n        this.tooltipHeadingValueFormat = null;\n        break;\n    }\n\n    switch (this.tooltipLabelFormatType) {\n      case 'time':\n        this.tooltipLabelFormat = d3_timeFormat(this.tooltipLabelFormatString);\n        break;\n      default:\n        this.tooltipLabelFormat = null;\n        break;\n    }\n\n    switch (this.tooltipValueFormatType) {\n      case 'number':\n        this.tooltipValueFormat = d3_format(this.tooltipValueFormatString);\n        break;\n      default:\n        this.tooltipValueFormat = null;\n    }\n\n    // defaults for all chart types\n    this.hideGrayBars = false;\n    this.hideYAxis = false;\n    this.hideXAxisZero = false;\n    this.hideYAxisZero = false;\n    this.hideXGrid = false;\n    this.hideYGrid = false;\n    this.hideXAxisDomain = false;\n    this.hideYAxisDomain = false;\n    this.hideTooltip = false;\n    this.hideXAxisTicks = false;\n    this.hideYAxisTicks = false;\n    this.xAxisTickSize = 8;\n    this.xAxisTickSizeOuter = 0;\n    this.yAxisTickSize = 8;\n    this.yAxisTickSizeOuter = 0;\n    // this.hideTooltipLabel = false;\n\n    if (this.type !== 'debug') {\n      // set type defaults\n      switch (this.type) {\n        case 'low':\n          this.hideGrayBars = true;\n          this.hideXAxisTicks = true;\n          this.hideXGrid = true;\n          this.hideYAxisDomain = false;\n          this.hideYAxisTicks = true;\n          this.legendPosition = 'bottom';\n          break;\n\n        case 'medium':\n          this.hideXAxisDomain = true;\n          this.hideXGrid = true;\n          this.hideXAxisTicks = true;\n          this.hideYAxisDomain = true;\n          this.hideYAxisTicks = true;\n          this.hideYGrid = true;\n          break;\n\n        case 'high':\n          this.hideXAxis = true;\n          this.hideXAxisTicks = true;\n          this.hideXAxisDomain = true;\n          this.hideXGrid = true;\n          this.hideYAxisDomain = true;\n          this.hideYAxisTicks = true;\n          this.hideYGrid = true;\n          this.hideLegend = false;\n          this.legendPosition = 'bottom';\n          break;\n      }\n    }\n\n    // adjust margin if xAxis hidden\n    if (this.hideXAxis) this.margin.bottom = 10; // need small margin for yAxis with 0 tick label\n\n    if (!this.hideLegend && this.legendPosition === 'right') {\n      this.width = +this.width - +this.legendWidth;\n    }\n\n    // create the chart\n    this.chart = d3_select(this._element.nativeElement).attr('aria-hidden', 'true');\n\n    // create chart svg\n    this.svg = this.chart\n      .append('svg')\n      .attr('width', +this.width)\n      .attr('height', +this.height + this.margin.top + this.margin.bottom)\n      .attr('class', 'img-fluid')\n      .attr('preserveAspectRatio', 'xMinYMin meet')\n      .attr(\n        'viewBox',\n        `-${this.margin.left} -${this.margin.top} ${+this.width} ${+this.height + this.margin.top + this.margin.bottom}`\n      );\n\n    this.grayBars = this.svg.append('g').attr('class', 'gray-bars');\n    this.mouseBars = this.svg.append('g').attr('class', 'mouseover-bars');\n    this.bars = this.svg.append('g').attr('class', 'bars');\n\n    // build color ranges\n    this.colorRange = d3_scaleOrdinal().range(this._dataviz.getColors(false, this.theme));\n\n    // X AXIS\n    this.xAxisScale = d3_scaleBand()\n      .domain(this.data.map(d => d.key))\n      .rangeRound([0, this.width - this.margin.left])\n      .align(0);\n\n    // add padding to the scale for gray bars\n    !this.hideGrayBars\n      ? this.xAxisScale.paddingInner(0.1).paddingOuter(0)\n      : this.xAxisScale.paddingInner(0).paddingOuter(0);\n\n    this.xAxisCall = d3_axisBottom(this.xAxisScale)\n      .tickSize(this.xAxisTickSize)\n      .tickSizeOuter(this.xAxisTickSizeOuter)\n      .tickFormat(this.xAxisFormatter);\n\n    this.xAxis = this.svg\n      .append('g')\n      .attr('class', 'axis axis-x')\n      .attr('transform', `translate(0, ${this.height})`)\n      .classed('axis-hidden', this.hideXAxis)\n      .classed('axis-zero-hidden', this.hideXAxisZero)\n      .classed('axis-domain-hidden', this.hideXAxisDomain)\n      .classed('axis-ticks-hidden', this.hideXAxisTicks)\n      .call(this.xAxisCall);\n\n    // X GRIDLINES\n    if (!this.hideXGrid) {\n      this.xGridCall = d3_axisBottom(this.xAxisScale).tickSize(-this.height);\n\n      this.xGrid = this.svg\n        .append('g')\n        .attr('class', 'grid grid-x')\n        .classed('grid-zero-hidden', this.hideXAxisZero)\n        .attr('transform', `translate(0, ${this.height})`)\n        .call(this.xGridCall);\n    }\n\n    // KEEP: use this block to debug yAxisMax\n    // console.log(\n    //   d3_max(this.dataStack, (data: any) => {\n    //     // console.log(data);\n\n    //     return d3_max(data, (d: any) => {\n    //       // console.log('D: ', d);\n    //       return d[1];\n    //     });\n    //   })\n    // );\n\n    // Y AXIS\n    this.yAxisMax = d3_max(this.dataStack, (data: any) => {\n      return d3_max(data, (d: any) => {\n        return d[1];\n      });\n    });\n\n    this.yAxisMax = this.yAxisMax + this.yAxisMax * this.yAxisMaxBuffer;\n\n    this.yAxisScale = d3_scaleLinear()\n      .domain([0, this.yAxisMax])\n      .nice()\n      .rangeRound([this.height, 0]);\n\n    this.yAxisCall = d3_axisLeft(this.yAxisScale)\n      .ticks(this.yAxisTicks)\n      .tickSize(this.yAxisTickSize)\n      .tickSizeOuter(this.yAxisTickSizeOuter)\n      .tickFormat(this.yAxisFormatter);\n\n    this.yAxis = this.svg\n      .append('g')\n      .attr('class', 'axis axis-y')\n      .classed('axis-hidden', this.hideYAxis)\n      .classed('axis-zero-hidden', this.hideYAxisZero)\n      .classed('axis-domain-hidden', this.hideYAxisDomain)\n      .classed('axis-ticks-hidden', this.hideYAxisTicks)\n      .call(this.yAxisCall);\n\n    // Y GRIDLINES\n    if (!this.hideYGrid) {\n      this.yGridCall = d3_axisLeft(this.yAxisScale)\n        .ticks(this.yAxisTicks)\n        .tickSize(-this.width + this.margin.left + this.margin.right);\n\n      this.yGrid = this.svg\n        .append('g')\n        .attr('class', 'grid grid-y')\n        .classed('grid-zero-hidden', this.hideYAxisZero)\n        .attr('transform', `translate(0, 0)`)\n        .call(this.yGridCall);\n    }\n\n    // TOOLTIP\n    if (!this.hideTooltip) {\n      this.tooltip = d3_select('body')\n        .append('div')\n        .attr('class', 'pbds-tooltip west')\n        .style('opacity', 0)\n        .attr('aria-hidden', 'true'); // hide tooltip for accessibility\n\n      // tooltip header\n      this.tooltip.append('div').attr('class', 'tooltip-header');\n      this.tooltip.append('div').attr('class', 'tooltip-header-value');\n\n      // tooltip table\n      this.tooltip\n        .append('table')\n        .attr('class', 'tooltip-table text-left w-100')\n        .append('tbody');\n    }\n\n    // add legend classes\n    if (!this.hideLegend) {\n      this.chart.classed('pbds-chart-legend-bottom', this.legendPosition === 'bottom' ? true : false);\n      this.chart.append('ul').attr('class', `legend legend-${this.legendPosition}`);\n    }\n\n    this.updateChart();\n  }\n\n  ngOnDestroy() {\n    if (this.tooltip) this.tooltip.remove();\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (changes.data && !changes.data.firstChange) {\n      this.updateChart();\n    }\n  }\n\n  updateChart = () => {\n    this.dataKeys = Object.keys(this.data[0]).filter(item => item !== 'key');\n\n    // create the D3 stack data\n    this.dataStack = d3_stack()\n      .keys(this.dataKeys)\n      .order(d3_stackOrderNone)(this.data);\n\n    // update the xScale\n    this.xAxisScale.domain(this.data.map(d => d.key));\n\n    // update the yScale\n    this.yAxisMax = d3_max(this.dataStack, (data: any) => {\n      return d3_max(data, (d: any) => {\n        return d[1];\n      });\n    });\n\n    this.yAxisMax = this.yAxisMax + this.yAxisMax * this.yAxisMaxBuffer;\n\n    this.yAxisScale\n      .domain([0, this.yAxisMax])\n      .rangeRound([this.height, 0])\n      .nice();\n\n    this.xAxis\n      .transition()\n      .duration(0) // 1000\n      .call(this.xAxisCall);\n\n    this.yAxis\n      .transition()\n      .duration(0) // 1000\n      .call(this.yAxisCall);\n\n    // update the grids\n    if (!this.hideXGrid) {\n      this.xGrid\n        .transition()\n        .duration(0) // 1000\n        .call(this.xGridCall);\n    }\n\n    if (!this.hideYGrid) {\n      this.yGrid\n        .transition()\n        .duration(0) // 1000\n        .call(this.yGridCall);\n    }\n\n    // add gray bars\n    if (!this.hideGrayBars) {\n      this.grayBars\n        .selectAll('.gray-bar')\n        .data(this.data)\n        .join(\n          enter =>\n            enter\n              .append('rect')\n              .attr('class', 'gray-bar')\n              .attr('x', d => this.xAxisScale(d.key))\n              .attr('width', this.xAxisScale.bandwidth())\n              .attr('height', this.height),\n          update =>\n            update\n              .transition()\n              .duration(0) // 1000\n              .attr('x', d => this.xAxisScale(d.key))\n              .attr('width', this.xAxisScale.bandwidth())\n              .attr('height', this.height),\n          exit => exit.remove()\n        );\n    }\n\n    // add colored bars\n    const barGroups = this.bars\n      .selectAll('.bar-group')\n      .data(this.dataStack)\n      .join(\n        enter =>\n          enter\n            .append('g')\n            .attr('class', 'bar-group')\n            .attr('fill', d => this.colorRange(d.index)),\n        update => update.attr('fill', d => this.colorRange(d.index)),\n        exit => exit.remove()\n      );\n\n    barGroups\n      .selectAll('.bar')\n      .data(d => d)\n      .join(\n        enter =>\n          enter\n            .append('rect')\n            .attr('class', 'bar')\n            .classed('bar-divided', this.type !== 'high')\n            .classed('bar-divided-low', this.type === 'low')\n            .attr('x', (d, i) => {\n              let x;\n\n              if (this.type === 'medium') {\n                x = this.xAxisScale(d.data.key) + (this.xAxisScale.bandwidth() / 8) * 3;\n              } else {\n                x = this.xAxisScale(d.data.key) + (this.xAxisScale.bandwidth() / 4) * 1;\n              }\n\n              return x;\n            })\n            .attr('y', d => this.yAxisScale(d[1]))\n            .attr('width', 0)\n            .attr('height', 0)\n            .call(enter => {\n              let width;\n\n              if (this.type === 'medium') {\n                width = this.xAxisScale.bandwidth() / 4;\n              } else {\n                width = this.xAxisScale.bandwidth() / 2;\n              }\n\n              enter\n                .transition()\n                .duration(0) // 1000\n                .attr('width', width)\n                .attr('height', d => this.yAxisScale(d[0]) - this.yAxisScale(d[1]));\n\n              return enter;\n            }),\n        update =>\n          update.call(update => {\n            let width;\n\n            if (this.type === 'medium') {\n              width = this.xAxisScale.bandwidth() / 4;\n            } else {\n              width = this.xAxisScale.bandwidth() / 2;\n            }\n\n            update\n              .transition()\n              .duration(0) // 1000\n              .attr('width', this.xAxisScale.bandwidth() / 4)\n              .attr('x', (d, i) => this.xAxisScale(d.data.key) + (this.xAxisScale.bandwidth() / 8) * 3)\n              .attr('y', d => this.yAxisScale(d[1]))\n              .attr('height', d => this.yAxisScale(d[0]) - this.yAxisScale(d[1]));\n\n            return update;\n          }),\n\n        exit => exit.remove()\n      );\n\n    // mouseover bars\n    this.mouseBars\n      .selectAll('.mouseover-bar')\n      .data(this.data)\n      .join(\n        enter =>\n          enter\n            .append('rect')\n            .attr('class', 'mouseover-bar')\n            .style('opacity', 0)\n            .attr('x', d => this.xAxisScale(d.key))\n            .attr('width', this.xAxisScale.bandwidth())\n            .attr('height', this.height),\n        update =>\n          update\n            .attr('pointer-events', 'none')\n            .attr('x', d => this.xAxisScale(d.key))\n            .attr('width', this.xAxisScale.bandwidth())\n            .attr('height', this.height)\n            .transition()\n            .attr('pointer-events', 'auto'),\n        exit =>\n          exit\n            .transition()\n            .attr('pointer-events', 'none')\n            .remove()\n      )\n      .on('mouseover', (data, index, nodes) => this.barMouseOver(d3_event, data, index, nodes))\n      .on('mouseout', (data, index, nodes) => this.barMouseOut())\n      .on('click', (data, index, nodes) => this.barMouseClick(d3_event, data, index, nodes));\n\n    this.bars.raise();\n    this.xAxis.raise();\n    this.mouseBars.raise();\n\n    if (!this.hideLegend) {\n      // TODO: refactor to use .join() with enter, update, exit\n      const legendItem = this.chart\n        .select('.legend')\n        .selectAll('.legend-item')\n        .data(this.dataStack);\n\n      legendItem.exit().remove();\n\n      // update existing items\n      legendItem.select('.legend-label').html(d => {\n        // return this.legendLabelFormat === null ? d.label : this.legendLabelFormat(d.label);\n        switch (this.legendLabelFormatType) {\n          case 'number':\n            return this.legendLabelFormat(d.key);\n\n          case 'time':\n            const parsedTime = d3_isoParse(d.key);\n            return this.legendLabelFormat(parsedTime);\n\n          default:\n            return d.key;\n        }\n      });\n\n      // legend items on enter\n      const enterLegendItem = legendItem\n        .enter()\n        .append('li')\n        .attr('class', 'legend-item');\n\n      enterLegendItem\n        .append('span')\n        .attr('class', 'legend-key')\n        .style('background-color', d => this.colorRange(d.index));\n\n      enterLegendItem\n        .append('span')\n        .attr('class', 'legend-label')\n        .html(d => {\n          // return this.legendLabelFormat === null ? d.label : this.legendLabelFormat(d.label);\n          switch (this.legendLabelFormatType) {\n            case 'number':\n              return this.legendLabelFormat(d.key);\n\n            case 'time':\n              const parsedTime = d3_isoParse(d.key);\n              return this.legendLabelFormat(parsedTime);\n\n            default:\n              return d.key;\n          }\n        });\n\n      enterLegendItem\n        .on('mouseover', (data, index, nodes) => this.legendMouseOver(d3_event, data, index, nodes))\n        .on('mouseout', () => this.legendMouseOut())\n        .on('click', (data, index, nodes) => this.legendMouseClick(d3_event, data, index, nodes));\n    }\n  };\n\n  barMouseOver = (event, data, index, nodes) => {\n    this.chart\n      .selectAll('.bar-group')\n      .selectAll('.bar')\n      .filter((d, i) => i !== index)\n      .classed('inactive', true);\n\n    this.tooltipShow(data, index, nodes[index]);\n\n    this.hovered.emit({ event, data });\n  };\n\n  barMouseOut = () => {\n    this.chart.selectAll('.bar').classed('inactive', false);\n\n    this.tooltipHide();\n  };\n\n  barMouseClick = (event, data, index, nodes) => {\n    this.clicked.emit({ event, data });\n  };\n\n  legendMouseOver = (event, data, index, nodes) => {\n    this.chart\n      .selectAll('.legend-item')\n      .filter((d, i) => i !== index)\n      .classed('inactive', true);\n\n    this.chart\n      .selectAll('.bar-group')\n      .filter((d, i) => i !== index)\n      .classed('inactive', true);\n\n    this.hovered.emit({ event, data });\n  };\n\n  legendMouseOut = () => {\n    this.chart.selectAll('.legend-item').classed('inactive', false);\n\n    this.chart.selectAll('.bar-group').classed('inactive', false);\n\n    this.tooltipHide();\n  };\n\n  legendMouseClick = (event, data, index, nodes) => {\n    this.clicked.emit({ event, data });\n  };\n\n  private xAxisFormatter = item => {\n    switch (this.xAxisFormatType) {\n      case 'number':\n        return this.xAxisFormat(item);\n\n      case 'time':\n        const parseDate = d3_isoParse(item);\n        return this.xAxisFormat(parseDate);\n\n      default:\n        return item;\n    }\n  };\n\n  private tooltipShow = (data, index, node) => {\n    // console.log('TOOLTIP: ', data, index, node);\n\n    const scroll = this._scroll.getScrollPosition();\n    const mouserectDimensions = node.getBoundingClientRect();\n    const clientWidth = document.body.clientWidth - 10;\n    let dimensionCalculated;\n    let tooltipDimensions;\n    let tooltipOffsetHeight;\n    let yPosition;\n    let xPosition;\n\n    // console.log(scroll, mouserectDimensions, tooltipOffsetHeight, tooltipDimensions, dimensionCalculated, clientWidth);\n\n    this.tooltip.select('.tooltip-header').html(d => {\n      switch (this.tooltipHeadingFormatType) {\n        case 'time':\n          const parseDate = d3_isoParse(data.key);\n          return this.tooltipHeadingFormat(parseDate);\n\n        default:\n          return data.key;\n      }\n    });\n\n    this.tooltip.select('.tooltip-header-value').html(d => {\n      let total = 0;\n\n      Object.keys(data).map(e => {\n        if (e !== 'key') {\n          total = total + data[e];\n        }\n      });\n\n      return this.tooltipHeadingValueFormat(total);\n    });\n\n    this.tooltip\n      .select('.tooltip-table')\n      .select('tbody')\n      .html(d => {\n        let html = ``;\n        let label;\n        let value;\n\n        Object.keys(data).map((key, index) => {\n          switch (this.tooltipLabelFormatType) {\n            case 'time':\n              const parseDate = d3_isoParse(key);\n              label = this.tooltipHeadingFormat(parseDate);\n              break;\n\n            default:\n              label = key;\n          }\n\n          switch (this.tooltipValueFormatType) {\n            case 'number':\n              value = this.tooltipValueFormat(data[key]);\n              break;\n\n            default:\n              value = data[key];\n          }\n\n          if (key !== 'key') {\n            html += `\n              <tr class='tooltip-item'>\n                <td style=\"color: ${this.colorRange(index - 1)}\">\n                  <span class=\"pbds-tooltip-key\"></span>\n                </td>\n                <td class=\"tooltip-label pr-2 text-nowrap\">${label}</td>\n                <td class=\"tooltip-value text-right text-nowrap\">${value}</td>\n              </tr>\n            `;\n          }\n        });\n\n        return html;\n      });\n\n    tooltipDimensions = this.tooltip.node().getBoundingClientRect();\n    dimensionCalculated = mouserectDimensions.left + mouserectDimensions.width + tooltipDimensions.width + 8;\n    tooltipOffsetHeight = +this.tooltip.node().offsetHeight;\n\n    // flip the tooltip positions if near the right edge of the screen\n    if (dimensionCalculated > clientWidth) {\n      this.tooltip.classed('east', true);\n      this.tooltip.classed('west', false);\n\n      if (this.type === 'medium') {\n        xPosition = `${mouserectDimensions.left + (mouserectDimensions.width / 8) * 3 - tooltipDimensions.width - 8}px`;\n      } else {\n        xPosition = `${mouserectDimensions.left + (mouserectDimensions.width / 4) * 1 - tooltipDimensions.width - 8}px`;\n      }\n    } else if (dimensionCalculated < clientWidth) {\n      this.tooltip.classed('east', false);\n      this.tooltip.classed('west', true);\n\n      if (this.type === 'medium') {\n        xPosition = `${mouserectDimensions.left + (mouserectDimensions.width / 8) * 5 + 8}px`;\n      } else {\n        xPosition = `${mouserectDimensions.left + (mouserectDimensions.width / 4) * 3 + 8}px`;\n      }\n    }\n\n    yPosition = this.svg\n      .selectAll('.bar-group')\n      .filter(':last-child')\n      .selectAll('.bar')\n      .filter((d, i) => i === index)\n      .node()\n      .getBoundingClientRect();\n\n    // set the tooltip styles\n    this.tooltip.style('top', `${yPosition.top - tooltipOffsetHeight / 2 + scroll[1]}px`);\n    this.tooltip.style('left', xPosition);\n    this.tooltip.style('opacity', 1);\n  };\n\n  private tooltipHide = () => {\n    this.tooltip.style('opacity', 0);\n  };\n\n  private yAxisFormatter = item => {\n    switch (this.yAxisFormatType) {\n      case 'number':\n        return this.yAxisFormat(item);\n\n      case 'time':\n        const parseDate = d3_isoParse(item);\n        return this.yAxisFormat(parseDate);\n\n      default:\n        return item;\n    }\n  };\n}\n","import { Component, Input, HostBinding } from '@angular/core';\n\n@Component({\n  selector: 'pbds-dataviz-metric-indicator',\n  template: `\n    <span>{{ value }}</span>\n  `,\n  styles: []\n})\nexport class PbdsDatavizMetricIndicatorComponent {\n  @Input()\n  value = 0;\n\n  @Input()\n  class = '';\n\n  @Input()\n  indicator: 'flat' | 'increase' | 'decrease' = 'flat';\n\n  @Input()\n  inverse = false;\n\n  @HostBinding('class')\n  get hostClasses() {\n    return ['metric-block-indicator', this.indicator, this.inverse ? 'inverse' : '', this.class].join(' ');\n  }\n}\n","import { Component, OnInit, Input, HostBinding, ElementRef, ContentChild } from '@angular/core';\n\nimport { PbdsDatavizMetricIndicatorComponent } from './dataviz-metric-indicator.component';\n\n@Component({\n  selector: 'pbds-dataviz-metric-block',\n  template: `\n    <div class=\"metric-block-inner\">\n      <div *ngIf=\"heading\" class=\"metric-block-heading\">{{ heading }}</div>\n      <div class=\"metric-block-data-block\">\n        <div class=\"metric-block-contents\">\n          <div class=\"metric-block-value\" [ngClass]=\"{ 'mr-0': hideValueMargin }\">\n            {{ value\n            }}<span [ngClass]=\"{ 'metric-block-unit': isUnit, 'metric-block-percentage': isPercentUnit }\">{{\n              unit\n            }}</span>\n          </div>\n\n          <div>\n            <ng-content select=\"pbds-dataviz-metric-indicator\"></ng-content>\n          </div>\n          <div *ngIf=\"description\" class=\"metric-block-description\">{{ description }}</div>\n        </div>\n        <ng-content select=\"pbds-dataviz-sparkline\"></ng-content>\n      </div>\n    </div>\n  `,\n  styles: []\n})\nexport class PbdsDatavizMetricBlockComponent implements OnInit {\n  @Input()\n  class = '';\n\n  @Input()\n  heading: string = null;\n\n  @Input()\n  value = 0;\n\n  @Input()\n  unit: string = null;\n\n  @Input()\n  description: string = null;\n\n  @Input()\n  centered = false;\n\n  @Input()\n  centeredText = false;\n\n  @Input()\n  vertical = false;\n\n  hideValueMargin = false;\n  isPercentUnit = false;\n  isUnit = false;\n\n  @HostBinding('class')\n  get hostClasses() {\n    return [\n      'metric-block',\n      this.centered ? 'metric-block-centered' : '',\n      this.centeredText ? 'metric-block-centered-text' : '',\n      this.vertical ? 'metric-block-vertical' : '',\n      this.class\n    ].join(' ');\n  }\n\n  @ContentChild(PbdsDatavizMetricIndicatorComponent, { static: true }) indicatorRef: ElementRef;\n\n  ngOnInit() {\n    if (!this.indicatorRef) {\n      this.hideValueMargin = true;\n    }\n\n    if (this.unit !== '%' && this.unit !== null) {\n      this.isUnit = true;\n    } else if (this.unit === '%') {\n      this.isPercentUnit = true;\n    }\n  }\n}\n","import {\n  Component,\n  OnInit,\n  OnChanges,\n  Input,\n  Output,\n  EventEmitter,\n  ElementRef,\n  HostBinding,\n  OnDestroy,\n  SimpleChanges,\n  ChangeDetectionStrategy\n} from '@angular/core';\n\nimport { ViewportScroller } from '@angular/common';\n\nimport {\n  select as d3_select,\n  format as d3_format,\n  scaleLinear as d3_scaleLinear,\n  min as d3_min,\n  max as d3_max,\n  event as d3_event,\n  geoPath as d3_geoPath,\n  geoAlbers as d3_geoAlbers,\n  geoAlbersUsa as d3_geoAlbersUsa,\n  geoMercator as d3_geoMercator\n} from 'd3';\n\nimport * as topojson from 'topojson';\n\nimport { PbdsDatavizMapData } from './dataviz.interfaces';\n\n@Component({\n  selector: 'pbds-dataviz-bubble-map',\n  template: ``,\n  styles: [],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class DatavizBubbleMapComponent implements OnInit, OnChanges, OnDestroy {\n  @HostBinding('class.pbds-chart')\n  chartClass = true;\n\n  @HostBinding('class.pbds-chart-bubble-map')\n  bubbleMapClass = true;\n\n  @Input()\n  data: Array<PbdsDatavizMapData>;\n\n  @Input()\n  topojson;\n\n  @Input()\n  feature = '';\n\n  @Input()\n  projectionType;\n\n  @Input()\n  scale = null;\n\n  @Input()\n  center = null;\n\n  @Input()\n  width = 306;\n\n  @Input()\n  height = 400;\n\n  @Input()\n  type: 'medium' | 'high' | 'debug' = 'medium'; // debug to show all chart options\n\n  @Input()\n  dot = false;\n\n  @Input()\n  marginTop = 0;\n\n  @Input()\n  marginRight = 0;\n\n  @Input()\n  marginBottom = 0;\n\n  @Input()\n  marginLeft = 0;\n\n  @Input()\n  color = '#ef8200';\n\n  @Input()\n  textColor = '#fff';\n\n  @Input()\n  textSizeRange = [14, 24];\n\n  @Input()\n  dotSize = 4;\n\n  @Input()\n  bubbleSizeRange = [500, 2000];\n\n  @Input()\n  bubbleLabelFormatType: 'number' = null;\n\n  @Input()\n  bubbleLabelFormatString = '';\n\n  @Input()\n  hideTooltip = false;\n\n  @Input()\n  hideTooltipValue = false;\n\n  @Input()\n  tooltipValueFormatType: 'number' = null;\n\n  @Input()\n  tooltipValueFormatString = '';\n\n  @Output()\n  hovered: EventEmitter<object> = new EventEmitter<object>();\n\n  @Output()\n  clicked: EventEmitter<object> = new EventEmitter<object>();\n\n  private projection;\n  private geoPath;\n  private topojsonFeature;\n  private chart;\n  private svg;\n  private margin;\n  private bubbleContainer;\n  private bubbleRadius;\n  private fontRange;\n  private bubbleLabelFormat;\n  private tooltip;\n  private tooltipValueFormat;\n\n  constructor(private _element: ElementRef, private _scroll: ViewportScroller) {}\n\n  ngOnInit() {\n    this.margin = {\n      top: +this.marginTop,\n      right: +this.marginRight,\n      bottom: +this.marginBottom,\n      left: +this.marginLeft\n    };\n\n    if (this.type !== 'debug') {\n      // set type defaults\n      switch (this.type) {\n        case 'medium':\n          break;\n\n        case 'high':\n          break;\n      }\n    }\n\n    switch (this.projectionType) {\n      case 'geoAlbers':\n        this.projection = d3_geoAlbers();\n        break;\n\n      case 'geoAlbersUsa':\n        this.projection = d3_geoAlbersUsa();\n        break;\n\n      case 'geoMercator':\n        this.projection = d3_geoMercator();\n        break;\n\n      default:\n        break;\n    }\n\n    switch (this.bubbleLabelFormatType) {\n      case 'number':\n        this.bubbleLabelFormat = d3_format(this.bubbleLabelFormatString);\n        break;\n\n      default:\n        this.bubbleLabelFormat = null;\n        break;\n    }\n\n    switch (this.tooltipValueFormatType) {\n      case 'number':\n        this.tooltipValueFormat = d3_format(this.tooltipValueFormatString);\n        break;\n\n      default:\n        this.tooltipValueFormat = null;\n    }\n\n    // console.log('TOPOJSON: ', this.topojson);\n\n    this.topojsonFeature = topojson.feature(this.topojson, this.topojson.objects[this.feature]);\n    this.projection.fitSize([+this.width, +this.height], this.topojsonFeature);\n\n    // console.log('TOPOJSON FEATURE: ', this.topojsonFeature);\n    // console.log('MESH: ', topojson.mesh(this.topojson, this.topojson.objects[this.feature], (a, b) => a !== b));\n    // console.log('DATA: ', this.data);\n\n    if (this.scale) {\n      this.projection.scale(+this.scale);\n    }\n\n    if (this.center) {\n      this.projection.center(this.center);\n    }\n\n    this.geoPath = d3_geoPath().projection(this.projection);\n\n    // bubble radius range\n    if (this.data && !this.dot) {\n      this.bubbleRadius = d3_scaleLinear()\n        .range(this.bubbleSizeRange)\n        .domain([d3_min(this.data, (d: any) => +d.value), d3_max(this.data, (d: any) => +d.value)]);\n\n      // font range\n      this.fontRange = d3_scaleLinear()\n        .range(this.textSizeRange)\n        .domain([d3_min(this.data, (d: any) => +d.value), d3_max(this.data, (d: any) => +d.value)]);\n    }\n\n    // TOOLTIP\n    if (!this.hideTooltip) {\n      this.tooltip = d3_select('body')\n        .append('div')\n        .attr('class', 'pbds-tooltip south')\n        .style('opacity', 0)\n        .attr('aria-hidden', 'true'); // hide tooltip for accessibility\n\n      // tooltip header\n      this.tooltip.append('div').attr('class', 'tooltip-header');\n      if (!this.hideTooltipValue) this.tooltip.append('div').attr('class', 'tooltip-value');\n    }\n\n    // create the chart\n    this.chart = d3_select(this._element.nativeElement).attr('aria-hidden', 'true');\n\n    // create chart svg\n    this.svg = this.chart\n      .append('svg')\n      .attr('width', +this.width + this.margin.left + this.margin.right)\n      .attr('height', +this.height + this.margin.top + this.margin.bottom)\n      .attr('class', 'img-fluid')\n      .attr('preserveAspectRatio', 'xMinYMin meet')\n      .attr(\n        'viewBox',\n        `-${this.margin.left} -${this.margin.top} ${+this.width + this.margin.left + this.margin.right} ${+this.height +\n          this.margin.top +\n          this.margin.bottom}`\n      )\n      .append('g')\n      .attr('class', 'container');\n\n    // map\n    this.svg\n      .append('g')\n      .attr('class', 'map')\n      .selectAll('path')\n      .data(this.topojsonFeature.features)\n      .enter()\n      .append('path')\n      .attr('class', 'feature')\n      .attr('d', this.geoPath);\n\n    // borders\n    this.svg\n      .append('path')\n      .attr('class', 'mesh')\n      .datum(topojson.mesh(this.topojson, this.topojson.objects[this.feature], (a, b) => a !== b))\n      .attr('d', this.geoPath);\n\n    this.bubbleContainer = this.svg\n      .append('g')\n      .attr('class', 'dots')\n      .style('color', this.color);\n\n    this.updateChart();\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (changes.data && !changes.data.firstChange) {\n      this.updateChart();\n    }\n  }\n\n  ngOnDestroy() {\n    if (this.tooltip) this.tooltip.remove();\n  }\n\n  updateChart = () => {\n    // bubbles\n\n    this.bubbleContainer\n      .selectAll('circle')\n      .data(this.data)\n      .join(\n        enter =>\n          enter\n            .append('circle')\n            .attr('class', 'dot-circle')\n            .classed('solid', this.dot)\n            .attr('cx', d => this.projection([d.longitude, d.latitude])[0])\n            .attr('cy', d => this.projection([d.longitude, d.latitude])[1])\n            .attr('r', d => (!this.dot ? Math.sqrt(this.bubbleRadius(d.value)) : `${this.dotSize}px`)),\n        update =>\n          update\n            .transition()\n            .duration(1000)\n            .attr('cx', d => this.projection([d.longitude, d.latitude])[0])\n            .attr('cy', d => this.projection([d.longitude, d.latitude])[1])\n            .attr('r', d => (!this.dot ? Math.sqrt(this.bubbleRadius(d.value)) : `${this.dotSize}px`))\n            .transition()\n            .attr('pointer-events', 'auto'),\n        exit =>\n          exit\n            .transition()\n            .attr('pointer-events', 'none')\n            .remove()\n      );\n\n    if (!this.hideTooltip) {\n      this.bubbleContainer\n        .selectAll('circle')\n        .on('mouseover', (data, index, nodes) => this.bubbleMouseOver(d3_event, data, index, nodes))\n        .on('mouseout', (data, index, nodes) => this.bubbleMouseOut(d3_event, data, index, nodes))\n        .on('click', (data, index, nodes) => this.bubbleMouseClick(d3_event, data, index, nodes));\n\n      // bubble text\n      if (this.type !== 'high' && !this.dot) {\n        this.bubbleContainer\n          .selectAll('text')\n          .data(this.data)\n          .join(\n            enter =>\n              enter\n                .append('text')\n                .text(d => (this.bubbleLabelFormat ? this.bubbleLabelFormat(d.value) : d.value))\n                .attr('class', 'dot-text')\n                .style('fill', this.textColor)\n                .style('font-size', d => `${Math.round(this.fontRange(d.value))}px`)\n                .attr('x', d => this.projection([d.longitude, d.latitude])[0])\n                .attr('y', d => this.projection([d.longitude, d.latitude])[1])\n                .attr('dy', '.4em'),\n            update =>\n              update\n                .attr('pointer-events', 'none')\n                .transition()\n                .duration(1000)\n                .text(d => (this.bubbleLabelFormat ? this.bubbleLabelFormat(d.value) : d.value))\n                .style('font-size', d => `${Math.round(this.fontRange(d.value))}px`)\n                .attr('x', d => this.projection([d.longitude, d.latitude])[0])\n                .attr('y', d => this.projection([d.longitude, d.latitude])[1])\n                .attr('dy', '.4em')\n                .transition()\n                .attr('pointer-events', 'auto'),\n            exit =>\n              exit\n                .transition()\n                .attr('pointer-events', 'none')\n                .remove()\n          );\n      }\n    }\n  };\n\n  bubbleMouseOver = (event, data, index, nodes) => {\n    this.chart\n      .selectAll('.dot-circle')\n      .filter((d, i) => i !== index)\n      .classed('inactive', true);\n\n    this.chart\n      .selectAll('.dot-circle')\n      .filter((d, i) => i === index)\n      .classed('active', true);\n\n    this.tooltipShow(data, nodes[index]);\n\n    this.hovered.emit({ event, data });\n  };\n\n  bubbleMouseOut = (event, data, index, nodes) => {\n    this.chart\n      .selectAll('.dot-circle')\n      .classed('active', false)\n      .classed('inactive', false);\n\n    this.tooltipHide();\n  };\n\n  bubbleMouseClick = (event, data, index, nodes) => {\n    this.clicked.emit({ event, data });\n  };\n\n  private tooltipShow = (data, node) => {\n    const dimensions = node.getBoundingClientRect();\n    const scroll = this._scroll.getScrollPosition();\n\n    this.tooltip.select('.tooltip-header').html(d => `${data.label}`);\n\n    if (!this.hideTooltipValue) {\n      this.tooltip\n        .select('.tooltip-value')\n        .html(d => (this.tooltipValueFormat ? `${this.tooltipValueFormat(data.value)}` : `${data.value}`));\n    }\n\n    const tooltipOffsetWidth = +this.tooltip.node().offsetWidth / 2;\n    const tooltipOffsetHeight = +this.tooltip.node().offsetHeight + 8;\n\n    this.tooltip.style('top', `${+scroll[1] + +dimensions.top - tooltipOffsetHeight}px`); //\n    this.tooltip.style('left', `${+scroll[0] + +dimensions.left - tooltipOffsetWidth + +dimensions.width / 2}px`);\n    this.tooltip.style('opacity', 1);\n  };\n\n  private tooltipHide = () => {\n    this.tooltip.style('opacity', 0);\n  };\n}\n","import {\n  Component,\n  OnInit,\n  OnChanges,\n  HostBinding,\n  Input,\n  Output,\n  ElementRef,\n  SimpleChanges,\n  EventEmitter,\n  ChangeDetectionStrategy\n} from '@angular/core';\n\nimport { ViewportScroller } from '@angular/common';\n\nimport { PbdsDatavizHeatmap } from './dataviz.interfaces';\nimport { PbdsDatavizService } from './dataviz.service';\n\nimport {\n  select as d3_select,\n  isoParse as d3_isoParse,\n  timeFormat as d3_timeFormat,\n  format as d3_format,\n  scaleBand as d3_scaleBand,\n  scaleThreshold as d3_scaleThreshold,\n  scaleQuantile as d3_scaleQuantile,\n  scaleQuantize as d3_scaleQuantize,\n  min as d3_min,\n  max as d3_max,\n  axisBottom as d3_axisBottom,\n  axisLeft as d3_axisLeft,\n  event as d3_event\n} from 'd3';\n\n@Component({\n  selector: 'pbds-dataviz-heatmap',\n  template: ``,\n  styles: [],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class PbdsDatavizHeatmapComponent implements OnInit, OnChanges {\n  @HostBinding('class.pbds-chart')\n  chartClass = true;\n\n  @HostBinding('class.pbds-chart-heatmap')\n  heatmapClass = true;\n\n  @Input()\n  data: Array<PbdsDatavizHeatmap>;\n\n  @Input()\n  width = 306;\n\n  @Input()\n  height = 400;\n\n  @Input()\n  marginTop = 0; // hardcoded on purpose, do not document until feedback\n\n  @Input()\n  marginRight = 0; // hardcoded on purpose, do not document until feedback\n\n  @Input()\n  marginBottom = 30; // hardcoded on purpose, do not document until feedback\n\n  @Input()\n  marginLeft = 55;\n\n  @Input()\n  scale: 'threshold' | 'quantile' | 'quantize' = 'quantile';\n\n  @Input()\n  domain: Array<number>;\n\n  @Input()\n  xAxisFormatType: 'number' | 'time' = null;\n\n  @Input()\n  xAxisFormatString = '';\n\n  @Input()\n  yAxisFormatType: 'number' | 'time' = null;\n\n  @Input()\n  yAxisFormatString = '';\n\n  @Input()\n  hideLegend = false;\n\n  @Input()\n  legendWidth = 105 + 28; // hardcoded legend width + left margin, do not document until feedback\n\n  @Input()\n  legendPosition: 'right' | 'bottom' = 'right';\n\n  @Input()\n  legendLabelFormatType: 'number' = null;\n\n  @Input()\n  legendLabelFormatString = '';\n\n  @Input()\n  tooltipXLabelFormatType: 'number' | 'time' = null;\n\n  @Input()\n  tooltipXLabelFormatString = '';\n\n  @Input()\n  tooltipYLabelFormatType: 'number' | 'time' = null;\n\n  @Input()\n  tooltipYLabelFormatString = '';\n\n  @Input()\n  tooltipValueFormatType: 'number' = null;\n\n  @Input()\n  tooltipValueFormatString = '';\n\n  @Input()\n  theme: 'classic' | 'ocean' | 'sunset' | 'twilight' = 'classic';\n\n  @Output()\n  hovered: EventEmitter<object> = new EventEmitter<object>();\n\n  @Output()\n  clicked: EventEmitter<object> = new EventEmitter<object>();\n\n  private chart;\n  private svg;\n  private margin;\n  private colorRange;\n  private colorDomain;\n  private xAxisScale;\n  private xAxisCall;\n  private xAxis;\n  private xAxisFormat;\n  private xAxisTickSize: number;\n  private xAxisTickSizeOuter: number;\n  private hideXAxisDomain: boolean;\n  private hideXAxisZero: boolean;\n  private hideXAxisTicks: boolean;\n  private hideXAxis: boolean;\n  private yAxis;\n  private yAxisFormat;\n  private yAxisTickSize;\n  private yAxisTickSizeOuter;\n  private yAxisScale;\n  private yAxisCall;\n  private hideYAxis: boolean;\n  private hideYAxisDomain: boolean;\n  private hideYAxisZero: boolean;\n  private hideYAxisTicks: boolean;\n  private legendLabelFormat;\n  private tooltip;\n  private tooltipYLabelFormat;\n  private tooltipXLabelFormat;\n  private hideTooltip;\n  private tooltipValueFormat;\n\n  constructor(private _dataviz: PbdsDatavizService, private _element: ElementRef, private _scroll: ViewportScroller) {}\n\n  ngOnInit() {\n    this.margin = {\n      top: +this.marginTop,\n      right: +this.marginRight,\n      bottom: +this.marginBottom,\n      left: +this.marginLeft\n    };\n\n    switch (this.yAxisFormatType) {\n      case 'number':\n        this.yAxisFormat = d3_format(this.yAxisFormatString);\n        break;\n      case 'time':\n        this.yAxisFormat = d3_timeFormat(this.yAxisFormatString);\n        break;\n      default:\n        this.yAxisFormat = null;\n        break;\n    }\n\n    switch (this.xAxisFormatType) {\n      case 'number':\n        this.xAxisFormat = d3_format(this.xAxisFormatString);\n        break;\n      case 'time':\n        this.xAxisFormat = d3_timeFormat(this.xAxisFormatString);\n        break;\n      default:\n        this.xAxisFormat = null;\n        break;\n    }\n\n    switch (this.legendLabelFormatType) {\n      case 'number':\n        this.legendLabelFormat = d3_format(this.legendLabelFormatString);\n        break;\n      default:\n        this.legendLabelFormat = null;\n        break;\n    }\n\n    switch (this.tooltipYLabelFormatType) {\n      case 'number':\n        this.tooltipYLabelFormat = d3_format(this.tooltipYLabelFormatString);\n        break;\n      case 'time':\n        this.tooltipYLabelFormat = d3_timeFormat(this.tooltipYLabelFormatString);\n        break;\n      default:\n        this.tooltipYLabelFormat = null;\n        break;\n    }\n\n    switch (this.tooltipXLabelFormatType) {\n      case 'number':\n        this.tooltipXLabelFormat = d3_format(this.tooltipXLabelFormatString);\n        break;\n      case 'time':\n        this.tooltipXLabelFormat = d3_timeFormat(this.tooltipXLabelFormatString);\n        break;\n      default:\n        this.tooltipXLabelFormat = null;\n        break;\n    }\n\n    switch (this.tooltipValueFormatType) {\n      case 'number':\n        this.tooltipValueFormat = d3_format(this.tooltipValueFormatString);\n        break;\n      default:\n        this.tooltipValueFormat = null;\n    }\n\n    // defaults for all chart types\n    this.hideXAxis = false;\n    this.hideXAxisZero = false;\n    this.hideXAxisDomain = true;\n    this.hideYAxisDomain = true;\n    this.hideTooltip = false;\n    this.hideXAxisTicks = true;\n    this.hideYAxisTicks = true;\n    this.xAxisTickSize = 8;\n    this.xAxisTickSizeOuter = 0;\n    this.yAxisTickSize = 8;\n    this.yAxisTickSizeOuter = 0;\n\n    // create the chart\n    this.chart = d3_select(this._element.nativeElement).attr('aria-hidden', 'true');\n\n    // create chart svg\n    this.svg = this.chart\n      .append('svg')\n      .attr('width', +this.width)\n      .attr('height', +this.height + this.margin.top + this.margin.bottom)\n      .attr('class', 'img-fluid')\n      .attr('preserveAspectRatio', 'xMinYMin meet')\n      .attr(\n        'viewBox',\n        `-${this.margin.left} -${this.margin.top} ${+this.width} ${+this.height + this.margin.top + this.margin.bottom}`\n      );\n\n    // color range\n    const colors = this._dataviz\n      .getColors(true, this.theme)\n      .slice()\n      .reverse();\n\n    const colorDomain: any = [\n      +d3_min(this.data, (d: PbdsDatavizHeatmap) => d.value),\n      +d3_max(this.data, (d: PbdsDatavizHeatmap) => d.value)\n    ];\n    const colorValues = this.data.map(d => d.value);\n\n    switch (this.scale) {\n      case 'threshold':\n        this.colorRange = d3_scaleThreshold()\n          .domain(this.domain)\n          .range(colors);\n\n        this.colorDomain = this.colorRange.domain();\n        break;\n\n      case 'quantile':\n        this.colorRange = d3_scaleQuantile()\n          .domain(colorValues)\n          .range(colors);\n\n        this.colorDomain = this.colorRange.quantiles();\n        break;\n\n      case 'quantize':\n        this.colorRange = d3_scaleQuantize()\n          .domain(colorDomain)\n          .range(colors);\n\n        this.colorDomain = this.colorRange.thresholds();\n        break;\n    }\n\n    // console.log(colors, colorDomain, colorValues, this.scale, this.colorRange, this.colorDomain);\n\n    // define axis labels\n    const xAxisLabels: any = [...new Set(this.data.map(d => d.xLabel))];\n    const yAxisLabels: any = [...new Set(this.data.map(d => d.yLabel))].reverse();\n\n    // X axis\n    this.xAxisScale = d3_scaleBand()\n      .domain(xAxisLabels)\n      .rangeRound([0, this.width - this.margin.left])\n      .paddingInner(0.1);\n\n    this.xAxisCall = d3_axisBottom(this.xAxisScale)\n      .tickSize(this.xAxisTickSize)\n      .tickSizeOuter(this.xAxisTickSizeOuter)\n      .tickFormat(this.xAxisFormatter);\n\n    this.xAxis = this.svg\n      .append('g')\n      .attr('class', 'axis axis-x')\n      .attr('transform', `translate(0, ${this.height})`)\n      .classed('axis-hidden', this.hideXAxis)\n      .classed('axis-zero-hidden', this.hideXAxisZero)\n      .classed('axis-domain-hidden', this.hideXAxisDomain)\n      .classed('axis-ticks-hidden', this.hideXAxisTicks)\n      .call(this.xAxisCall);\n\n    // Y axis\n    this.yAxisScale = d3_scaleBand()\n      .domain(yAxisLabels)\n      .rangeRound([this.height, 0])\n      .paddingInner(0.1);\n\n    this.yAxisCall = d3_axisLeft(this.yAxisScale)\n      .tickSize(this.yAxisTickSize)\n      .tickSizeOuter(this.yAxisTickSizeOuter)\n      .tickFormat(this.yAxisFormatter);\n\n    this.yAxis = this.svg\n      .append('g')\n      .attr('class', 'axis axis-y')\n      .classed('axis-hidden', this.hideYAxis)\n      .classed('axis-zero-hidden', this.hideYAxisZero)\n      .classed('axis-domain-hidden', this.hideYAxisDomain)\n      .classed('axis-ticks-hidden', this.hideYAxisTicks)\n      .call(this.yAxisCall);\n\n    // TOOLTIP\n    if (!this.hideTooltip) {\n      this.tooltip = d3_select('body')\n        .append('div')\n        .attr('class', 'pbds-tooltip south')\n        .style('opacity', 0)\n        .attr('aria-hidden', 'true'); // hide tooltip for accessibility\n    }\n\n    // add legend classes\n    if (!this.hideLegend) {\n      this.chart.classed('pbds-chart-legend-bottom', this.legendPosition === 'bottom' ? true : false);\n      this.chart.append('ul').attr('class', `legend legend-${this.legendPosition}`);\n    }\n\n    this.updateChart();\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (changes.data && !changes.data.firstChange) {\n      this.updateChart();\n    }\n  }\n\n  updateChart = () => {\n    this.svg\n      .selectAll('rect')\n      .data(this.data)\n      .join(\n        enter =>\n          enter\n            .append('rect')\n            .attr('class', 'block')\n            .classed('empty', d => d.value === undefined || d.value === null)\n            .attr('x', d => this.xAxisScale(d.xLabel))\n            .attr('y', d => this.yAxisScale(d.yLabel))\n            .attr('width', this.xAxisScale.bandwidth())\n            .attr('height', this.yAxisScale.bandwidth())\n            .style('fill', d => this.colorRange(d.value)),\n        update =>\n          update.call(update => {\n            update\n              .classed('empty', d => d.value === undefined || d.value === null)\n              .attr('pointer-events', 'none')\n              .transition()\n              .duration(1000)\n              .attr('x', d => this.xAxisScale(d.xLabel))\n              .attr('y', d => this.yAxisScale(d.yLabel))\n              .attr('width', this.xAxisScale.bandwidth())\n              .attr('height', this.yAxisScale.bandwidth())\n              .style('fill', d => this.colorRange(d.value))\n              .transition()\n              .attr('pointer-events', 'auto');\n\n            return update;\n          }),\n        exit =>\n          exit\n            .transition()\n            .attr('pointer-events', 'none')\n            .remove()\n      )\n      .on('mouseover', (data, index, nodes) => this.blockMouseOver(d3_event, data, index, nodes))\n      .on('mouseout', (data, index, nodes) => this.blockMouseOut())\n      .on('click', (data, index, nodes) => this.blockMouseClick(d3_event, data, index, nodes));\n\n    if (!this.hideLegend) {\n      this.chart\n        .select('.legend')\n        .selectAll('.legend-item')\n        .data(this.colorDomain)\n        .join(\n          enter => {\n            const li = enter.append('li').attr('class', 'legend-item');\n\n            li.append('span')\n              .attr('class', 'legend-key')\n              .style('background-color', d => this.colorRange(d));\n\n            li.append('span')\n              .attr('class', 'legend-label')\n              .html(d => {\n                let label: string = d;\n\n                switch (this.legendLabelFormatType) {\n                  case 'number':\n                    label = this.legendLabelFormat(d);\n                    break;\n                }\n\n                return `&ge; ${label}`;\n              });\n\n            return li;\n          },\n          update =>\n            update.select('.legend-label').html(d => {\n              let label: string = d;\n\n              switch (this.legendLabelFormatType) {\n                case 'number':\n                  label = this.legendLabelFormat(d);\n                  break;\n              }\n\n              return `&ge; ${label}`;\n            }),\n          exit => exit.remove()\n        )\n        .on('mouseover', (data, index, nodes) => this.legendMouseOver(d3_event, data, index, nodes))\n        .on('mouseout', () => this.legendMouseOut())\n        .on('click', (data, index, nodes) => this.legendMouseClick(d3_event, data, index, nodes));\n    }\n  };\n\n  blockMouseOver = (event, data, index, nodes) => {\n    // console.log(data.value, event, data, index, nodes);\n\n    if (data.value !== null) {\n      this.tooltipShow(data, index, nodes[index]);\n    }\n\n    this.hovered.emit({ event, data });\n  };\n\n  blockMouseOut = () => {\n    this.tooltipHide();\n  };\n\n  blockMouseClick = (event, data, index, nodes) => {\n    this.clicked.emit({ event, data });\n  };\n\n  legendMouseOver = (event, data, index, nodes) => {\n    this.chart\n      .selectAll('.legend-item')\n      .filter((d, i) => i !== index)\n      .classed('inactive', true);\n\n    this.chart\n      .selectAll('.block')\n      .filter((d, i) => {\n        if (index + 1 === nodes.length) {\n          return d.value < data;\n        } else {\n          return d.value < data || d.value >= +d3_select(nodes[index + 1]).data()[0];\n        }\n      })\n      .classed('inactive', true);\n\n    this.hovered.emit({ event, data });\n  };\n\n  legendMouseOut = () => {\n    this.chart.selectAll('.legend-item').classed('inactive', false);\n\n    this.chart.selectAll('.block').classed('inactive', false);\n  };\n\n  legendMouseClick = (event, data, index, nodes) => {\n    this.clicked.emit({ event, data });\n  };\n\n  private tooltipShow = (data, index, node) => {\n    // console.log('TOOLTIP: ', data, index, node);\n\n    const dimensions = node.getBoundingClientRect();\n    const scroll = this._scroll.getScrollPosition();\n    let yLabel;\n    let xLabel;\n\n    switch (this.tooltipYLabelFormatType) {\n      case 'number':\n        yLabel = this.tooltipYLabelFormat(data.yLabel);\n        break;\n\n      case 'time':\n        const parsedTime = d3_isoParse(data.yLabel);\n        yLabel = this.tooltipYLabelFormat(parsedTime);\n        break;\n\n      default:\n        yLabel = `${data.yLabel}${this.tooltipYLabelFormatString}`;\n    }\n\n    switch (this.tooltipXLabelFormatType) {\n      case 'number':\n        xLabel = this.tooltipXLabelFormat(data.xLabel);\n        break;\n\n      case 'time':\n        const parsedTime = d3_isoParse(data.xLabel);\n        xLabel = this.tooltipXLabelFormat(parsedTime);\n        break;\n\n      default:\n        xLabel = `${data.xLabel}${this.tooltipXLabelFormatString}`;\n    }\n\n    const value =\n      this.tooltipValueFormat === null\n        ? `<div class=\"tooltip-value\">${data.value}</div>`\n        : `<div class=\"tooltip-value\">${this.tooltipValueFormat(data.value)}</div>`;\n\n    this.tooltip.html(\n      `\n        ${yLabel} : ${xLabel}<br>\n        ${value}\n      `\n    );\n\n    const tooltipOffsetWidth = +this.tooltip.node().offsetWidth / 2;\n    const tooltipOffsetHeight = +this.tooltip.node().offsetHeight + 8;\n\n    this.tooltip.style('top', `${+scroll[1] + +dimensions.top - tooltipOffsetHeight}px`); //\n    this.tooltip.style('left', `${+scroll[0] + +dimensions.left - tooltipOffsetWidth + +dimensions.width / 2}px`);\n    this.tooltip.style('opacity', 1);\n\n    this.tooltip.style('opacity', 1);\n  };\n\n  private tooltipHide = () => {\n    this.tooltip.style('opacity', 0);\n  };\n\n  private xAxisFormatter = item => {\n    switch (this.xAxisFormatType) {\n      case 'number':\n        return this.xAxisFormat(item);\n\n      case 'time':\n        const parseDate = d3_isoParse(item);\n        return this.xAxisFormat(parseDate);\n\n      default:\n        return item;\n    }\n  };\n\n  private yAxisFormatter = item => {\n    switch (this.yAxisFormatType) {\n      case 'number':\n        return this.yAxisFormat(item);\n\n      case 'time':\n        const parseDate = d3_isoParse(item);\n        return this.yAxisFormat(parseDate);\n\n      default:\n        return item;\n    }\n  };\n}\n","import {\n  Component,\n  OnInit,\n  OnChanges,\n  Input,\n  Output,\n  EventEmitter,\n  ElementRef,\n  HostBinding,\n  OnDestroy,\n  SimpleChanges,\n  ChangeDetectionStrategy\n} from '@angular/core';\n\nimport { ViewportScroller } from '@angular/common';\n\nimport {\n  select as d3_select,\n  format as d3_format,\n  scaleLinear as d3_scaleLinear,\n  axisBottom as d3_axisBottom,\n  range as d3_range,\n  min as d3_min,\n  max as d3_max,\n  event as d3_event,\n  mouse as d3_mouse,\n  geoPath as d3_geoPath,\n  geoAlbers as d3_geoAlbers,\n  geoAlbersUsa as d3_geoAlbersUsa,\n  geoMercator as d3_geoMercator,\n  scaleThreshold as d3_scaleThreshold,\n  scaleQuantile as d3_scaleQuantile,\n  scaleQuantize as d3_scaleQuantize\n} from 'd3';\n\nimport * as topojson from 'topojson';\nimport { PbdsDatavizService } from './dataviz.service';\n\nimport { PbdsDatavizChoroplethMapData } from './dataviz.interfaces';\n\n@Component({\n  selector: 'pbds-dataviz-choropleth-map',\n  template: ``,\n  styles: [],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class PbdsDatavizChoroplethMapComponent implements OnInit, OnDestroy, OnChanges {\n  @HostBinding('class.pbds-chart')\n  chartClass = true;\n\n  @HostBinding('class.pbds-chart-choropleth-map')\n  choroplethMapClass = true;\n\n  @Input()\n  data: Array<PbdsDatavizChoroplethMapData>;\n\n  @Input()\n  topojson;\n\n  @Input()\n  feature = '';\n\n  @Input()\n  projectionType;\n\n  @Input()\n  dataField = 'id';\n\n  @Input()\n  mesh: string | null = null;\n\n  @Input()\n  scale = null;\n\n  @Input()\n  center = null;\n\n  @Input()\n  width = 960;\n\n  @Input()\n  height = 500;\n\n  @Input()\n  marginTop = 0;\n\n  @Input()\n  marginRight = 0;\n\n  @Input()\n  marginBottom = 0;\n\n  @Input()\n  marginLeft = 0;\n\n  @Input()\n  theme: 'classic' | 'ocean' | 'sunset' | 'twilight' = 'classic';\n\n  @Input()\n  colorScale: 'threshold' | 'quantile' | 'quantize' = 'quantile';\n\n  @Input()\n  domain: Array<number>;\n\n  @Input()\n  hideTooltip = false;\n\n  @Input()\n  tooltipValueFormatType: 'number' = null;\n\n  @Input()\n  tooltipValueFormatString = '';\n\n  @Input()\n  hideLegend = false;\n\n  @Input()\n  legendWidth = 260;\n\n  @Input()\n  legendLabel: string | null = null;\n\n  @Input()\n  legendValueFormatType: 'number' = null;\n\n  @Input()\n  legendValueFormatString = '';\n\n  @Input()\n  legendLeft = 20;\n\n  @Input()\n  legendTop = 20;\n\n  @Output()\n  hovered: EventEmitter<object> = new EventEmitter<object>();\n\n  @Output()\n  clicked: EventEmitter<object> = new EventEmitter<object>();\n\n  private projection;\n  private geoPath;\n  private topojsonFeature;\n  private chart;\n  private svg;\n  private margin;\n  private colorRange;\n  private colorDomain;\n  private tooltip;\n  private tooltipValueFormat;\n  private legendValueFormat;\n\n  constructor(private _dataviz: PbdsDatavizService, private _element: ElementRef, private _scroll: ViewportScroller) {}\n\n  ngOnInit() {\n    this.margin = {\n      top: +this.marginTop,\n      right: +this.marginRight,\n      bottom: +this.marginBottom,\n      left: +this.marginLeft\n    };\n\n    // color range\n    const colors = this._dataviz\n      .getColors(true, this.theme)\n      .slice()\n      .reverse();\n\n    const colorDomain: any = [+d3_min(this.data, d => d.value), +d3_max(this.data, d => d.value)];\n    const colorValues = this.data.map(d => d.value);\n\n    switch (this.colorScale) {\n      case 'threshold':\n        this.colorRange = d3_scaleThreshold()\n          .domain(this.domain)\n          .range(colors);\n\n        this.colorDomain = this.colorRange.domain();\n        break;\n\n      case 'quantile':\n        this.colorRange = d3_scaleQuantile()\n          .domain(colorValues)\n          .range(colors);\n\n        this.colorDomain = this.colorRange.quantiles();\n        break;\n\n      case 'quantize':\n        this.colorRange = d3_scaleQuantize()\n          .domain(colorDomain)\n          .range(colors);\n\n        this.colorDomain = this.colorRange.thresholds();\n        break;\n    }\n\n    switch (this.tooltipValueFormatType) {\n      case 'number':\n        this.tooltipValueFormat = d3_format(this.tooltipValueFormatString);\n        break;\n\n      default:\n        this.tooltipValueFormat = null;\n    }\n\n    switch (this.legendValueFormatType) {\n      case 'number':\n        this.legendValueFormat = d3_format(this.legendValueFormatString);\n        break;\n\n      default:\n        this.tooltipValueFormat = null;\n    }\n\n    switch (this.projectionType) {\n      case 'geoAlbers':\n        this.projection = d3_geoAlbers();\n        break;\n\n      case 'geoAlbersUsa':\n        this.projection = d3_geoAlbersUsa();\n        break;\n\n      case 'geoMercator':\n        this.projection = d3_geoMercator();\n        break;\n    }\n\n    this.topojsonFeature = topojson.feature(this.topojson, this.topojson.objects[this.feature]);\n    this.projection.fitSize([+this.width, +this.height], this.topojsonFeature);\n\n    if (this.scale) {\n      this.projection.scale(+this.scale);\n    }\n\n    if (this.center) {\n      this.projection.center(this.center);\n    }\n\n    this.geoPath = d3_geoPath().projection(this.projection);\n\n    // console.log('TOPOJSON: ', this.topojson);\n    // console.log('TOPOJSON FEATURE: ', this.topojsonFeature);\n    // console.log('MESH: ', topojson.mesh(this.topojson, this.topojson.objects[this.feature], (a, b) => a !== b));\n    // console.log('DATA: ', this.data);\n\n    // create the chart\n    this.chart = d3_select(this._element.nativeElement).attr('aria-hidden', 'true');\n\n    // TOOLTIP\n    if (!this.hideTooltip) {\n      this.tooltip = d3_select('body')\n        .append('div')\n        .attr('class', 'pbds-tooltip south')\n        .style('opacity', 0)\n        .attr('aria-hidden', 'true'); // hide tooltip for accessibility\n\n      // tooltip header\n      this.tooltip.append('div').attr('class', 'tooltip-header');\n      this.tooltip.append('div').attr('class', 'tooltip-value');\n    }\n\n    // create chart svg\n    this.svg = this.chart\n      .append('svg')\n      .attr('width', +this.width)\n      .attr('height', +this.height + this.margin.top + this.margin.bottom)\n      .attr('class', 'img-fluid')\n      .attr('preserveAspectRatio', 'xMinYMin meet')\n      .attr(\n        'viewBox',\n        `-${this.margin.left} -${this.margin.top} ${+this.width} ${+this.height + this.margin.top + this.margin.bottom}`\n      );\n\n    // map\n    this.svg\n      .append('g')\n      .attr('class', 'map')\n      .selectAll('path')\n      .data(this.topojsonFeature.features)\n      .enter()\n      .append('path')\n      .attr('class', 'feature')\n      .attr('d', this.geoPath);\n\n    // borders\n    this.svg\n      .append('path')\n      .attr('class', 'mesh')\n      .datum(topojson.mesh(this.topojson, this.topojson.objects[this.mesh || this.feature], (a, b) => a !== b))\n      .attr('d', this.geoPath);\n\n    // legend\n    if (!this.hideLegend) {\n      this.svg\n        .append('g')\n        .attr('transform', `translate(${+this.legendLeft}, ${+this.legendTop})`) // TODO: this needs to be the top/right of the chart\n        .call(this.legend);\n    }\n\n    this.updateChart();\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (changes.data && !changes.data.firstChange) {\n      this.updateChart();\n    }\n  }\n\n  ngOnDestroy() {\n    if (this.tooltip) this.tooltip.remove();\n  }\n\n  updateChart = () => {\n    this.svg\n      .select('.map')\n      .selectAll('path')\n      .style('fill', (d, i) => {\n        const match = this.data.find(obj => obj[this.dataField] === d[this.dataField]);\n        if (match) {\n          return this.colorRange(match.value);\n        }\n      })\n      .classed('hasData', (d, i) => {\n        return this.data.some(obj => obj[this.dataField] === d[this.dataField]);\n      });\n\n    if (!this.hideTooltip) {\n      this.svg\n        .select('.map')\n        .selectAll('path')\n        .on('mouseover', (data, index, nodes) =>\n          this.featureMouseOver(\n            d3_event,\n            this.data.find(obj => obj[this.dataField] === data[this.dataField]),\n            index,\n            nodes\n          )\n        )\n        .on('mouseout', (data, index, nodes) => this.featureMouseOut(d3_event, this.data, index, nodes))\n        .on('mousemove', (data, index, nodes) => this.tooltipMove(this.chart.node()))\n        .on('click', (data, index, nodes) =>\n          this.featureMouseClick(\n            d3_event,\n            this.data.find(obj => obj[this.dataField] === data[this.dataField]),\n            index,\n            nodes\n          )\n        );\n    }\n  };\n\n  featureMouseOver = (event, data, index, nodes) => {\n    if (data) {\n      this.tooltipShow(data, nodes[index]);\n      this.hovered.emit({ event, data });\n    }\n  };\n\n  featureMouseOut = (event, data, index, nodes) => {\n    this.tooltipHide();\n  };\n\n  featureMouseClick = (event, data, index, nodes) => {\n    if (data) {\n      this.clicked.emit({ event, data });\n    }\n  };\n\n  private tooltipShow = (data, node) => {\n    // console.log('TOOLTIP: ', data, node);\n\n    this.tooltipSetPosition(node);\n\n    if (data.label) {\n      this.tooltip.select('.tooltip-header').html(d => `${data.label}`);\n    }\n\n    this.tooltip\n      .select('.tooltip-value')\n      .html(d => (this.tooltipValueFormat ? `${this.tooltipValueFormat(data.value)}` : `${data.value}`));\n\n    this.tooltip.style('opacity', 1);\n  };\n\n  private tooltipHide = () => {\n    this.tooltip.style('opacity', 0);\n  };\n\n  private tooltipMove = node => {\n    this.tooltipSetPosition(node);\n  };\n\n  private tooltipSetPosition = node => {\n    const mouse = d3_mouse(node);\n    const mouseLeft = +mouse[0];\n    const mouseTop = +mouse[1];\n\n    const geometry = node.getBoundingClientRect();\n    const geometryLeft = +geometry.left;\n    const geometryTop = +geometry.top;\n\n    const scroll = this._scroll.getScrollPosition();\n    // const scrollLeft = +scroll[0];\n    const scrollTop = +scroll[1];\n\n    const tooltipOffsetWidth = +this.tooltip.node().offsetWidth / 2;\n    const tooltipOffsetHeight = +this.tooltip.node().offsetHeight;\n\n    this.tooltip.style('top', `${scrollTop + mouseTop + geometryTop - tooltipOffsetHeight - 14}px`);\n    this.tooltip.style('left', `${mouseLeft + geometryLeft - tooltipOffsetWidth}px`);\n  };\n\n  legend = g => {\n    const length = this.colorRange.range().length;\n\n    // console.log(this.colorRange.range().length, this.colorDomain);\n\n    const x = d3_scaleLinear()\n      .domain([1, length - 1])\n      .rangeRound([+this.legendWidth / length, (this.legendWidth * (length - 1)) / length]);\n\n    g.attr('class', 'legend')\n      .selectAll('rect')\n      .data(this.colorRange.range())\n      .join('rect')\n      .attr('height', 8)\n      .attr('x', (d, i) => x(i))\n      .attr('width', (d, i) => x(i + 1) - x(i))\n      .attr('fill', d => d);\n\n    if (this.legendLabel) {\n      g.append('text')\n        .attr('y', -6)\n        .attr('text-anchor', 'start')\n        .attr('class', 'legend-label')\n        .text(this.legendLabel);\n    }\n\n    g.call(\n      d3_axisBottom(x)\n        .tickSize(13)\n        .tickValues(d3_range(1, length))\n        .tickFormat((i: number) =>\n          this.legendValueFormat ? `${this.legendValueFormat(this.colorDomain[i - 1])}` : `${this.colorDomain[i - 1]}`\n        )\n    )\n      .select('.domain')\n      .remove();\n  };\n}\n","import {\n  Component,\n  OnInit,\n  OnChanges,\n  Input,\n  Output,\n  EventEmitter,\n  ElementRef,\n  HostBinding,\n  OnDestroy,\n  SimpleChanges,\n  ChangeDetectionStrategy\n} from '@angular/core';\n\nimport { ViewportScroller, Location } from '@angular/common';\n\nimport {\n  select as d3_select,\n  isoParse as d3_isoParse,\n  timeFormat as d3_timeFormat,\n  format as d3_format,\n  scaleOrdinal as d3_scaleOrdinal,\n  scaleBand as d3_scaleBand,\n  scaleLinear as d3_scaleLinear,\n  max as d3_max,\n  axisBottom as d3_axisBottom,\n  axisLeft as d3_axisLeft,\n  event as d3_event,\n  values as d3_values\n} from 'd3';\n\nimport { PbdsDatavizService } from './dataviz.service';\nimport { PbdsDatavizBarGrouped } from './dataviz.interfaces';\n\n@Component({\n  selector: 'pbds-dataviz-bar-grouped',\n  template: ``,\n  styles: [],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class PbdsDatavizBarGroupedComponent implements OnInit, OnDestroy, OnChanges {\n  @HostBinding('class.pbds-chart')\n  chartClass = true;\n\n  @HostBinding('class.pbds-chart-bar-grouped')\n  groupedBarClass = true;\n\n  @Input()\n  data: Array<PbdsDatavizBarGrouped>;\n\n  @Input()\n  width = 306;\n\n  @Input()\n  height = 400;\n\n  @Input()\n  vertical = true;\n\n  @Input()\n  hideXAxis = false;\n\n  @Input()\n  xAxisMaxBuffer = 0.01;\n\n  @Input()\n  xAxisFormatType: 'number' | 'time' = null;\n\n  @Input()\n  xAxisFormatString = '';\n\n  @Input()\n  xAxisTicks = 5;\n\n  @Input()\n  hideYAxis = false;\n\n  @Input()\n  yAxisMaxBuffer = 0.01;\n\n  @Input()\n  yAxisFormatType: 'number' | 'time' = null;\n\n  @Input()\n  yAxisFormatString = '';\n\n  @Input()\n  yAxisTicks = 5;\n\n  @Input()\n  marginTop = 10;\n\n  @Input()\n  marginRight = this.vertical ? 0 : 55;\n\n  @Input()\n  marginBottom = 30;\n\n  @Input()\n  marginLeft = 55;\n\n  @Input()\n  hideLegend = false;\n\n  @Input()\n  legendWidth = 105 + 28; // hardcoded legend width + left margin, do not document until feedback\n\n  @Input()\n  legendPosition: 'right' | 'bottom' = 'right';\n\n  @Input()\n  legendLabelFormatType: 'number' | 'time' = null;\n\n  @Input()\n  legendLabelFormatString = '';\n\n  @Input()\n  hideTooltip = false;\n\n  @Input()\n  tooltipLabelFormatType: 'number' | 'time' = null;\n\n  @Input()\n  tooltipLabelFormatString = '';\n\n  @Input()\n  tooltipValueFormatType: 'number' = null;\n\n  @Input()\n  tooltipValueFormatString = '';\n\n  @Input()\n  showGrid = false;\n\n  @Input()\n  theme: 'classic' | 'sunset' | 'ocean' | 'twilight' = 'classic';\n\n  @Output()\n  hovered: EventEmitter<object> = new EventEmitter<object>();\n\n  @Output()\n  clicked: EventEmitter<object> = new EventEmitter<object>();\n\n  private barScale;\n  private chart;\n  private svg;\n  private margin;\n  private colorRange;\n  private xAxisMax;\n  private xAxisScale;\n  private xAxisCall;\n  private xAxis;\n  private xAxisTickSize: number;\n  private xAxisTickSizeOuter: number;\n  private xAxisFormat;\n  private hideXAxisDomain: boolean;\n  private hideXAxisZero: boolean;\n  private hideXAxisTicks: boolean;\n  private xGrid;\n  private xGridCall;\n  private yAxisMax;\n  private yAxisScale;\n  private yAxisCall;\n  private yAxis;\n  private yAxisFormat;\n  private yAxisTickSize: number;\n  private yAxisTickSizeOuter: number;\n  private hideYAxisZero: boolean;\n  private hideYAxisDomain: boolean;\n  private hideYAxisTicks: boolean;\n  private yGrid;\n  private yGridCall;\n  private legendLabelFormat;\n  private hideGrayBars: boolean;\n  private tooltip;\n  private tooltipValueFormat;\n  private tooltipLabelFormat;\n\n  constructor(\n    private _dataviz: PbdsDatavizService,\n    private _element: ElementRef,\n    private _scroll: ViewportScroller,\n    private _location: Location\n  ) {}\n\n  ngOnInit() {\n    this.margin = {\n      top: +this.marginTop,\n      right: +this.marginRight,\n      bottom: +this.marginBottom,\n      left: +this.marginLeft\n    };\n\n    switch (this.xAxisFormatType) {\n      case 'number':\n        this.xAxisFormat = d3_format(this.xAxisFormatString);\n        break;\n      case 'time':\n        this.xAxisFormat = d3_timeFormat(this.xAxisFormatString);\n        break;\n    }\n\n    switch (this.yAxisFormatType) {\n      case 'number':\n        this.yAxisFormat = d3_format(this.yAxisFormatString);\n        break;\n      case 'time':\n        this.yAxisFormat = d3_timeFormat(this.yAxisFormatString);\n        break;\n    }\n\n    switch (this.legendLabelFormatType) {\n      case 'number':\n        this.legendLabelFormat = d3_format(this.legendLabelFormatString);\n        break;\n      case 'time':\n        this.legendLabelFormat = d3_timeFormat(this.legendLabelFormatString);\n        break;\n      default:\n        this.legendLabelFormat = null;\n        break;\n    }\n\n    switch (this.tooltipLabelFormatType) {\n      case 'time':\n        this.tooltipLabelFormat = d3_timeFormat(this.tooltipLabelFormatString);\n        break;\n      default:\n        this.tooltipLabelFormat = null;\n        break;\n    }\n\n    switch (this.tooltipValueFormatType) {\n      case 'number':\n        this.tooltipValueFormat = d3_format(this.tooltipValueFormatString);\n        break;\n      default:\n        this.tooltipValueFormat = null;\n    }\n\n    // defaults for all chart types\n    this.hideGrayBars = false;\n    this.hideXAxisZero = false;\n    this.hideXAxisDomain = false;\n    this.hideXAxisTicks = true;\n    this.xAxisTickSize = 8;\n    this.xAxisTickSizeOuter = 0;\n    this.hideYAxisZero = false;\n    this.hideYAxisDomain = false;\n    this.hideYAxisTicks = true;\n    this.yAxisTickSize = 8;\n    this.yAxisTickSizeOuter = 0;\n\n    if (!this.hideLegend && this.legendPosition === 'right') {\n      this.width = +this.width - +this.legendWidth;\n    }\n\n    // create the chart\n    this.chart = d3_select(this._element.nativeElement).attr('aria-hidden', 'true');\n\n    // create chart svg\n    this.svg = this.chart\n      .append('svg')\n      .attr('width', () => {\n        if (this.vertical) {\n          return +this.width;\n        } else {\n          return +this.width + this.margin.left + this.margin.right;\n        }\n      })\n      .attr('height', +this.height + this.margin.top + this.margin.bottom)\n      .attr('class', 'img-fluid')\n      .attr('preserveAspectRatio', 'xMinYMin meet')\n      .attr('viewBox', () => {\n        if (this.vertical) {\n          return `-${this.margin.left} -${this.margin.top} ${+this.width} ${+this.height +\n            this.margin.top +\n            this.margin.bottom}`;\n        } else {\n          return `-${this.margin.left} -${this.margin.top} ${+this.width + this.margin.left + this.margin.right} ${+this\n            .height +\n            this.margin.top +\n            this.margin.bottom}`;\n        }\n      });\n\n    // TOOLTIP\n    if (!this.hideTooltip) {\n      this.tooltip = d3_select('body')\n        .append('div')\n        .attr('class', () => {\n          return this.vertical ? 'pbds-tooltip south' : 'pbds-tooltip west';\n        })\n        .style('opacity', 0)\n        .attr('aria-hidden', 'true'); // hide tooltip for accessibility\n    }\n\n    // add legend classes\n    if (!this.hideLegend) {\n      this.chart.classed('pbds-chart-legend-bottom', this.legendPosition === 'bottom' ? true : false);\n      this.chart.append('ul').attr('class', `legend legend-${this.legendPosition}`);\n    }\n\n    // build color ranges\n    this.colorRange = d3_scaleOrdinal().range(\n      this._dataviz.createGradientDefs(this.svg, false, this.theme, this.vertical)\n    );\n\n    if (this.vertical) {\n      // X AXIS\n      this.xAxisScale = d3_scaleBand()\n        .domain(this.data.map(d => d.key))\n        .rangeRound([0, this.width - this.margin.left])\n        .align(0);\n\n      // add padding to the scale for gray bars\n      !this.hideGrayBars\n        ? this.xAxisScale.paddingInner(0.1).paddingOuter(0)\n        : this.xAxisScale.paddingInner(0).paddingOuter(0);\n\n      this.xAxisCall = d3_axisBottom(this.xAxisScale)\n        .tickSize(this.xAxisTickSize)\n        .tickSizeOuter(this.xAxisTickSizeOuter)\n        .tickFormat(this.xAxisFormatter);\n\n      this.xAxis = this.svg\n        .append('g')\n        .attr('class', 'axis axis-x')\n        .attr('transform', `translate(0, ${this.height})`)\n        .classed('axis-hidden', this.hideXAxis)\n        .classed('axis-zero-hidden', this.hideXAxisZero)\n        .classed('axis-domain-hidden', this.hideXAxisDomain)\n        .classed('axis-ticks-hidden', this.hideXAxisTicks)\n        .call(this.xAxisCall);\n\n      // X GRIDLINES\n      // if (!this.hideXGrid) {\n      //   this.xGridCall = d3_axisBottom(this.xAxisScale).tickSize(-this.height);\n\n      //   this.xGrid = this.svg\n      //     .append('g')\n      //     .attr('class', 'grid grid-x')\n      //     .classed('grid-zero-hidden', this.hideXAxisZero)\n      //     .attr('transform', `translate(0, ${this.height})`)\n      //     .call(this.xGridCall);\n      // }\n\n      // Y AXIS\n      this.yAxisMax = d3_max(this.data, (data: any) => {\n        const clone = { ...data };\n        delete clone.key;\n\n        return d3_max(d3_values(clone));\n      });\n\n      this.yAxisMax = this.yAxisMax + this.yAxisMax * this.yAxisMaxBuffer;\n\n      this.yAxisScale = d3_scaleLinear()\n        .domain([0, this.yAxisMax])\n        .nice()\n        .rangeRound([this.height, 0]);\n\n      this.yAxisCall = d3_axisLeft(this.yAxisScale)\n        .ticks(this.yAxisTicks)\n        .tickSize(this.yAxisTickSize)\n        .tickSizeOuter(this.yAxisTickSizeOuter)\n        .tickFormat(this.yAxisFormatter);\n\n      this.yAxis = this.svg\n        .append('g')\n        .attr('class', 'axis axis-y')\n        .classed('axis-hidden', this.hideYAxis)\n        .classed('axis-zero-hidden', this.hideYAxisZero)\n        .classed('axis-domain-hidden', this.hideYAxisDomain)\n        .classed('axis-ticks-hidden', this.hideYAxisTicks)\n        .call(this.yAxisCall);\n\n      // Y GRIDLINES\n      if (this.showGrid) {\n        this.yGridCall = d3_axisLeft(this.yAxisScale)\n          .ticks(this.yAxisTicks)\n          .tickSize(-this.width + this.margin.left + this.margin.right);\n\n        this.yGrid = this.svg\n          .append('g')\n          .attr('class', 'grid grid-y')\n          .classed('grid-zero-hidden', this.hideYAxisZero)\n          .attr('transform', `translate(0, 0)`)\n          .call(this.yGridCall);\n      }\n\n      // color bar scale\n      this.barScale = d3_scaleBand()\n        .domain(Object.keys(this.data[0]).slice(1))\n        .rangeRound([0, this.xAxisScale.bandwidth()])\n        .paddingInner(0.2)\n        .paddingOuter(0.5);\n\n      this.updateChartVertical();\n    } else {\n      // X AXIS\n      this.xAxisMax = d3_max(this.data, (data: any) => {\n        const clone = { ...data };\n        delete clone.key;\n        return d3_max(d3_values(clone));\n      });\n\n      this.xAxisMax = this.xAxisMax + this.xAxisMax * this.xAxisMaxBuffer;\n\n      this.xAxisScale = d3_scaleLinear()\n        .domain([0, this.xAxisMax])\n        .rangeRound([0, this.width])\n        .nice();\n\n      this.xAxisCall = d3_axisBottom(this.xAxisScale)\n        .ticks(this.xAxisTicks)\n        .tickSize(this.xAxisTickSize)\n        .tickSizeOuter(this.xAxisTickSizeOuter)\n        .tickFormat(this.xAxisFormatter);\n\n      this.xAxis = this.svg\n        .append('g')\n        .attr('class', 'axis axis-x')\n        .attr('transform', `translate(0, ${this.height})`)\n        .classed('axis-hidden', this.hideXAxis)\n        .classed('axis-zero-hidden', this.hideXAxisZero)\n        .classed('axis-domain-hidden', this.hideXAxisDomain)\n        .classed('axis-ticks-hidden', this.hideXAxisTicks)\n        .call(this.xAxisCall);\n\n      // Y AXIS\n      this.yAxisScale = d3_scaleBand()\n        .domain(this.data.map(d => d.key))\n        .rangeRound([0, this.height])\n        .align(1);\n\n      // add padding to the scale for gray bars\n      !this.hideGrayBars\n        ? this.yAxisScale.paddingInner(0.1).paddingOuter(0)\n        : this.yAxisScale.paddingInner(0).paddingOuter(0);\n\n      this.yAxisCall = d3_axisLeft(this.yAxisScale)\n        .tickSize(this.yAxisTickSize)\n        .tickSizeOuter(this.yAxisTickSizeOuter)\n        .tickFormat(this.yAxisFormatter);\n\n      this.yAxis = this.svg\n        .append('g')\n        .attr('class', 'axis axis-y')\n        .classed('axis-hidden', this.hideYAxis)\n        .classed('axis-zero-hidden', this.hideYAxisZero)\n        .classed('axis-domain-hidden', this.hideYAxisDomain)\n        .classed('axis-ticks-hidden', this.hideYAxisTicks)\n        .call(this.yAxisCall);\n\n      // X GRIDLINES\n      if (this.showGrid) {\n        this.xGridCall = d3_axisBottom(this.xAxisScale).tickSize(-this.height);\n        this.xGrid = this.svg\n          .append('g')\n          .attr('class', 'grid grid-x')\n          .classed('grid-zero-hidden', this.hideXAxisZero)\n          .attr('transform', `translate(0, ${this.height})`)\n          .call(this.xGridCall);\n      }\n\n      // Y GRIDLINES\n      // if (!this.hideYGrid) {\n      //   this.yGridCall = d3_axisLeft(this.yAxisScale)\n      //     .ticks(this.yAxisTicks)\n      //     .tickSize(-this.width);\n\n      //   this.yGrid = this.svg\n      //     .append('g')\n      //     .attr('class', 'grid grid-y')\n      //     .classed('grid-zero-hidden', this.hideYAxisZero)\n      //     .attr('transform', `translate(0, 0)`)\n      //     .call(this.yGridCall);\n      // }\n\n      // color bar scale\n      this.barScale = d3_scaleBand()\n        .domain(Object.keys(this.data[0]).slice(1))\n        .rangeRound([this.yAxisScale.bandwidth(), 0])\n        .paddingInner(0.2)\n        .paddingOuter(0.5);\n\n      this.updateChartHorizontal();\n    }\n  }\n\n  ngOnDestroy() {\n    if (this.tooltip) this.tooltip.remove();\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (changes.data && !changes.data.firstChange) {\n      if (this.vertical) {\n        this.updateChartVertical();\n      } else {\n        this.updateChartHorizontal();\n      }\n    }\n  }\n\n  updateChartVertical() {\n    // update the xScale\n    this.xAxisScale.domain(this.data.map(d => d.key));\n\n    // update the yScale\n    this.yAxisMax = d3_max(this.data, (data: any) => {\n      const clone = { ...data };\n      delete clone.key;\n\n      return d3_max(d3_values(clone));\n    });\n\n    this.yAxisMax = this.yAxisMax + this.yAxisMax * this.yAxisMaxBuffer;\n\n    this.yAxisScale\n      .domain([0, this.yAxisMax])\n      .rangeRound([this.height, 0])\n      .nice();\n\n    this.xAxis\n      .transition()\n      .duration(1000)\n      .call(this.xAxisCall);\n\n    this.yAxis\n      .transition()\n      .duration(1000)\n      .call(this.yAxisCall);\n\n    // update the grids\n    // if (!this.hideXGrid) {\n    //   this.xGrid\n    //     .transition()\n    //     .duration(1000)\n    //     .call(this.xGridCall);\n    // }\n\n    if (this.showGrid) {\n      this.yGrid\n        .transition()\n        .duration(1000)\n        .call(this.yGridCall);\n    }\n\n    // update the color bar scale\n    this.barScale.domain(Object.keys(this.data[0]).slice(1)).rangeRound([0, this.xAxisScale.bandwidth()]);\n\n    this.svg\n      .selectAll('.gray-bar')\n      .data(this.data)\n      .join(\n        enter =>\n          enter\n            .append('rect')\n            .attr('class', 'gray-bar')\n            .attr('x', d => this.xAxisScale(d.key))\n            .attr('y', d => this.yAxisScale(d.value))\n            .attr('width', this.xAxisScale.bandwidth())\n            .attr('height', this.height),\n        update =>\n          update\n            .transition()\n            .duration(1000)\n            .attr('x', d => this.xAxisScale(d.key))\n            .attr('y', d => this.yAxisScale(d.value))\n            .attr('width', this.xAxisScale.bandwidth())\n            .attr('height', this.height)\n      );\n\n    this.svg\n      .selectAll('.bar-group')\n      .data(this.data)\n      .join(\n        enter =>\n          enter\n            .append('g')\n            .attr('class', 'bar-group')\n            .attr('transform', (d, i) => {\n              return `translate(${this.xAxisScale(d.key)}, 0)`;\n            }),\n        update =>\n          update\n            .transition()\n            .duration(1000)\n            .attr('transform', (d, i) => {\n              return `translate(${this.xAxisScale(d.key)}, 0)`;\n            })\n      );\n\n    this.svg\n      .selectAll('.bar-group')\n      .selectAll('.bar')\n      .data((d, i) => {\n        const clone = { ...d };\n        delete clone.key;\n\n        const keys = Object.keys(clone);\n\n        const keyData = keys.map(function(key) {\n          return { label: key, value: d[key], parentIndex: i };\n        });\n\n        return keyData;\n      })\n      .join(\n        enter =>\n          enter\n            .append('rect')\n            .attr('class', 'bar')\n            .attr('fill', d => `url(${this._location.path()}#gradient-${this.colorRange(d.label).substr(1)})`)\n            .attr('data-color', d => this.colorRange(d.label))\n            .attr('data-parent-index', d => d.parentIndex)\n            .attr('x', d => this.barScale(d.label))\n            .attr('width', this.barScale.bandwidth())\n            .attr('y', this.height)\n            .attr('height', 0)\n            .call(enter => {\n              return enter\n                .attr('pointer-events', 'none')\n                .transition()\n                .duration(0) // 500\n                .attr('height', d => this.height - this.yAxisScale(d.value))\n                .attr('y', d => this.yAxisScale(d.value))\n                .transition()\n                .attr('pointer-events', 'auto');\n            }),\n        update =>\n          update\n            .attr('pointer-events', 'none')\n            .transition()\n            .duration(1000)\n            .attr('x', d => this.barScale(d.label))\n            .attr('width', this.barScale.bandwidth())\n            .attr('height', d => this.height - this.yAxisScale(d.value))\n            .attr('y', d => this.yAxisScale(d.value))\n            .transition()\n            .attr('pointer-events', 'auto'),\n        exit =>\n          exit\n            .transition()\n            .duration(0) // 100\n            .attr('pointer-events', 'none')\n            .attr('height', 0)\n            .attr('y', this.height)\n      )\n      .on('mouseover', (data, index, nodes) => this.barMouseOver(d3_event, data, index, nodes))\n      .on('mouseout', (data, index, nodes) => this.barMouseOut())\n      .on('click', (data, index, nodes) => this.barMouseClick(d3_event, data, index, nodes));\n\n    this.updateLegend();\n\n    this.svg.selectAll('.axis').raise();\n  }\n\n  updateChartHorizontal() {\n    // update the xScale\n    this.xAxisMax = d3_max(this.data, (data: any) => {\n      const clone = { ...data };\n      delete clone.key;\n      return d3_max(d3_values(clone));\n    });\n\n    this.xAxisMax = this.xAxisMax + this.xAxisMax * this.xAxisMaxBuffer;\n\n    this.xAxisScale\n      .domain([0, this.xAxisMax])\n      .rangeRound([0, this.width])\n      .nice();\n\n    // update the yScale\n    this.yAxisScale.domain(this.data.map(d => d.key));\n\n    this.xAxis\n      .transition()\n      .duration(1000)\n      .call(this.xAxisCall);\n\n    this.yAxis\n      .transition()\n      .duration(1000)\n      .call(this.yAxisCall);\n\n    // update the grids\n    if (this.showGrid) {\n      this.xGrid\n        .transition()\n        .duration(1000)\n        .call(this.xGridCall);\n    }\n\n    // if (!this.hideYGrid) {\n    //   this.yGrid\n    //     .transition()\n    //     .duration(1000)\n    //     .call(this.yGridCall);\n    // }\n\n    // update the color bar scale\n    this.barScale.domain(Object.keys(this.data[0]).slice(1)).rangeRound([0, this.yAxisScale.bandwidth()]);\n\n    this.svg\n      .selectAll('.gray-bar')\n      .data(this.data)\n      .join(\n        enter =>\n          enter\n            .append('rect')\n            .attr('class', 'gray-bar')\n            .attr('y', d => this.yAxisScale(d.key))\n            .attr('width', this.width)\n            .attr('height', this.yAxisScale.bandwidth()),\n        update =>\n          update\n            .transition()\n            .duration(1000)\n            .attr('y', d => this.yAxisScale(d.key))\n            .attr('width', this.width)\n            .attr('height', this.yAxisScale.bandwidth())\n      );\n\n    this.svg\n      .selectAll('.bar-group')\n      .data(this.data)\n      .join(\n        enter =>\n          enter\n            .append('g')\n            .attr('class', 'bar-group')\n            .attr('transform', (d, i) => {\n              return `translate(0, ${this.yAxisScale(d.key)})`;\n            }),\n        update =>\n          update\n            .transition()\n            .duration(1000)\n            .attr('transform', (d, i) => {\n              return `translate(0, ${this.yAxisScale(d.key)})`;\n            })\n      );\n\n    this.svg\n      .selectAll('.bar-group')\n      .selectAll('.bar')\n      .data((d, i) => {\n        const clone = { ...d };\n        delete clone.key;\n\n        const keys = Object.keys(clone);\n\n        const keyData = keys.map(function(key) {\n          return { label: key, value: d[key], parentIndex: i };\n        });\n\n        return keyData;\n      })\n      .join(\n        enter =>\n          enter\n            .append('rect')\n            .attr('class', 'bar')\n            .attr(\n              'fill',\n              d => `url(${this._location.path()}#gradient-horizontal-${this.colorRange(d.label).substr(1)})`\n            )\n            .attr('data-color', d => this.colorRange(d.label))\n            .attr('data-parent-index', d => d.parentIndex)\n            .attr('x', 0)\n            .attr('width', 0)\n            .attr('y', d => this.barScale(d.label))\n            .attr('height', this.barScale.bandwidth())\n            .call(enter => {\n              return enter\n                .attr('pointer-events', 'none')\n                .transition()\n                .duration(0) // 500\n                .attr('width', d => this.xAxisScale(d.value))\n                .transition()\n                .attr('pointer-events', 'auto');\n            }),\n        update =>\n          update\n            .attr('pointer-events', 'none')\n            .transition()\n            .duration(1000)\n            .attr('width', d => this.xAxisScale(d.value))\n            .attr('height', this.barScale.bandwidth())\n            .attr('y', d => this.barScale(d.label))\n            .transition()\n            .attr('pointer-events', 'auto'),\n        exit =>\n          exit\n            .transition()\n            .duration(0) // 100\n            .attr('pointer-events', 'none')\n            .attr('width', 0)\n      )\n      .on('mouseover', (data, index, nodes) => this.barMouseOver(d3_event, data, index, nodes))\n      .on('mouseout', (data, index, nodes) => this.barMouseOut())\n      .on('click', (data, index, nodes) => this.barMouseClick(d3_event, data, index, nodes));\n\n    this.updateLegend();\n\n    this.svg.selectAll('.axis').raise();\n  }\n\n  updateLegend() {\n    // legend\n    if (!this.hideLegend) {\n      const legendData = { ...this.data[0] };\n      delete legendData.key;\n      const legendKeys = Object.keys(legendData).map(function(key) {\n        return { label: key };\n      });\n\n      this.chart\n        .select('.legend')\n        .selectAll('.legend-item')\n        .data(legendKeys)\n        .join(\n          enter => {\n            const li = enter.append('li').attr('class', 'legend-item');\n\n            li.insert('span')\n              .attr('class', 'legend-key')\n              .style('background-color', d => this.colorRange(d.label));\n\n            li.insert('span', '.legend-item')\n              .attr('class', 'legend-label')\n              .html(d => {\n                switch (this.legendLabelFormatType) {\n                  case 'number':\n                    return this.legendLabelFormat(d.label);\n\n                  case 'time':\n                    const parsedTime = d3_isoParse(d.label);\n                    return this.legendLabelFormat(parsedTime);\n\n                  default:\n                    return d.label;\n                }\n              });\n\n            return li;\n          },\n          update => {\n            update.select('.legend-label').html(d => {\n              switch (this.legendLabelFormatType) {\n                case 'number':\n                  return this.legendLabelFormat(d.label);\n\n                case 'time':\n                  const parsedTime = d3_isoParse(d.label);\n                  return this.legendLabelFormat(parsedTime);\n\n                default:\n                  return d.label;\n              }\n            });\n\n            return update;\n          },\n          exit => exit.remove()\n        )\n        .on('mouseover', (data, index, nodes) => this.legendMouseOver(d3_event, data, index, nodes))\n        .on('mouseout', () => this.legendMouseOut())\n        .on('click', (data, index, nodes) => this.legendMouseClick(d3_event, data, index, nodes));\n    }\n  }\n\n  barMouseOver = (event, data, index, nodes) => {\n    const node = d3_select(nodes[index]);\n\n    this.chart\n      .selectAll('.bar-group')\n      .selectAll('.bar')\n      .classed('inactive', true);\n\n    node.classed('inactive', false).style('fill', node.attr('data-color'));\n\n    this.tooltipShow(data, nodes[index]);\n\n    this.hovered.emit({ event, data });\n  };\n\n  barMouseOut = () => {\n    this.chart\n      .selectAll('.bar')\n      .classed('inactive', false)\n      .style('fill', null);\n\n    this.tooltipHide();\n  };\n\n  barMouseClick = (event, data, index, nodes) => {\n    this.clicked.emit({ event, data });\n  };\n\n  legendMouseOver = (event, data, index, nodes) => {\n    this.chart\n      .selectAll('.legend-item')\n      .filter((d, i) => i !== index)\n      .classed('inactive', true);\n\n    this.chart\n      .selectAll('.bar-group')\n      .selectAll('.bar')\n      .filter((d, i) => i !== index)\n      .classed('inactive', true);\n\n    const bar = this.chart\n      .selectAll('.bar-group')\n      .selectAll('.bar')\n      .filter((d, i) => i === index)\n      .classed('inactive', null);\n\n    const barColor = bar.attr('data-color');\n\n    bar.style('fill', () => barColor);\n\n    this.hovered.emit({ event, data });\n  };\n\n  legendMouseOut = () => {\n    this.chart.selectAll('.legend-item').classed('inactive', false);\n\n    this.chart\n      .selectAll('.bar-group')\n      .selectAll('.bar')\n      .classed('inactive', false)\n      .style('fill', null);\n  };\n\n  legendMouseClick = (event, data, index, nodes) => {\n    this.clicked.emit({ event, data });\n  };\n\n  private tooltipShow = (data, node) => {\n    const dimensions = node.getBoundingClientRect();\n    const scroll = this._scroll.getScrollPosition();\n    let label;\n\n    switch (this.tooltipLabelFormatType) {\n      case 'number':\n        label = this.tooltipLabelFormat(data.label);\n        break;\n\n      case 'time':\n        const parsedTime = d3_isoParse(data.label);\n        label = this.tooltipLabelFormat(parsedTime);\n        break;\n\n      default:\n        label = data.label;\n    }\n\n    const value =\n      this.tooltipValueFormat === null\n        ? `<div class=\"tooltip-value\">${data.value}</div>`\n        : `<div class=\"tooltip-value\">${this.tooltipValueFormat(data.value)}</div>`;\n\n    this.tooltip.html(\n      `\n        ${label}\n        ${value}\n      `\n    );\n\n    const tooltipOffsetWidth = +this.tooltip.node().offsetWidth / 2;\n    const tooltipOffsetHeight = +this.tooltip.node().offsetHeight;\n    const tooltipTipSize = 8;\n\n    if (this.vertical) {\n      this.tooltip.style('top', `${+scroll[1] + +dimensions.top - tooltipOffsetHeight - tooltipTipSize}px`);\n      this.tooltip.style('left', `${+scroll[0] + +dimensions.left - tooltipOffsetWidth + +dimensions.width / 2}px`);\n    } else {\n      this.tooltip.style('top', `${+scroll[1] + +dimensions.top + +dimensions.height / 2 - tooltipOffsetHeight / 2}px`);\n      this.tooltip.style('left', `${+scroll[0] + +dimensions.right + tooltipTipSize}px`);\n    }\n\n    this.tooltip.style('opacity', 1);\n  };\n\n  private tooltipHide = () => {\n    this.tooltip.style('opacity', 0);\n  };\n\n  private xAxisFormatter = item => {\n    switch (this.xAxisFormatType) {\n      case 'number':\n        return this.xAxisFormat(item);\n\n      case 'time':\n        const parseDate = d3_isoParse(item);\n        return this.xAxisFormat(parseDate);\n\n      default:\n        return item;\n    }\n  };\n\n  private yAxisFormatter = item => {\n    switch (this.yAxisFormatType) {\n      case 'number':\n        return this.yAxisFormat(item);\n\n      case 'time':\n        const parseDate = d3_isoParse(item);\n        return this.yAxisFormat(parseDate);\n\n      default:\n        return item;\n    }\n  };\n}\n","import {\n  Component,\n  OnInit,\n  Input,\n  ElementRef,\n  HostBinding,\n  OnChanges,\n  SimpleChanges,\n  Output,\n  EventEmitter,\n  ChangeDetectionStrategy,\n  OnDestroy\n} from '@angular/core';\n\nimport { ViewportScroller, Location } from '@angular/common';\n\nimport {\n  select as d3_select,\n  scaleLinear as d3_scaleLinear,\n  scaleOrdinal as d3_scaleOrdinal,\n  format as d3_format,\n  event as d3_event,\n  timeFormat as d3_timeFormat,\n  isoParse as d3_isoParse,\n  sum as d3_sum,\n  axisBottom as d3_axisBottom,\n  easeLinear as d3_easeLinear\n} from 'd3';\n\nimport { PbdsDatavizService } from './dataviz.service';\nimport { PbdsDatavizBarSingleHorizontal, PbdsDatavizBarSingleHorizontalCompare } from './dataviz.interfaces';\n\n@Component({\n  selector: 'pbds-dataviz-bar-single-horizontal',\n  template: ``,\n  styles: [],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class PbdsDatavizBarSingleHorizontalComponent implements OnInit, OnDestroy, OnChanges {\n  @HostBinding('class.pbds-chart')\n  chartClass = true;\n\n  @HostBinding('class.pbds-chart-bar-single-horizontal')\n  singleStackedBarClass = true;\n\n  @Input()\n  data: Array<PbdsDatavizBarSingleHorizontal | PbdsDatavizBarSingleHorizontalCompare>;\n\n  @Input()\n  width = 300;\n\n  @Input()\n  height = 40;\n\n  @Input()\n  nullValueText = 'No data available';\n\n  @Input()\n  percentage = false;\n\n  @Input()\n  marginTop = 10;\n\n  @Input()\n  marginRight = 20;\n\n  @Input()\n  marginBottom = 35;\n\n  @Input()\n  marginLeft = 15;\n\n  @Input()\n  barMargin = 2;\n\n  @Input()\n  hideXAxis = false;\n\n  @Input()\n  xAxisTicks = 6;\n\n  @Input()\n  xAxisTitle: string | null = null;\n\n  @Input()\n  xAxisFormatType: 'number' = null;\n\n  @Input()\n  xAxisFormatString = '';\n\n  @Input()\n  xAxisTickLabelSuffix = '';\n\n  @Input()\n  hideXGrid = false;\n\n  @Input()\n  hideLegend = false;\n\n  @Input()\n  hideLegendTooltip = true;\n\n  @Input()\n  legendWidth = 105 + 28; // hardcoded legend width + left margin, do not document until feedback\n\n  @Input()\n  legendPosition: 'right' | 'bottom' = 'bottom';\n\n  @Input()\n  legendLabelFormatType: 'number' | 'time' = null;\n\n  @Input()\n  legendLabelFormatString = '';\n\n  @Input()\n  hideTooltip = false;\n\n  @Input()\n  tooltipLabelFormatType: 'number' | 'time' = null;\n\n  @Input()\n  tooltipLabelFormatString = '';\n\n  @Input()\n  tooltipDateFormatString = '%b %e, %Y';\n\n  @Input()\n  tooltipValueFormatType: 'number' = null;\n\n  @Input()\n  tooltipValueFormatString = '';\n\n  @Input()\n  tooltipValueSuffix = '';\n\n  @Input()\n  tooltipPercentFormatString = '.2%';\n\n  @Input()\n  compareChangeFormatString = '.2%';\n\n  @Input()\n  monochrome = false;\n\n  @Input()\n  theme: 'classic' | 'ocean' | 'sunset' | 'twilight';\n\n  @Output()\n  hovered: EventEmitter<object> = new EventEmitter<object>();\n\n  @Output()\n  clicked: EventEmitter<object> = new EventEmitter<object>();\n\n  private isSingleData = false;\n  private isCompare = false;\n  private chart;\n  private svg;\n  private margin;\n  private colorRange;\n  private barPadding = 40;\n  private xAxisCall;\n  private xAxis;\n  private xAxisScale;\n  private xAxisTickSize: number;\n  private xAxisTickSizeOuter: number;\n  private xAxisFormat;\n  private xAxisTitleMargin: number;\n  private hideXAxisDomain: boolean;\n  private hideXAxisZero: boolean;\n  private hideXAxisTicks: boolean;\n  private xGrid;\n  private xGridCall;\n  private legendLabelFormat;\n  private tooltip;\n  private tooltipLabelFormat;\n  private tooltipValueFormat;\n  private tooltipDateFormat;\n  private tooltipPercentFormat;\n  private tooltipCompareChangeFormat;\n\n  constructor(\n    private _dataviz: PbdsDatavizService,\n    private _element: ElementRef,\n    private _scroll: ViewportScroller,\n    private _location: Location\n  ) {}\n\n  ngOnInit() {\n    this.height = +this.height + this.barPadding;\n\n    this.margin = {\n      top: +this.marginTop,\n      right: +this.marginRight,\n      bottom: +this.marginBottom,\n      left: +this.marginLeft\n    };\n\n    this.isSingleData = this.data.length === 1 ? true : false;\n    this.isCompare = Object.keys(this.data[0]).includes('compareValue');\n\n    switch (this.xAxisFormatType) {\n      case 'number':\n        this.xAxisFormat = d3_format(this.xAxisFormatString);\n        break;\n    }\n\n    switch (this.legendLabelFormatType) {\n      case 'number':\n        this.legendLabelFormat = d3_format(this.legendLabelFormatString);\n        break;\n      case 'time':\n        this.legendLabelFormat = d3_timeFormat(this.legendLabelFormatString);\n        break;\n      default:\n        this.legendLabelFormat = null;\n        break;\n    }\n\n    switch (this.tooltipValueFormatType) {\n      case 'number':\n        this.tooltipValueFormat = d3_format(this.tooltipValueFormatString);\n        break;\n      default:\n        this.tooltipValueFormat = null;\n    }\n\n    this.tooltipDateFormat = d3_timeFormat(this.tooltipDateFormatString);\n    this.tooltipPercentFormat = d3_format(this.tooltipPercentFormatString);\n    this.tooltipCompareChangeFormat = d3_format(this.compareChangeFormatString);\n\n    // defaults for all chart types\n    this.hideXAxisZero = false;\n    this.hideXAxisDomain = true;\n    this.hideXAxisTicks = true;\n    this.xAxisTickSize = 8;\n    this.xAxisTickSizeOuter = 0;\n    this.xAxisTitleMargin = this.xAxisTitle ? 20 : 0;\n\n    if (!this.hideLegend && this.legendPosition === 'right') {\n      this.width = +this.width - +this.legendWidth;\n    }\n\n    // create the chart\n    this.chart = d3_select(this._element.nativeElement).attr('aria-hidden', 'true');\n\n    // create chart svg\n    this.svg = this.chart\n      .append('svg')\n      .attr('width', () => {\n        return +this.width + this.margin.left + this.margin.right;\n      })\n      .attr('height', +this.height + this.margin.top + this.margin.bottom + this.xAxisTitleMargin)\n      .attr('class', 'img-fluid')\n      .attr('preserveAspectRatio', 'xMinYMin meet')\n      .attr('viewBox', () => {\n        return `-${this.margin.left} -${this.margin.top} ${+this.width + this.margin.left + this.margin.right} ${+this\n          .height +\n          this.margin.top +\n          this.margin.bottom +\n          this.xAxisTitleMargin}`;\n      });\n\n    // TOOLTIP\n    if (!this.hideTooltip) {\n      this.tooltip = d3_select('body')\n        .append('div')\n        .attr('class', 'pbds-tooltip south')\n        .classed('pbds-tooltip-compare', this.isCompare)\n        .style('opacity', 0)\n        .attr('aria-hidden', 'true'); // hide tooltip for accessibility\n    }\n\n    // add legend classes\n    if (!this.hideLegend && this.data.length > 1) {\n      this.chart.classed('pbds-chart-legend-bottom', this.legendPosition === 'bottom' ? true : false);\n      this.chart.append('ul').attr('class', `legend legend-${this.legendPosition}`);\n    }\n\n    // X AXIS\n    this.xAxisScale = d3_scaleLinear()\n      .domain([0, Math.ceil(d3_sum(this.data, (d: any) => d.value))])\n      .range([0, +this.width]);\n\n    this.xAxisCall = d3_axisBottom(this.xAxisScale)\n      // .tickValues([0, d3_sum(this.data, (d: any) => d.value)])\n      .ticks(this.xAxisTicks)\n      .tickSize(this.xAxisTickSize)\n      .tickSizeOuter(this.xAxisTickSizeOuter)\n      .tickFormat(this.xAxisFormatter);\n\n    this.xAxis = this.svg\n      .append('g')\n      .attr('class', 'axis axis-x')\n      .attr('transform', `translate(0, ${this.height})`)\n      .classed('axis-hidden', this.hideXAxis)\n      .classed('axis-zero-hidden', this.hideXAxisZero)\n      .classed('axis-domain-hidden', this.hideXAxisDomain)\n      .classed('axis-ticks-hidden', this.hideXAxisTicks);\n    // .call(this.xAxisCall);\n\n    // X GRIDLINES\n    if (!this.hideXGrid) {\n      this.xGridCall = d3_axisBottom(this.xAxisScale).tickSize(-this.height);\n\n      this.xGrid = this.svg\n        .append('g')\n        .attr('class', 'grid grid-x')\n        .classed('grid-zero-hidden', this.hideXAxisZero)\n        .attr('transform', `translate(0, ${this.height})`)\n        .call(this.xGridCall);\n    }\n\n    if (this.xAxisTitle) {\n      this.svg\n        .append('text')\n        .attr('class', 'axis-title')\n        .attr('text-anchor', 'center')\n        .attr('x', this.width / 2 - this.margin.left)\n        .attr('y', this.height + this.margin.top + (!this.hideXAxis ? 40 : 0))\n        .text(this.xAxisTitle);\n    }\n\n    // build color ranges\n    let colors;\n\n    if (this.isSingleData) {\n      colors = this._dataviz.createGradientDefs(this.svg, this.monochrome, this.theme, false);\n    } else if (this.monochrome) {\n      colors = this._dataviz.getColors(this.monochrome, this.theme).reverse();\n    } else {\n      colors = this._dataviz.getColors(this.monochrome, this.theme);\n    }\n\n    this.colorRange = d3_scaleOrdinal().range(colors);\n\n    this.updateChart();\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (changes.data && !changes.data.firstChange) {\n      this.updateChart();\n    }\n  }\n\n  ngOnDestroy() {\n    if (this.tooltip) this.tooltip.remove();\n  }\n\n  updateChart() {\n    const sumValues = d3_sum(this.data, (d: any) => d.value);\n    const isLastBarZero =\n      this.data[this.data.length - 1].value === 0 || this.data[this.data.length - 1].value === null ? true : false;\n\n    let lastBarZeroCount = 0;\n    const cloneData = [...this.data];\n    let isLast = false;\n\n    cloneData.reverse().forEach((value, index, array) => {\n      if ((value.value === 0 || value.value === null) && !isLast) {\n        lastBarZeroCount++;\n      } else {\n        isLast = true;\n      }\n    });\n\n    if (this.percentage && !this.isSingleData) {\n      this.xAxisScale.domain([0, sumValues]).range([0, +this.width]);\n      this.xAxisCall.tickValues([0, sumValues * 0.25, sumValues * 0.5, sumValues * 0.75, sumValues]);\n      this.xAxis.call(this.xAxisCall);\n\n      this.xGridCall.tickValues([0, sumValues * 0.25, sumValues * 0.5, sumValues * 0.75, sumValues]);\n      this.xGrid.call(this.xGridCall);\n\n      this.svg\n        .select('.axis-x')\n        .selectAll('text')\n        .html((d, i) => {\n          const format = d3_format('.0%');\n          return format(i * 0.25);\n        });\n    } else if (this.percentage && this.isSingleData) {\n      this.xAxisScale.domain([0, 1.0]).range([0, +this.width]);\n      this.xAxisCall.tickValues([0, 0.25, 0.5, 0.75, 1.0]);\n      this.xAxis.call(this.xAxisCall);\n\n      this.xGridCall.tickValues([0, 0.25, 0.5, 0.75, 1.0]);\n      this.xGrid.call(this.xGridCall);\n\n      this.svg\n        .select('.axis-x')\n        .selectAll('text')\n        .html((d, i) => {\n          const format = d3_format('.0%');\n          return format(i * 0.25);\n        });\n    } else {\n      this.xAxisScale.domain([0, Math.ceil(sumValues)]).range([0, +this.width]);\n      this.xGridCall.tickValues(this.xAxisScale.ticks().filter(n => Number.isInteger(n))); // remove decimal grid values\n\n      this.xAxis\n        .transition()\n        .duration(1000)\n        .call(this.xAxisCall);\n\n      // update the grids\n      if (!this.hideXGrid) {\n        this.xGrid\n          .transition()\n          .duration(1000)\n          .call(this.xGridCall);\n      }\n    }\n\n    this.svg\n      .selectAll('.bar')\n      .data(this.data)\n      .join(\n        enter =>\n          enter\n            .append('rect')\n            .attr('class', 'bar')\n            .attr('width', 0)\n            .attr('height', () => {\n              return this.height - this.barPadding;\n            })\n            .attr('fill', d => {\n              if (this.isSingleData) {\n                return `url(${this._location.path()}#gradient-horizontal-${this.colorRange(d.label).substr(1)})`;\n              } else {\n                return this.colorRange(d.label);\n              }\n            })\n            .attr('y', () => {\n              return this.barPadding / 2;\n            })\n            .attr('x', (d, i) => {\n              return this.data.slice(0, i).reduce((acc, item) => {\n                // console.log(acc, item, acc + this.xAxisScale(item.value) + this.barMargin);\n                return +acc + +this.xAxisScale(item.value);\n              }, 1);\n            })\n            .attr('pointer-events', 'none')\n            .call(enter => {\n              return (\n                enter\n                  .transition()\n                  // .duration(0)\n                  .delay((d, i) => i * 250)\n                  .ease(d3_easeLinear)\n                  .attr('width', (d, i) => {\n                    // debugger;\n                    if (i === this.data.length - lastBarZeroCount - 1 && isLastBarZero) {\n                      return this.xAxisScale(d.value);\n                    } else if (i !== this.data.length - 1) {\n                      let width = this.xAxisScale(d.value) - +this.barMargin;\n                      width = Math.sign(width) === -1 ? 0 : width; // handle negative values\n                      return width;\n                    } else {\n                      return this.xAxisScale(d.value);\n                    }\n                  })\n                  .transition()\n                  .attr('pointer-events', 'auto')\n              );\n            }),\n        update =>\n          update\n            .attr('pointer-events', 'none')\n            .transition()\n            .duration(1000)\n            .attr('width', (d, i) => {\n              if (i === this.data.length - 1) {\n                return this.xAxisScale(d.value);\n              } else {\n                return this.xAxisScale(d.value) - this.barMargin;\n              }\n            })\n            .attr('x', (d, i) => {\n              return this.data.slice(0, i).reduce((acc, item) => {\n                return acc + +this.xAxisScale(item.value);\n              }, 0);\n            })\n            .transition()\n            .attr('pointer-events', 'auto'),\n        exit =>\n          exit\n            .transition()\n            .attr('pointer-events', 'none')\n            .remove()\n      )\n      .on('mouseover', (data, index, nodes) => this.barMouseOver(d3_event, data, index, nodes))\n      .on('mouseout', (data, index, nodes) => this.barMouseOut())\n      .on('click', (data, index, nodes) => this.barMouseClick(d3_event, data, index, nodes));\n\n    if (!this.hideLegend) {\n      this.chart\n        .select('.legend')\n        .selectAll('.legend-item')\n        .data(this.data)\n        .join(\n          enter => {\n            const li = enter\n              .append('li')\n              .attr('class', 'legend-item')\n              .classed('align-items-start', this.isCompare);\n\n            li.insert('span')\n              .attr('class', 'legend-key')\n              .style('background-color', d => this.colorRange(d.label))\n              .classed('mt-1', this.isCompare);\n\n            li.insert('span')\n              .attr('class', 'legend-description')\n              .classed('d-flex', this.isCompare)\n              .classed('flex-column', this.isCompare);\n\n            li.select('.legend-description')\n              .insert('span')\n              .attr('class', 'legend-label')\n              .html(d => {\n                switch (this.legendLabelFormatType) {\n                  case 'number':\n                    return this.legendLabelFormat(d.label);\n\n                  case 'time':\n                    const parsedTime = d3_isoParse(d.label);\n                    return this.legendLabelFormat(parsedTime);\n\n                  default:\n                    return d.label;\n                }\n              });\n\n            if (this.isCompare) {\n              li.select('.legend-description')\n                .insert('div')\n                .attr('class', 'legend-change');\n\n              li.select('.legend-change').html(d => {\n                return `<div class=\"metric-block-indicator ${d.compareChangeDirection} ${\n                  d.compareChangeInverse ? 'inverse' : ''\n                } mt-1\"><span>${this.tooltipCompareChangeFormat(d.compareChangeValue)}</span></div>`;\n              });\n            }\n\n            return li;\n          },\n          update => {\n            update.select('.legend-label').html(d => {\n              switch (this.legendLabelFormatType) {\n                case 'number':\n                  return this.legendLabelFormat(d.label);\n\n                case 'time':\n                  const parsedTime = d3_isoParse(d.label);\n                  return this.legendLabelFormat(parsedTime);\n\n                default:\n                  return d.label;\n              }\n            });\n\n            return update;\n          },\n          exit => exit.remove()\n        )\n        .on('mouseover', (data, index, nodes) => this.legendMouseOver(d3_event, data, index, nodes))\n        .on('mouseout', () => this.legendMouseOut())\n        .on('click', (data, index, nodes) => this.legendMouseClick(d3_event, data, index, nodes));\n    }\n  }\n\n  barMouseOver = (event, data, index, nodes) => {\n    const node = d3_select(nodes[index]);\n\n    this.chart.selectAll('.bar').classed('inactive', true);\n\n    node.classed('inactive', false);\n\n    this.chart\n      .selectAll('.legend-item')\n      .filter((d, i) => {\n        // debugger;\n        return i !== index;\n      })\n      .classed('inactive', true);\n\n    this.tooltipShow(data, nodes[index]);\n\n    this.hovered.emit({ event, data });\n  };\n\n  barMouseOut = () => {\n    this.chart\n      .selectAll('.bar')\n      .classed('inactive', false)\n      .style('fill', null);\n\n    this.chart.selectAll('.legend-item').classed('inactive', false);\n\n    this.tooltipHide();\n  };\n\n  barMouseClick = (event, data, index, nodes) => {\n    this.clicked.emit({ event, data });\n  };\n\n  private tooltipShow = (data, node) => {\n    const dimensions = node.getBoundingClientRect();\n    const scroll = this._scroll.getScrollPosition();\n\n    const percentage = data.value / d3_sum(this.data, (d: any) => d.value);\n    const comparePercentage = data.compareValue / d3_sum(this.data, (d: any) => d.compareValue);\n\n    let tooltipLabel = ``;\n    let tooltipCompareDaterangeMargin = ``;\n    let tooltipCompareDaterange = ``;\n    let tooltipCompareValue = ``;\n    let tooltipDaterangeMargin = ``;\n    let tooltipDaterange = ``;\n    let tooltipValue = `${this.nullValueText}`;\n    let tooltipIndicator = '';\n\n    // tooltip label\n    if (!this.isSingleData) {\n      switch (this.tooltipLabelFormatType) {\n        case 'number':\n          tooltipLabel = this.tooltipLabelFormat(data.label);\n          break;\n\n        case 'time':\n          const parsedTime = d3_isoParse(data.label);\n          tooltipLabel = this.tooltipLabelFormat(parsedTime);\n          break;\n\n        default:\n          tooltipLabel = data.label;\n      }\n    }\n\n    // tooltip compare daterange\n    if (this.isCompare && data.compareStartDate && data.compareEndDate) {\n      tooltipCompareDaterangeMargin = `mt-2`;\n\n      tooltipCompareDaterange = `${this.tooltipDateFormat(\n        d3_isoParse(data.compareStartDate)\n      )} - ${this.tooltipDateFormat(d3_isoParse(data.compareEndDate))}`;\n    }\n\n    // tooltip compare value\n    if (this.percentage && this.isCompare && data.compareValue) {\n      tooltipCompareValue =\n        this.tooltipValueFormat === null\n          ? `${this.tooltipPercentFormat(comparePercentage)} (${data.comparveValue}${this.tooltipValueSuffix})`\n          : `${this.tooltipPercentFormat(comparePercentage)} (${this.tooltipValueFormat(data.compareValue)}${\n            this.tooltipValueSuffix\n          })`;\n    } else if (this.isCompare && data.compareValue !== null) {\n      tooltipCompareValue =\n        this.tooltipValueFormat === null\n          ? `${data.compareValue}${this.tooltipValueSuffix} (${this.tooltipPercentFormat(comparePercentage)})`\n          : `${this.tooltipValueFormat(data.compareValue)}${this.tooltipValueSuffix} (${this.tooltipPercentFormat(\n            comparePercentage\n          )})`;\n    } else if (this.isCompare && data.compareValue === null) {\n      tooltipCompareValue = `${this.nullValueText}`;\n    }\n\n    // tooltip daterange\n    if (data.startDate && data.endDate) {\n      tooltipDaterange = `${this.tooltipDateFormat(d3_isoParse(data.startDate))} - ${this.tooltipDateFormat(\n        d3_isoParse(data.endDate)\n      )}`;\n    }\n\n    //tooltip daterange margin\n    if (tooltipLabel !== '') {\n      tooltipDaterangeMargin = `mt-2`;\n    }\n\n    // tooltip value\n    if (this.isSingleData && this.percentage && data.value) {\n      tooltipValue = this.tooltipValueFormat === null ? `${data.value}` : `${this.tooltipValueFormat(data.value)}`;\n    } else if (this.isSingleData && data.value !== null) {\n      tooltipValue =\n        this.tooltipValueFormat === null\n          ? `${data.value}${this.tooltipValueSuffix}`\n          : `${this.tooltipValueFormat(data.value)}${this.tooltipValueSuffix}`;\n    } else if (!this.isSingleData && this.percentage && data.value !== null) {\n      tooltipValue =\n        this.tooltipValueFormat === null\n          ? `${this.tooltipPercentFormat(percentage)} (${data.value}${this.tooltipValueSuffix})`\n          : `${this.tooltipPercentFormat(percentage)} (${this.tooltipValueFormat(data.value)}${\n            this.tooltipValueSuffix\n          })`;\n    } else if (!this.isSingleData && data.value !== null) {\n      tooltipValue =\n        this.tooltipValueFormat === null\n          ? `${data.value}${this.tooltipValueSuffix} (${this.tooltipPercentFormat(percentage)})`\n          : `${this.tooltipValueFormat(data.value)}${this.tooltipValueSuffix} (${this.tooltipPercentFormat(\n            percentage\n          )})`;\n    }\n\n    // tooltip metric indicator\n    if (!this.isSingleData && this.isCompare && data.value !== null && data.compareValue !== null) {\n      tooltipIndicator = `<div class=\"metric-block-indicator ${data.compareChangeDirection} ${\n        data.compareChangeInverse ? 'inverse' : ''\n      } ml-2\"><span>${this.tooltipCompareChangeFormat(data.compareChangeValue)}</span></div>`;\n    }\n\n    this.tooltip.html(() => {\n      return `\n        <div class=\"tooltip-label font-weight-bold\">${tooltipLabel}</div>\n        <div class=\"${tooltipCompareDaterangeMargin}\">${tooltipCompareDaterange}</div>\n        <div class=\"tooltip-value font-weight-bold\">${tooltipCompareValue}</div>\n        <div class=\"${tooltipDaterangeMargin}\">${tooltipDaterange}</div>\n        <div class=\"tooltip-value\"><span class=\"font-weight-bold\">${tooltipValue}</span> <span>${tooltipIndicator}</span></div>\n      `;\n    });\n\n    const tooltipOffsetWidth = +this.tooltip.node().offsetWidth / 2;\n    const tooltipOffsetHeight = +this.tooltip.node().offsetHeight;\n    const tooltipTipSize = 8;\n\n    this.tooltip.style('top', `${+scroll[1] + +dimensions.top - tooltipOffsetHeight - tooltipTipSize}px`);\n\n    if (this.data.length > 1) {\n      this.tooltip.style('left', `${+scroll[0] + +dimensions.left - tooltipOffsetWidth + +dimensions.width / 2}px`);\n    } else {\n      this.tooltip.style('left', `${+scroll[0] - tooltipOffsetWidth + +dimensions.right}px`);\n    }\n\n    this.tooltip.style('opacity', 1);\n  };\n\n  private tooltipHide = () => {\n    this.tooltip.style('opacity', 0);\n  };\n\n  legendMouseOver = (event, data, index, nodes) => {\n    if (!this.hideLegendTooltip) {\n      const barHover = this.svg\n        .selectAll('.bar')\n        .filter((d, i) => i === index)\n        .node();\n\n      this.tooltipShow(data, barHover);\n    }\n\n    this.chart\n      .selectAll('.legend-item')\n      .filter((d, i) => i !== index)\n      .classed('inactive', true);\n\n    this.chart\n      .selectAll('.bar')\n      .filter((d, i) => i !== index)\n      .classed('inactive', true);\n\n    this.chart\n      .selectAll('.bar')\n      .filter((d, i) => i === index)\n      .classed('inactive', null);\n\n    this.hovered.emit({ event, data });\n  };\n\n  legendMouseOut = () => {\n    this.chart.selectAll('.legend-item').classed('inactive', false);\n\n    this.chart\n      .selectAll('.bar')\n      .classed('inactive', false)\n      .style('fill', null);\n\n    // hide tooltip for zero/null values\n    this.tooltipHide();\n  };\n\n  legendMouseClick = (event, data, index, nodes) => {\n    this.clicked.emit({ event, data });\n  };\n\n  private xAxisFormatter = item => {\n    switch (this.xAxisFormatType) {\n      case 'number':\n        return `${this.xAxisFormat(item)}${this.xAxisTickLabelSuffix}`;\n\n      default:\n        return `${item}${this.xAxisTickLabelSuffix}`;\n    }\n  };\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { PbdsDatavizPieComponent } from './dataviz-pie.component';\nimport { PbdsDatavizBarComponent } from './dataviz-bar.component';\nimport { PbdsDatavizLineComponent } from './dataviz-line.component';\nimport { PbdsDatavizGaugeComponent } from './dataviz-gauge.component';\nimport { PbdsDatavizSparklineComponent } from './dataviz-sparkline.component';\nimport { PbdsDatavizBarStackedComponent } from './dataviz-bar-stacked.component';\nimport { PbdsDatavizMetricBlockComponent } from './dataviz-metric-block.component';\nimport { PbdsDatavizMetricIndicatorComponent } from './dataviz-metric-indicator.component';\nimport { DatavizBubbleMapComponent } from './dataviz-bubble-map.component';\nimport { PbdsDatavizHeatmapComponent } from './dataviz-heatmap.component';\nimport { PbdsDatavizChoroplethMapComponent } from './dataviz-choropleth-map.component';\nimport { PbdsDatavizBarGroupedComponent } from './dataviz-bar-grouped.component';\nimport { PbdsDatavizBarSingleHorizontalComponent } from './dataviz-bar-single-horizontal.component';\n\n@NgModule({\n  declarations: [\n    PbdsDatavizPieComponent,\n    PbdsDatavizBarComponent,\n    PbdsDatavizLineComponent,\n    PbdsDatavizGaugeComponent,\n    PbdsDatavizSparklineComponent,\n    PbdsDatavizBarStackedComponent,\n    PbdsDatavizMetricBlockComponent,\n    DatavizBubbleMapComponent,\n    PbdsDatavizMetricIndicatorComponent,\n    PbdsDatavizHeatmapComponent,\n    PbdsDatavizChoroplethMapComponent,\n    PbdsDatavizBarGroupedComponent,\n    PbdsDatavizBarSingleHorizontalComponent\n  ],\n  imports: [CommonModule],\n  exports: [\n    PbdsDatavizPieComponent,\n    PbdsDatavizBarComponent,\n    PbdsDatavizLineComponent,\n    PbdsDatavizGaugeComponent,\n    PbdsDatavizSparklineComponent,\n    PbdsDatavizBarStackedComponent,\n    PbdsDatavizMetricBlockComponent,\n    DatavizBubbleMapComponent,\n    PbdsDatavizMetricIndicatorComponent,\n    PbdsDatavizHeatmapComponent,\n    PbdsDatavizChoroplethMapComponent,\n    PbdsDatavizBarGroupedComponent,\n    PbdsDatavizBarSingleHorizontalComponent\n  ]\n})\nexport class PbdsDatavizModule {}\n","import { Directive, HostListener, HostBinding } from '@angular/core';\nimport { ViewportScroller } from '@angular/common';\n\n@Directive({\n  selector: 'header.bg-brand-header'\n})\nexport class PbdsHeaderShadowDirective {\n  @HostBinding('class.pbds-header-shadow')\n  shadow: boolean;\n\n  @HostListener('window:scroll', []) onWindowScroll() {\n    const offset = this._scroll.getScrollPosition();\n    this.shadow = offset[1] > 20;\n  }\n\n  constructor(private _scroll: ViewportScroller) {}\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { PbdsHeaderShadowDirective } from './header-shadow.directive';\n\n@NgModule({\n  declarations: [PbdsHeaderShadowDirective],\n  imports: [CommonModule],\n  exports: [PbdsHeaderShadowDirective]\n})\nexport class PbdsHeaderShadowModule {}\n"]}