!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common"),require("@angular/forms"),require("@ng-bootstrap/ng-bootstrap"),require("@angular/material/radio")):"function"==typeof define&&define.amd?define("pb-design-system/daterange-popover",["exports","@angular/core","@angular/common","@angular/forms","@ng-bootstrap/ng-bootstrap","@angular/material/radio"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self)["pb-design-system"]=e["pb-design-system"]||{},e["pb-design-system"]["daterange-popover"]={}),e.ng.core,e.ng.common,e.ng.forms,e["^7"][0]["0 || ^8"][0][0],e.ng.material.radio)}(this,(function(e,t,n,a,r,o){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};Object.create;Object.create;var i=function(){function e(e){this.localeId=e,this.locale=this.localeId.toLowerCase()}return e.prototype.setLocale=function(e){this.locale=(e.language+"-"+e.country).toLowerCase(),n.registerLocaleData(e.locale,this.locale)},e.prototype.getCurrentLocale=function(){return this.locale},e}();i.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new i(t.ɵɵinject(t.LOCALE_ID))},token:i,providedIn:"root"}),i.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],i.ctorParameters=function(){return[{type:String,decorators:[{type:t.Inject,args:[t.LOCALE_ID]}]}]};var l=function(e){function t(t){var n=e.call(this)||this;return n.daterangeService=t,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.getWeekdayShortName=function(e){return e=7===e?0:e,n.getLocaleDayNames(this.daterangeService.getCurrentLocale(),n.FormStyle.Standalone,n.TranslationWidth.Abbreviated)[e]},t.prototype.getMonthShortName=function(e){return n.getLocaleMonthNames(this.daterangeService.getCurrentLocale(),n.FormStyle.Standalone,n.TranslationWidth.Wide)[e-1]},t.prototype.getMonthFullName=function(e){return n.getLocaleMonthNames(this.daterangeService.getCurrentLocale(),n.FormStyle.Standalone,n.TranslationWidth.Wide)[e-1]},t.prototype.getDayAriaLabel=function(e){return e.day+"-"+e.month+"-"+e.year},t}(r.NgbDatepickerI18n);l.decorators=[{type:t.Injectable}],l.ctorParameters=function(){return[{type:i}]};var p=function(){function e(e,a){var r=this;this.calendar=e,this.daterangeService=a,this.presets=[{label:"All Dates",value:null},{label:"Last 7 Days",value:7},{label:"Last 30 Days",value:30},{label:"Previous Month",value:"PREVIOUS_MONTH"},{label:"Year to Date",value:"YEAR_TO_DATE"}],this.presetSelected=null,this.filterSelected=0,this.showCustomPreset=!0,this.applyText="Apply",this.cancelText="Cancel",this.container="body",this.customRangeText="Custom Range",this.displayMonths=2,this.displayInput=!0,this.minDate=this.calendar.getPrev(this.calendar.getToday(),"y"),this.maxDate=this.calendar.getToday(),this.placement="bottom-right auto",this.fromDate=null,this.toDate=null,this.inputFormat="{fromDate} to {toDate}",this.dateChange=new t.EventEmitter,this.cancel=new t.EventEmitter,this.firstDayOfWeek=n.getLocaleFirstDayOfWeek(this.daterangeService.getCurrentLocale()),this.dateRange="",this.isDatepickerVisible=!1,this.presetSelect=function(e){if("CUSTOM"===e.value)return r.presetSelected="CUSTOM",!1;r.setDateProperties(e.value),r.isDatepickerVisible=!1},this.isHovered=function(e){return r.fromDate&&!r.toDate&&r.hoveredDate&&e.after(r.fromDate)&&e.before(r.hoveredDate)},this.isInside=function(e){return e.after(r.fromDate)&&e.before(r.toDate)},this.isRange=function(e){return e.equals(r.fromDate)||e.equals(r.toDate)||r.isInside(e)||r.isHovered(e)}}return e.prototype.ngOnInit=function(){var e=this;this.firstDayOfWeek="zh-cn"===this.daterangeService.getCurrentLocale()?this.firstDayOfWeek+1:this.firstDayOfWeek,"CUSTOM"===this.presetSelected&&this.showDatepicker(),this.presets&&(!this.filters&&this.presetSelected?this.presetClick(this.presets.find((function(t,n){return n===e.presetSelected}))):this.presetSelected&&(this.presetSelect({value:this.presetSelected}),this.onApply(!1))),this.setInputLabel()},e.prototype.ngOnChanges=function(e){var t=this;e.filters&&this.filters&&(this.selectedFilter=this.filters[this.filterSelected]),e.presets&&(!this.filters&&this.presetSelected?this.presetClick(this.presets.find((function(e,n){return n===t.presetSelected}))):this.presetSelected&&(this.presetSelect({value:this.presetSelected}),this.onApply())),this.setInputLabel()},e.prototype.onApply=function(e){void 0===e&&(e=!0),this.setInputLabel(),e&&(this.dateChange.emit({fromDate:this.fromDate,toDate:this.toDate,formattedDate:this.isDatepickerVisible?this.dateFormat():this.dateRange,filter:this.filters&&this.filters.length>0?this.selectedFilter.field:null,value:this.presetSelected}),this.datepickerPopup.close())},e.prototype.onCancel=function(){this.datepickerPopup.close(),this.cancel.emit()},e.prototype.onDateSelection=function(e){this.fromDate||this.toDate?this.fromDate&&!this.toDate&&e.after(this.fromDate)?this.toDate=e:(this.toDate=null,this.fromDate=e):this.fromDate=e},e.prototype.presetClick=function(e){if(e){if("CUSTOM"===e.value)return!1;this.setDateProperties(e.value),this.isDatepickerVisible=!1,this.onApply()}},e.prototype.getFormattedDate=function(e){if(e){var t=this.daterangeService.getCurrentLocale(),a=n.getLocaleDateFormat(t,n.FormatWidth.Short);return n.formatDate(e.month+"/"+e.day+"/"+e.year,a,t)}},e.prototype.showDatepicker=function(){this.isDatepickerVisible=!0,this.presetSelect({value:"CUSTOM"})},e.prototype.onFilterChange=function(e,t){this.selectedFilter=this.filters[t]},e.prototype.setPreset=function(e){this.presetSelected=e,this.presetSelect({value:this.presetSelected}),this.onApply()},e.prototype.setFilter=function(e){void 0!==this.filters&&(this.selectedFilter=this.filters[e])},e.prototype.setDateRange=function(e){this.fromDate=new r.NgbDate(e.fromDate.year,e.fromDate.month,e.fromDate.day),this.toDate=new r.NgbDate(e.toDate.year,e.toDate.month,e.toDate.day),this.isDatepickerVisible="CUSTOM"===e.value,this.presetSelected=e.value,this.filters&&(this.filterSelected=this.filters.findIndex((function(t){return t.field===e.filter})),this.selectedFilter=this.filters[this.filterSelected]),this.onApply()},e.prototype.setInputLabel=function(){var e=this;if(this.presets){var t=this.presets.find((function(t){return t.value===e.presetSelected}));t?null===this.fromDate||null===this.toDate||null===this.presetSelected||null!==this.presetSelected&&"CUSTOM"!==this.presetSelected?this.dateRange=t.label:this.dateRange=this.dateFormat():"CUSTOM"===this.presetSelected&&this.fromDate&&this.toDate&&(this.dateRange=this.dateFormat())}},e.prototype.dateFormat=function(){return this.inputFormat.replace("{fromDate}",this.getFormattedDate(this.fromDate)).replace("{toDate}",this.getFormattedDate(this.toDate))},e.prototype.getDaysInMonth=function(e,t){return new Date(e,t,0).getDate()},e.prototype.getFromAndToDates=function(e){var t=new Date,n=t.getFullYear(),a=t.getMonth(),r=t.getDate();switch(e){case"PREVIOUS_MONTH":var o=a>0?n:n-1,s=a>0?a:12;return{from:{year:o,month:s,day:1},to:{year:o,month:s,day:this.getDaysInMonth(o,s)}};case"YEAR_TO_DATE":return{from:{year:n,month:1,day:1},to:{year:n,month:a+1,day:r}};default:return{from:null,to:null}}},e.prototype.setDateProperties=function(e){if("PREVIOUS_MONTH"===e||"YEAR_TO_DATE"===e){var t=this.getFromAndToDates(e),n=t.from,a=t.to;this.fromDate=new r.NgbDate(n.year,n.month,n.day),this.toDate=new r.NgbDate(a.year,a.month,a.day),this.presetSelected=e,this.startDate=this.fromDate}else e?(this.toDate=this.calendar.getToday(),this.fromDate=this.calendar.getPrev(this.toDate,"d",Number(e)),this.presetSelected=e,this.startDate=this.fromDate):(this.fromDate=null,this.toDate=null,this.presetSelected=null,this.startDate=null)},e}();p.decorators=[{type:t.Component,args:[{selector:"pbds-daterange-popover",template:'<div class="input-group pbds-daterange-popover" *ngIf="displayInput; else daterangeButton">\n  <input\n    *ngIf="displayInput"\n    class="form-control"\n    aria-describedby="daterange-button"\n    [value]="dateRange"\n    readonly="readonly"\n    tabindex="-1"\n  />\n\n  <div class="input-group-append">\n    <ng-container *ngTemplateOutlet="daterangeButton"></ng-container>\n  </div>\n</div>\n\n<ng-template #daterangeButton>\n  <button\n    class="btn btn-secondary"\n    type="button"\n    id="daterange-button"\n    #datepickerPopup="ngbPopover"\n    [ngbPopover]="daterangeContent"\n    popoverClass="daterange-popover"\n    autoClose="outside"\n    [container]="container"\n    [placement]="placement"\n    aria-label="Open Daterange Picker"\n  >\n    <i class="pbi-icon-mini pbi-calendar" aria-hidden="true"></i>\n  </button>\n</ng-template>\n\n<ng-template #daterangeContent>\n  <div class="d-block d-md-flex">\n    <div *ngIf="isDatepickerVisible">\n      <ngb-datepicker\n        #datepicker\n        [displayMonths]="displayMonths"\n        [minDate]="minDate"\n        [maxDate]="maxDate"\n        navigation="select"\n        outsideDays="hidden"\n        [firstDayOfWeek]="firstDayOfWeek"\n        [showWeekdays]="true"\n        [startDate]="startDate"\n        [dayTemplate]="t"\n        (dateSelect)="onDateSelection($event)"\n      >\n      </ngb-datepicker>\n      \x3c!--  --\x3e\n\n      <ng-template #t let-date let-focused="focused">\n        <span\n          class="custom-day"\n          [class.focused]="focused"\n          [class.range]="isRange(date)"\n          [class.faded]="isHovered(date) || isInside(date)"\n          (mouseenter)="hoveredDate = date"\n          (mouseleave)="hoveredDate = null"\n        >\n          {{ date.day }}\n        </span>\n      </ng-template>\n    </div>\n\n    <div class="d-flex flex-column justify-content-lg-between mt-md-0" [ngClass]="{ \'ml-md-4\': isDatepickerVisible }">\n      \x3c!-- filters --\x3e\n      <div *ngIf="filters && filters.length > 0" class="mb-3" ngbDropdown>\n        <button class="btn btn-sm btn-secondary btn-block" id="dateFilter" ngbDropdownToggle>\n          {{ selectedFilter.label }}\n        </button>\n        <div ngbDropdownMenu aria-labelledby="dateFilter">\n          <button\n            class="dropdown-item"\n            type="button"\n            *ngFor="let filter of filters; let index = index"\n            (click)="onFilterChange(filter, index)"\n          >\n            {{ filter.label }}\n          </button>\n        </div>\n      </div>\n\n      \x3c!-- presets radio buttons--\x3e\n      <div *ngIf="presets && filters" class="flex-grow-1">\n        <mat-radio-group\n          aria-label="Select an option"\n          class="stacked-radio-group"\n          name="presets"\n          [(ngModel)]="presetSelected"\n          (change)="presetSelect($event)"\n        >\n          <mat-radio-button *ngFor="let preset of presets" [value]="preset.value">{{ preset.label }}</mat-radio-button>\n\n          <mat-radio-button *ngIf="showCustomPreset" [value]="\'CUSTOM\'" (change)="showDatepicker()">{{\n            customRangeText\n          }}</mat-radio-button>\n        </mat-radio-group>\n      </div>\n\n      \x3c!-- presets buttons--\x3e\n      <div *ngIf="presets && !filters" class="flex-grow-1">\n        <button\n          type="button"\n          class="btn btn-secondary btn-block btn-sm text-nowrap"\n          *ngFor="let preset of presets"\n          (click)="presetClick(preset)"\n        >\n          {{ preset.label }}\n        </button>\n\n        <button\n          type="button"\n          class="btn btn-secondary btn-block btn-sm text-nowrap"\n          *ngIf="showCustomPreset"\n          (click)="showDatepicker()"\n        >\n          {{ customRangeText }}\n        </button>\n      </div>\n\n      \x3c!-- buttons --\x3e\n      <div *ngIf="filters || isDatepickerVisible" class="d-flex justify-content-between mt-3">\n        <button class="btn btn-primary btn-sm mr-1" type="button" (click)="onApply()">{{ applyText }}</button>\n        <button class="btn btn-secondary btn-sm ml-1" type="button" (click)="onCancel()">\n          {{ cancelText }}\n        </button>\n      </div>\n    </div>\n  </div>\n</ng-template>\n',providers:[{provide:r.NgbDatepickerI18n,useClass:l}],changeDetection:t.ChangeDetectionStrategy.OnPush}]}],p.ctorParameters=function(){return[{type:r.NgbCalendar},{type:i}]},p.propDecorators={datepickerPopup:[{type:t.ViewChild,args:["datepickerPopup",{static:!1}]}],presets:[{type:t.Input}],presetSelected:[{type:t.Input}],filters:[{type:t.Input}],filterSelected:[{type:t.Input}],showCustomPreset:[{type:t.Input}],applyText:[{type:t.Input}],cancelText:[{type:t.Input}],container:[{type:t.Input}],customRangeText:[{type:t.Input}],displayMonths:[{type:t.Input}],displayInput:[{type:t.Input}],minDate:[{type:t.Input}],maxDate:[{type:t.Input}],placement:[{type:t.Input}],fromDate:[{type:t.Input}],toDate:[{type:t.Input}],inputFormat:[{type:t.Input}],dateChange:[{type:t.Output}],cancel:[{type:t.Output}]};var c=function(){};c.decorators=[{type:t.NgModule,args:[{declarations:[p],imports:[n.CommonModule,a.FormsModule,o.MatRadioModule,r.NgbDatepickerModule,r.NgbPopoverModule,r.NgbDropdownModule],exports:[p]}]}],e.CustomDatepickerI18n=l,e.PbdsDaterangePopoverComponent=p,e.PbdsDaterangePopoverModule=c,e.PbdsDaterangeService=i,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=pb-design-system-daterange-popover.umd.min.js.map